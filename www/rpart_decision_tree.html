<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>의사결정나무 (Decision Tree) - rpart package</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>의사결정나무 (Decision Tree) - rpart package</h1>

<pre><code class="r">Sys.setlocale(&quot;LC_CTYPE&quot;, &quot;Korean_Korea&quot;)
</code></pre>

<pre><code>## [1] &quot;Korean_Korea.949&quot;
</code></pre>

<p>의사결정나무에 쓰이는 알고리즘이 몇가지있는데 R에서 보편적으로 쓰이는 것은 rpart (recursive partitioning and regression tree)이다. 이것은 회귀(regression)와 분류(classification)를 동시에 실행하기 때문에 데이터가 수치형 변수와 범주형 변수를 같이 갖고 있을때 유용하게 쓰인다.   </p>

<p>의사결정나무가 정확성이 다른 더 정교한 알고리즘에 비해 떨어지는 점도 있으나, 장점은 분류분석시 제한사항이 거의 없고, 출력물이 데이터값을 직접적으로 보여주기 때문에 전문지식이 없는 경영진이나 실무진이 이해하기 쉽다.   </p>

<p>이 의사결정나무의 알고리즘을 사용하기 위해서는 우선 rpart 팩키지가 필요하고, 실행하는 함수는 rpart() 이다.</p>

<pre><code class="r">library(rpart)
</code></pre>

<h2>범주형 변수가 y값일때</h2>

<p>iris데이터를 사용하였을때 Species를 y값 즉 출력변수로 정하고, 나머지 변수들을 모두 예측변수로 사용할때 아래와 같이 쓸수있다.   </p>

<pre><code class="r">RP1 &lt;- rpart(Species ~ ., iris)
RP1
</code></pre>

<pre><code>## n= 150 
## 
## node), split, n, loss, yval, (yprob)
##       * denotes terminal node
## 
## 1) root 150 100 setosa (0.33333 0.33333 0.33333)  
##   2) Petal.Length&lt; 2.45 50   0 setosa (1.00000 0.00000 0.00000) *
##   3) Petal.Length&gt;=2.45 100  50 versicolor (0.00000 0.50000 0.50000)  
##     6) Petal.Width&lt; 1.75 54   5 versicolor (0.00000 0.90741 0.09259) *
##     7) Petal.Width&gt;=1.75 46   1 virginica (0.00000 0.02174 0.97826) *
</code></pre>

<p>이렇게 출력값이 범주형 변수일경우 의사결정나무의 나뭇잎(leaf)은 그 가지(branch)를 따라왔을때 범주값중 비율/확률이 가장 높은 범주값을 출력한다. </p>

<p>여기서 나뭇잎은 더이상 나누어지지않는 가지의 끝부분이며 *으로 표시되어있다. 그리고 마디(node)는 가지의 나누어지는 부분이다.</p>

<p>이 의사결정나무의 출력을 보면 가지의 나뭇잎이나 마디마다 아래의 값들이 나타내어진다:    </p>

<ul>
<li>나누어지는 조건<br/></li>
<li>그 마디/나뭇잎에 해당되는 데이터점의 수<br/></li>
<li>그 마디/나뭇잎에서 선택된 범주값 외에 해당되는 데이터점의 수<br/></li>
<li>선택된 범주값<br/></li>
<li>괄호안에 각 범주값의 비율<br/></li>
</ul>

<p>위에서 만들어진 의사결정나무를 도표로 보는 방법은 아래와 같다.  </p>

<pre><code class="r">plot(RP1)
text(RP1, cex = 0.8)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAogAAAGwCAMAAAAdVmTVAAAACVBMVEX9/v0AAAD9/v3/vTJ9AAAAA3RSTlP//wDXyg1BAAAACXBIWXMAAAsSAAALEgHS3X78AAAInElEQVR4nO3aiXYaVxRE0Tz+/6Nji6lBRB5EoOr23ssaUVhp6ugJD/8cIMA/7/4fgJ+ESAQhEkGIRBAiEYRIBCESQYhEECIRhEgEIRJBiEQQIhGESAQhEkGIRBAiEYRIBCESQYhEECIRhEgEIRJBiEQQIhGESAQhEkGIRBAiEYRIBCESQYhEECIRhEgEIRJBiEQQIhGESAQhEkGIRBAiEYRIBCESQYhEECIRhEgEIRJBiEQQIhGESAQhEkGIRBAiEYRIBCESQYhEECIRhEiEXYS4frh+cPvO+vzl58/f3bS5k5/v3dwp37WPEA+f+jv8SYjr7k7Wg0z5nl2FeDrIzq8ut51uOp95P9+cX843HTZf/PHfOhCfax8hHqNZm3PuLsT15a/L/Vxer9tTlm/bR4inN5eD8NOJeLnpQYWXk29zN2ttPsET7CrE8+u7o/HhTf/1Nee7ciI+155CPD8/vD3/1s2zxrX9stufy+v2HPUc8al2EeKf8Dvi9xDinXXz22ReRYh3RPgeQrwjxPd4doiL93vypi/x9BCffH8vV38BpZcgxDv1F1B6CUK8U38BpZcgxDv1F1B6CUK8U38BpZcgxDv1F1B6CUKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIjzVG4gxHkqNxDiPJUbCHGeyg2EOE/lBkKcp3IDIc5TuYEQ56ncQIgt1g/XD27eWZeX44fr48NPU6zL/ay7uwsgxBbn2i4fXN9ZpwZPn70PcfPpB3cVQogtLsfe8Tg7vzrdtq4p/vz8+eVw7W/dlJl2IAqxximd7Wn3MMS1ORFvf0Cvzdu4Q1GILS4/YNfm5Pt1iHc/kR+9jSDEFmv75u7A+yrET+Hd/P4mhhBbXHI6Pj+8Ho3bn7Rr+wX3a1x/sp+/KogQ56ncQIjzVG4gxKdb/EUFzw4R34t/9RAI8emEKMQIQhRiBCG+L0SP/YYHQ4gRPBivDnGd/gj/+s7mn4Xs164v/ugNJ+LtP/SI/Ov0V9v1xR+9/EQ83PyN582xuF+7vvijl5+I5zNw8289Hvxl+87s+uKP3nAibp8oXp8i7nqLXV/8kT9HTCBEIUYQohAjCFGIEYQoxAhCFGIEIQoxghCFGEGIQowgRCFGEKIQIwhRiBGEKMQIQhRiBCEKMYIQhRhBiEKMIEQhRhCiECMIUYgRhCjECEIUYgQhCjGCEIUYQYhCjCBEIUYQohAjCFGIEYQoxAhCFGIEIQoxghCFGEGIQowgRCFGEKIQIwhRiBGEKMQIQhRiBCEKMYIQhRhBiEKMIEQhRhCiECMIUYgRhCjECEIUYgQhCjGCEIUYQYhCjCBEIUYQohAjCFGIEYQoxAhCFGIEIQoxghCFGEGIQowgRCFGEKIQIwhRiBGEKMQIQhRiBCEKMYIQhRhBiEKMIEQhRhCiECMIUYgRhCjECEIUYgQhCjGCEIUYQYhCjCBEIUYQohAjCFGIEYQoxAhCFGIEIQoxghCFGEGIQowgRCFGEKIQIwhRiBGEKMQIQhRiBCEKMYIQhRhBiEKMIEQhRhCiECMIUYgRhCjECEIUYgQhCjGCEIUYQYhCjCBEIUYQohAjCFGIEYQoxAhCFGIEIQoxghCFGEGIQowgRCFGEKIQIwhRiBGEKMQIQhRiBCEKMYIQhRhBiEKMIEQhRhCiECMIUYgRhCjECEIUYgQhCjGCEIVILSESQYhEECLftx69/2dPFIX4XOuLj/iCEP9P80NcHy8/Xq+Pl3U4nN8ebzq++o3HQYjfcHq4T4/2xwO+efQPh7uPRjpW+OWv3/qGFOJ33KxwfsjX43WG+lWIByfiC5x+KF1+It2cAULcfk/+ihC/Y/Mor+3HOzoRL89PDpvniJvPnL9Rf0WI33LM7/j4n2d4+Bzxjf+PL/OtbzghEkGIRBAiEYRIBCESQYhEECIRhEgEIRJBiEQQIhGESAQhEkGIRBAiEYRIBCESQYhEECIRhEgEIRJBiEQQIhGESAQhEkGIRBAiEYRIBCESQYhEECIRhEgEIRJBiEQQIhGESAQhEkGIRBAiEYRIBCESQYhEECIRhEgEIRJBiEQQIhGESAQhEkGIRBAiEYRIBCESQYhEECIRhEgEIRJBiEQQIhGESAQhEkGIRBAiEYRIBCESQYhEECIRhEgEIRJBiEQQIhGESAQhEuFffoOEdmmBE8UAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-4"/> </p>

<p>위의 도표에서 각 마디마다 나누어지는 조건이 표시되는데 그 조건을 충족시키는 값은 왼쪽가지로 뻗어나간다.</p>

<h2>수치 변수가 y값일때</h2>

<pre><code class="r">RP2 &lt;- rpart(Sepal.Length ~ ., iris)
RP2
</code></pre>

<pre><code>## n= 150 
## 
## node), split, n, deviance, yval
##       * denotes terminal node
## 
##  1) root 150 102.2000 5.843  
##    2) Petal.Length&lt; 4.25 73  13.1400 5.179  
##      4) Petal.Length&lt; 3.4 53   6.1080 5.006  
##        8) Sepal.Width&lt; 3.25 20   1.0850 4.735 *
##        9) Sepal.Width&gt;=3.25 33   2.6700 5.170 *
##      5) Petal.Length&gt;=3.4 20   1.1880 5.640 *
##    3) Petal.Length&gt;=4.25 77  26.3500 6.473  
##      6) Petal.Length&lt; 6.05 68  13.4900 6.326  
##       12) Petal.Length&lt; 5.15 43   8.2580 6.165  
##         24) Sepal.Width&lt; 3.05 33   5.2220 6.055 *
##         25) Sepal.Width&gt;=3.05 10   1.3010 6.530 *
##       13) Petal.Length&gt;=5.15 25   2.1900 6.604 *
##      7) Petal.Length&gt;=6.05 9   0.4156 7.578 *
</code></pre>

<p>이렇게 출력값이 수치형 변수일경우 의사결정나무의 나뭇잎은 그 가지를 따라왔을때 계산되는 출력값으로 회귀분석을 하였을때 출력되는 값과 비슷하게 계산된다.</p>

<p>이 의사결정나무의 출력에서는 가지의 나뭇잎이나 마디마다 아래의 값들이 나타내어진다:    </p>

<ul>
<li>나누어지는 조건<br/></li>
<li>그 마디/나뭇잎에 해당되는 데이터점의 수<br/></li>
<li>그 마디/나뭇잎에서 출력된 값의 편차치</li>
<li>출력값 </li>
</ul>

<p>아래의 도표에서 출력값은 반올림된 정수로 표시된다.</p>

<pre><code class="r">plot(RP2)
text(RP2, cex = 0.8)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6"/> </p>

<p>변수들중 일부만 예측변수로 선택할때는 아래와같이 예측변수들을 정해준다. 결과물이 달라졌음을 볼수있다.  </p>

<pre><code class="r">RP3 &lt;- rpart(Species ~ Sepal.Length + Sepal.Width, iris)
RP3
</code></pre>

<pre><code>## n= 150 
## 
## node), split, n, loss, yval, (yprob)
##       * denotes terminal node
## 
##  1) root 150 100 setosa (0.33333 0.33333 0.33333)  
##    2) Sepal.Length&lt; 5.45 52   7 setosa (0.86538 0.11538 0.01923)  
##      4) Sepal.Width&gt;=2.8 45   1 setosa (0.97778 0.02222 0.00000) *
##      5) Sepal.Width&lt; 2.8 7   2 versicolor (0.14286 0.71429 0.14286) *
##    3) Sepal.Length&gt;=5.45 98  49 virginica (0.05102 0.44898 0.50000)  
##      6) Sepal.Length&lt; 6.15 43  15 versicolor (0.11628 0.65116 0.23256)  
##       12) Sepal.Width&gt;=3.1 7   2 setosa (0.71429 0.28571 0.00000) *
##       13) Sepal.Width&lt; 3.1 36  10 versicolor (0.00000 0.72222 0.27778) *
##      7) Sepal.Length&gt;=6.15 55  16 virginica (0.00000 0.29091 0.70909) *
</code></pre>

<pre><code class="r">plot(RP3)
text(RP3, cex = 0.8)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"/> </p>

<h2>프루닝 (pruning) - 가지치기</h2>

<p>의사결정나무의 크기에 따라 분석/예측 정확도가 달라지는데, 나무가 클수록 정확도는 올라가나 너무 크면 overfit을 할 가능성이 높아져서 robustness가 낮아진다. 즉 아주 큰 나무는 그 나무를 생성시킨 training data에 대한 분석도는 높으나 그 분석결과를 다른 데이터, 즉 test data에 적용했을 경우 정확도가 낮을수있다. </p>

<p>이 말은 이렇게 큰 나무가 실무에 사용될경우 효과적이지 못하다는 말이므로 이상적인 결과는 적당한 크기의 나무를 만들어서 robustness를 잃지않는 선에서 최상의 정확도를 갖추어야한다.</p>

<p>나무의 크기를 조절하는 방법을 pruning (가지치기)라고 하는데. 보통 나무를 우선 아주 크게 키운후 크기를 차츰 줄이면서 robustness를 확인하기 때문이다.</p>

<p>우선 가장 보편적이고 쉬운 방법으로는 minsplit을 이용해서 가지가 뻗어나갈때 (split할때) 있어야할 최소한의 데이터점의 갯수를 정해주어서 나무의 크기를 조절하는 방법이있다.</p>

<p>아래에서 볼수있듯이 minsplit의 값에 따라 나무의 크기가 상당한 차이가있다. </p>

<pre><code class="r">RP4_1 &lt;- rpart(Kyphosis ~ ., kyphosis, control = rpart.control(minsplit = 3))
RP4_2 &lt;- rpart(Kyphosis ~ ., kyphosis, control = rpart.control(minsplit = 5))
RP4_3 &lt;- rpart(Kyphosis ~ ., kyphosis, control = rpart.control(minsplit = 10))
</code></pre>

<pre><code class="r">par(mfcol = c(1, 3))
plot(RP4_1, main = &quot;minsplit=3&quot;)
text(RP4_1, cex = 0.7)
plot(RP4_2, main = &quot;minsplit=5&quot;)
text(RP4_2, cex = 0.7)
plot(RP4_3, main = &quot;minsplit=10&quot;)
text(RP4_3, cex = 0.7)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-10"/> </p>

<p>또 다른 크기를 조절하는 매개변수중 complexity parameter라고 있다. 원래 이 것은 크기를 조절하기 위해 만들어 졌다기 보다 나무를 생성할때 불필요한 split을 시도하는걸 막아주면서 시간을 줄이기 위해서 만들어졌는데, 결과적으로 나무의 크기에도 영향을 준다.  </p>

<pre><code class="r">RP5_1 &lt;- rpart(Kyphosis ~ ., kyphosis, control = rpart.control(cp = 0.1))
RP5_2 &lt;- rpart(Kyphosis ~ ., kyphosis, control = rpart.control(cp = 0.001))
RP5_3 &lt;- rpart(Kyphosis ~ ., kyphosis, control = rpart.control(cp = 1e-04))
</code></pre>

<pre><code class="r">par(mfcol = c(1, 3))
plot(RP5_1, main = &quot;cp=0.1&quot;)
text(RP5_1, cex = 0.7)
plot(RP5_2, main = &quot;cp=0.001&quot;)
text(RP5_2, cex = 0.7)
plot(RP5_3, main = &quot;cp=0.0001&quot;)
text(RP5_3, cex = 0.7)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAxgAAAGwCAMAAAAdczP8AAAAMFBMVEX9/v0AAAAiIiIzMzNDRENUVVRlZmV2d3aHh4eYmJipqam6urrKy8rb3Nvs7ez9/v0pr42hAAAAEHRSTlP///////////////////8A4CNdGQAAAAlwSFlzAAALEgAACxIB0t1+/AAADZhJREFUeJzt3QFz21QaheENW2LJdq3//2836fma0u4FnNS60lWeZxgG2BlZPXxvy3Zo+M8C/J//bP0CsEfCgAZhQIMwoEEY0CAMaBAGNAgDGoQBDcKABmFAgzCgQRjQIAxoEAY0CAMa9hbG09PT2x9u+R7beVsgf/D9Tz/XGs0Ruk6xszCelrdv99PnOoXv3hbIH3z/08+1RnOEvlNsG8a37wOe3n7/9Jcwnj7H95F/v8BP13DsNe4boe8Um4bx8/cEP/7Kjz8+un9Y4Jf/6cBr3DlC3yk2D+PtG//LjxiHPoU3/7DA5wrjjhE+WRh+xPAjxuJHjF/85R8u//pXDn8KP/zDAp/nZ6XuHOGz/azUkf+W38cCy+5GEMYOWGDZ3Qg7CAP2RxjQIAxoEAY0CAMahAENwoAGYUCDMKBBGNAgDGgQBjQIAxqEAQ3CgAZhQIMwoGHrMK7X1l+8/d3/8rkYJ7bYYeMw5stlnpbl67LcpuVyq794/XNZzpdP9fe+xTixyQ4bh3F5npfn2/n6PM/Pt2Webudpul1Op2U5TdO2r7Y948QmO2wcxnX5epqW8/zHtEzLdTovr9/maXn5Nt+Wz/T3vsk4sckOG4dxPp3O8/V0/jK9/NhYP0guL98xXG/zfNr0zXbAOLHJDlv/n2/YpV2FsbMvLbQvxolOOwhjFMaJfYbxNLZ1NhxvMTvEP7zve8P4rXG2ffo23+k+7DMf+PJ2+PdHCWOUzxTGgx8kjG7PX/UzhfHgBwmj2/NX/UxhPPhBwuj2/FU/UxgPftBAYaxt6IN4IDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqDCDuEMIqD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" alt="plot of chunk unnamed-chunk-12"/> </p>

<h2>기계학습 (machine learning)에서의 의사결정나무 응용</h2>

<p>기계학습에서 많이 사용하는 알고리즘중 하나가 의사결정나무이다. 물론 실제로 응용할때는 다른 알고리즘과 같이 사용하던지 ensemble방식으로 사용하는 경우도 많다. 아래는 하나의 나무만 갖고 사용하는 아주 간단한 예이다</p>

<p>우선 갖고있는 데이터를 나무를 생성할 training 데이터와 그 나무의 성능을 시험할 test 데이터로 나눈다. 여기서는 training 데이터와 test 데이터를 7:3의 비율로 무작위로 추출하였는데, 두 개의 세트가 겹치지않도록 조심하여야 한다.</p>

<pre><code class="r">a &lt;- sample(c(1:nrow(kyphosis)), size = nrow(kyphosis) * 0.7, replace = FALSE)

Train &lt;- kyphosis[a, ]  #training 데이터
Test &lt;- kyphosis[-a, ]  #test 데이터
</code></pre>

<p>위의 방법으로 생성된 training 데이터를 사용하여 나무를 만든다. 여기서 출력값은 Kyphosis 변수로 정하였다. Kyphosis변수는 범주형 변수이므로 지금 생성되는 나무는 분류형 나무가 된다.</p>

<pre><code class="r">RP &lt;- rpart(Kyphosis ~ ., Train, control = rpart.control(minsplit = 3))  #나무 만들기
</code></pre>

<p>이렇게 생성된 나무는 통계형 모델이되는데, 이 모델을 사용해서 아래와 같이 test 데이터의 출력값을 예상할수있다. 여기서는 단순하게 계산된 범주값들의 확률을 보고 더 큰쪽을 예상값으로 정하였다.  다른 방법으로는 계산된 확률을 이용해서 기준값을 정하는 방법도있다.</p>

<pre><code class="r">Pred &lt;- predict(RP, Test[, c(&quot;Age&quot;, &quot;Number&quot;, &quot;Start&quot;)])

# test세트 예상값을 test data에 추가
Test$Prediction &lt;- paste(&quot;predicted&quot;, colnames(Pred)[apply(Pred, 1, which.max)], 
    sep = &quot;_&quot;)

T1 &lt;- table(Test$Kyphosis, Test$Prediction)
T1
</code></pre>

<pre><code>##          
##           predicted_absent predicted_present
##   absent                14                 6
##   present                1                 4
</code></pre>

<p>위의 도표는 이 모델의 오차를 측정한 도표다. 여기서 보면은 실제값은 20개의 absent와 5개의 present로 이루어져있는데 위에서 생성된 나무는 15개의 absent와 10개의 present를 예측했다. 15개의 absent예측중 14개는 실제 absent로 맞았고, 10개의 present예측중 4개가 실제 present였다. </p>

<p>만약 이 나무의 목적이 present값을 찾는것이라면, 1개의 present가 실수로 absent로 분류된것은 False Negative 에러이고, 6개의 absent가 실수로 present로 분류된것은 False Positive 에러라고 말하여진다.  </p>

<p>위에서 계산된 오차값을 참고해서 모델이 실용화될 환경에 맞추어서 원하는 모델을 선택할수있다.</p>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-43388960-1', 'r-project.org');
  ga('send', 'pageview');

</script>
</body>

</html>

