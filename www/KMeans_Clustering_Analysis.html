<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>KMeans Clustering Analysis (KMeans(K-평균) 군집 분석)</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>KMeans Clustering Analysis (KMeans(K-평균) 군집 분석)</h1>

<p>군집분석의 주 목적은 데이터안에 존재하는 알지못하는 특성들이있을때, 데이터점들이 군집을 이루면서 그 특성들이 나타내지게 하는것, 즉 비슷한 특성을 같고있는 데이터 점들을 같은 군집안으로 집어넣어주는 것이다.</p>

<p>군집분석에는 몇가지 알고리즘들이있는데 그 중 가장 보편적으로 쓰이는 것중 하나가 K-평균 군집분석이다. 간단히 설명하자면 이 알고리즘은 주어진 데이터안에있는 변수들에 한해 군집의 중심점 (centroid)들을 미리 정해주고 그 중심점들에서 가까운 데이터 점(point)들을 찾은후 그 점들을 가지고 중심점들의 위치를 다시 계산하는것을 반복 (iteration)해서 그 중심점들이 안정적인 값을 가질때, 즉 반복후에도 중심점의 위치가 거의 변하지 않을때 정해지는 군집들을 분석하는 방법이다. </p>

<p>R에서는kmeans()라는 명령어를 아래와같이 사용하는데 여기서 centers는 미리정해주는 군집의 갯수이던지 아니면 중심점들의 좌표값이다. </p>

<p>iter.max는 중심점을 찾는 계산을 반복하는 횟수의 최대값이다. 기본값이 10으로 정해져 있지만, 데이터가 크던지 분석에 사용될 변수가 많을 경우, 데이터 사이즈에 비해 iter.max를 너무 적게 잡으면 군집분석의 정확도가 떨어질것이므로 iter.max 값을 늘리는것도 고려해 보아야한다. 주로 kmeans()를 서너번 실행했을때, 실행할때마다 중심점의 값이나 군집들이 크게 바뀐다면 iter.max를 늘려주어야 할것이다.   </p>

<p>다른 매개변수(parameter)들도 이 명령어에 포함시킬수있지만 중요한 매개변수들은 이 둘임으로 여기서는 나머지 매개변수값은 기본설정값들로 사용하겠다. </p>

<p>그리고 k-평균 군집분석은  데이터의 수치변수 (numerical variable)들만 사용해야함으로 범주형 변수(categorical variable)들은 미리 수치변수로 전환시키던지 분석에서 제외하여야 한다. </p>

<h2>1. kmeans()에서 군집을 지정하는 방법</h2>

<h3>1-1. 군집의 갯수를 사용한 예</h3>

<p>여기서 center를 3으로 정한이유는 데이터가 3개의 Species (iris꽃의 종자들)을 관찰한 결과를 담고있기때문에 데이터점들이 3가지의 주된 특성들을보이며 3개의 군집을이룰것을 예상해서이다. </p>

<p>iter.max를 100으로 잡은 이유는 iris 데이터가 작기때문에 시간이 얼마 걸리지 않을것임으로 일부러 큰값을 지정해주었다.</p>

<pre><code class="r">km1 &lt;- kmeans(iris[, 1:4], centers = 3, iter.max = 100)
</code></pre>

<h3>1-2. 중심점들의 좌표값을 사용한 예</h3>

<p>여기서 우선 지정해준 중심점들은 iris데이터의 나오는 3개의 iris종자들에대한 각 변수들의 평균값이다. </p>

<pre><code class="r">CTR &lt;- aggregate(. ~ Species, iris, mean)
km2 &lt;- kmeans(iris[, 1:4], centers = CTR[, 2:5], iter.max = 100)
</code></pre>

<pre><code class="r">Sys.setlocale(&quot;LC_CTYPE&quot;, &quot;Korean_Korea&quot;)
</code></pre>

<pre><code>## [1] &quot;Korean_Korea.949&quot;
</code></pre>

<p>아래의 그래프들은 위에서 예시한 방법들로 만들어진 군집들을 비교한것이다. 두개의 방법이 같은 모양의 군집들을 형성한것을 볼수있다. </p>

<pre><code class="r">
par(mfrow = c(1, 2))
plot(iris[, 1:2], col = km1$cluster, main = &quot;군집의 갯수를 사용한 예&quot;)
points(km1$centers, col = 1:length(unique(km1$cluster)), pch = 16)
text(km1$centers, labels = c(1:3), col = c(1:3), pos = 3)
plot(iris[, 1:2], col = km2$cluster, main = &quot;중심점들의 좌표값을 사용한 예&quot;)
points(km2$centers, col = 1:length(unique(km2$cluster)), pch = 16)
text(km2$centers, labels = c(1:3), col = c(1:3), pos = 3)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-4"/> </p>

<p>보통 이렇게 같은 결과를 예상하지만 간혹 군집의 갯수를 정해서 kmeans()를 실행할 경우 중심점이 예상한 곳과 다른곳에 생길수도있다. 그러므로 사용자가 원하는 모양의 군집이 있다면, 여기에 맞는 중심점들을 1-2의 예처럼 미리 좌표값을 지정해주고 kmeans()를 실행하여야 한다.</p>

<h2>2. 지정할 군집의 갯수를 찾는 방법</h2>

<h3>2-1. 데이터 점들의 위치를 직접보고 군집의 갯수를 예상하는 법</h3>

<p>이 방법은 원초적이지만 가장 흔히 쓰이는 방법중에 하나이다. 단점은 데이터가 크고 변수가 많을때는 별로 유용하지 않다는 점이다. 장점은 군집들이 형성되는것을 직접보고 결정하는것이므로 분석을 효과적으로 할수있다. </p>

<pre><code class="r">plot(iris[, 1:4])
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-5"/> </p>

<p>위 그래프를 살펴보면 iris데이터는 하나의 작고 밀집된 군집과 좀 느슨하게 형성된 군집으로 나뉘어지는것을 볼수있다. 크고 느슨한 군집은 어찌보면 2-3개의 군집들이 모여있는것으로 보일수도있다. 그러므로 처음에 지정할 군집의 갯수는 1개의 작고 밀집된 군집과 1-3개의 느슨한 군집 즉 2-4개 사이를 정한다.</p>

<p>이렇게 군집의 갯수가 여러가지의 수가 있을경우 지정할 갯수를 하나씩 정해서 kmeans()실행한후 그 결과를 비교 관찰하는것을 반복한다. 그리고나서 최적의 군집 갯수를 정하고 군집분석을 실행한다.</p>

<pre><code class="r">km1 &lt;- kmeans(iris[, 1:4], centers = 2, iter.max = 100)
km2 &lt;- kmeans(iris[, 1:4], centers = 3, iter.max = 100)
km3 &lt;- kmeans(iris[, 1:4], centers = 4, iter.max = 100)
</code></pre>

<pre><code class="r">par(mfrow = c(1, 3))
plot(iris[, 1:2], col = km1$cluster, main = &quot;2개의 군집을 지정한 예&quot;)
points(km1$centers, col = 1:length(unique(km1$cluster)), pch = 16)
text(km1$centers, labels = c(1:length(unique(km1$cluster))), col = c(1:length(unique(km1$cluster))), 
    pos = 3)
plot(iris[, 1:2], col = km2$cluster, main = &quot;3개의 군집을 지정한 예&quot;)
points(km2$centers, col = 1:length(unique(km2$cluster)), pch = 16)
text(km2$centers, labels = c(1:length(unique(km2$cluster))), col = c(1:length(unique(km2$cluster))), 
    pos = 3)
plot(iris[, 1:2], col = km3$cluster, main = &quot;4개의 군집을 지정한 예&quot;)
points(km3$centers, col = 1:length(unique(km3$cluster)), pch = 16)
text(km3$centers, labels = c(1:length(unique(km3$cluster))), col = c(1:length(unique(km3$cluster))), 
    pos = 3)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-7"/> </p>

<p>위의 그래프들에서 볼수있듯이 군집의 갯수를 지정하는 것에 따라서 군집의 모양이 변하게된다. 보통 최적의 군집 갯수를 정할때 보는것들은 데이터 점들이 분명하게 나뉘어지고 군집이 밀집되어있는 정도이다. 하지만 분석의 목적에따라서 사용자가 어떠한 형태의 군집을 원하는지 그것에 맞게 정해주면된다.</p>

<p>위의 예에서는 무작위로 첫번째와 두번째 변수들을 이용해서 그래프를 그렸는데, 만약 변수가 많은 데이터일경우 제1, 제2의 주성분 값들을 그래프로 그려서 본다. 주성분 값을 사용할경우 차원축소의 효과가 있기때문에 주성분 값을 이용한 그래프가 데이터의 군집형성 상태를 더 잘 보여줄수있다. </p>

<p>아래의 그래프들이 주성분값을 이용해서 그린 그래프들이다.</p>

<pre><code class="r">par(mfrow = c(1, 3))
plot(princomp(iris[, 1:4])$scores[, 1:2], col = km1$cluster, xlab = &quot;PC1&quot;, ylab = &quot;PC2&quot;, 
    main = &quot;2개의 군집을 지정한 예 - 주성분 값&quot;)
plot(princomp(iris[, 1:4])$scores[, 1:2], col = km2$cluster, xlab = &quot;PC1&quot;, ylab = &quot;PC2&quot;, 
    main = &quot;3개의 군집을 지정한 예 - 주성분 값&quot;)
plot(princomp(iris[, 1:4])$scores[, 1:2], col = km3$cluster, xlab = &quot;PC1&quot;, ylab = &quot;PC2&quot;, 
    main = &quot;4개의 군집을 지정한 예 - 주성분 값&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"/> </p>

<h3>2-2. 데이터 안에있는 범주를 이용하는 방법</h3>

<p>이방법은 섹션-1 에서 사용된 방법인데 데이터에 따라 사용가능성이 정해진다. iris데이터 처럼 Species라는 범주형  변수가 데이터를 범주의 특성대로 잘 나누어준다면, 존재하는 범주들의 갯수를 처음에 지정할 군집의 갯수로 정해줄수있다.</p>

<pre><code class="r">table(iris$Species)
</code></pre>

<pre><code>## 
##     setosa versicolor  virginica 
##         50         50         50
</code></pre>

<p>위의 예처럼 간단하게 table()을 사용해서 몇개의 범주들이 존재하는지 알수있고, 동시에 각각의 크기를 비교할수있다. </p>

<p>여기서도 2-1의 예처럼 군집의 갯수를 바꾸어가며 kmeans()실행해서 그 결과를 비교 관찰하는것을 반복한다. 그리고나서 최적의 군집갯수를 정하고 군집분석을 실행한다.</p>

<h3>2-3. withinss를 사용하여  군집의 갯수를 예상하는 법</h3>

<p>k-평균을 이용하여 군집을 형성하면 각 군집마다 withinss라는 값이 계산되는데, 이 값은 각 군집마다 그 군집의 중심점으로부터 그 군집을 형성하는 모든 데이터 점들까지의 거리를 더한 수이다. 즉 withinss가 나타내는 값은 각각의 군집이 크기를 가늠케 할수있는 척도이다. </p>

<p>아래의 예를 보면 각 군집의 withinss 의 값과 위에서 설명한 거리를 더한 값이 같음을 알수있다. </p>

<pre><code class="r">km &lt;- kmeans(iris[, 1:4], center = 5, iter.max = 100)
ct &lt;- km$centers
WNSS &lt;- data.frame()
for (i in 1:5) {
    dat &lt;- iris[which(km$cluster == i), ]
    WNSSX &lt;- data.frame(군집 = i, 거리_더한값 = sum(apply(dat[, 1:4], 1, function(x) sum((x - 
        ct[i, ])^2))), withinss = km$withinss[i])
    WNSS &lt;- rbind(WNSS, WNSSX)
}
WNSS
</code></pre>

<pre><code>##   군집 거리_더한값 withinss
## 1    1       4.650    4.650
## 2    2       9.749    9.749
## 3    3       8.738    8.738
## 4    4      11.540   11.540
## 5    5      15.151   15.151
</code></pre>

<p>여기서 withinss를 모두 더하게되면 군집들이 어떠한 크기들로 형성되어있는지를 짐작할수있다. 이방법을 이용해서 군집분석에 필요한 군집의 갯수를 지정할수있다. 이방법은 데이터가 크고 변수가 많아서 위의 두 방법 (2-1 &amp; 2-2)으로 군집의 갯수를 정해주는게 어려울때 이용한다. </p>

<p>아래의 예를 보면 looping 을이용하여 군집의 갯수가 2에서 10으로 정해질때 withinss를 더한값이 어떻게 변하는지를 보여준다.</p>

<pre><code class="r">n &lt;- 2
nn &lt;- 10

wss &lt;- sum(kmeans(iris[, 1:4], centers = n, iter.max = 100)$withinss)

for (i in (n + 1):nn) {
    wss[(i - (n - 1))] &lt;- sum(kmeans(iris[, 1:4], centers = i, iter.max = 100)$withinss)
}
</code></pre>

<pre><code class="r">plot(n:nn, wss, xlab = &quot;군집의 갯수&quot;, ylab = &quot;withinss 더한 값&quot;, main = &quot;군집의 갯수에 따라 변하는 withinss 더한값&quot;, 
    type = &quot;p&quot;, pch = 16)
lines(lowess(n:nn, wss))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-12"/> </p>

<p>보통 이렇게 그래프를 그렸을때 그래프의 선이 꺽이는 부분의 군집 갯수가 최적의 갯수라고 생각하면 좋다. 여기에서는 선은 5쯤에서 꺽이지만 실제값인 점들을 보면 2에서 3사이에 도표가 급하강한후 5에서 부터 경사가 완만해지는것을 볼수있다. 그러므로 군집의 갯수는 3-5사이를 정하면된다. </p>

<h2>3. 형성된 군집들을 분석/응용하는 방법 </h2>

<h3>3-1 군집의 특성을 분석하는 방법</h3>

<p>군집이 형성된후 그 결과를 이용하여 분석에 응용하는 방법은 아주많으며 사용자에의해 새롭게 만들어지기도 한다. 아래의 예는 decision tree를 이용한 가장 단순한 방법이다.</p>

<pre><code class="r">Dat &lt;- iris
km &lt;- kmeans(Dat[, 1:4], center = 4, iter.max = 100)
Dat$Cluster &lt;- km$cluster

library(rpart)
RP &lt;- rpart(as.character(Cluster) ~ ., Dat, control = rpart.control(minsplit = 5, 
    cp = 1e-04))
</code></pre>

<p>아래에서 보면 leaf node에 나온 값이 군집의 번호인데 decision tree의 node를 따라가면서 각 군집의 특성을 파악할수있다.</p>

<pre><code class="r">plot(RP)
text(RP)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAACVBMVEX9/v0AAAD9/v3/vTJ9AAAAA3RSTlP//wDXyg1BAAAACXBIWXMAAAsSAAALEgHS3X78AAALM0lEQVR4nO3d4XqqOBRG4Qn3f9HztAeSsIEIFfZO+Nb6UT0WE+gLqK0z/jeRZP9FrwDFBLxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAi/Y++PRT9U9zLdnl67sefbseMS2TfLGOHfRC+Pxl2rv2F/hU3S+Z8UftxfC/B2X5YuCX22bI9Hs1LTdsYVfw47u/GD7li3JtymbLbXmJtLrIO0w+peeL+buj278QPpUDPNXQu/D2Iq0XKaPmy2rskXsh/HL5bwcoB+gavvruHrw9pO3+A3x3GZjGqX46hp+Xzad6szfVNw3au+HtI/jUEN+c6nfGrO4JfG9lkPmhPs3P2TNwMs/053/k5bakafNYwZO7d/SCI/hqwP/0gpdnVwP+JzX1qUv4pFLoT7lHeIkpo08zwAdNCfwm4D0CPmhK4DcB7xHwQVMCv0nlRTXwJuA9Aj4s4E3AewR8WMCbgPcI+LCANwHvEfBhAW8C3iPgwwLeBLxHwIcFvAl4j4APC3gT8B4BHxbwJuA9Aj4s4E3AewR8WMCbgPcI+LCANwHvEfBhAW8C3iPgwwLeBLxHwIcFvAl4j4APC3gT8B4BHxbwJuA9Aj4s4E3AewR8WMCbgPcI+LCANwHvEfBhAW8C3iPgwwLeBLxHwIcFvAl4j4APC3gT8B4BHxbwJuA9Aj4s4E3AewR8WMCbgPcI+LCANwHvEfBhAW8C3iPgwwLeBLxHwIcFvAl4j4APC3gT8B4BHxbwJuA9Aj4s4E3AewR8WMCbgPcI+LCANwHvEfBhAW8C3iPgwwLeBLxHwIcFvAl4j4APC3gT8B4BHxbwJuA9Aj4s4E3AewR8WMCbgPcI+LCANwHvEfBhAW8C3iPgwwLeBLxHwIcFvAl4j4APC3gT8B4BHxbwJuA9Aj4s4E3AewR8WMCbgPcI+LCANwHvEfBhAW8C3iPgwwLeBLxHwIcFvAl4j4APC3gT8B4BHxbwJuA9Aj4s4E3AewR8WMCbgPcI+LCANwHvEfBhAW8C3iPgwwLeBLxHwIcFvAl4j4APC3gT8B4BHxbwJuA9ehY+/VT901zb3/T8vYNvlyGTvSGw1lok+6VctDZzfe3mzXwYPn+Z9q79Db5ca43inNnSg2+m+et8awO+LJdW/7otJ/jfvbV8MfDLbcuu/Xs1LTek7ZDzteZP27f1llbbkiYLn5YFW5uZxyy7yb35wKd8Ua5Nq21K/w7gfxfl2mqvyZfr4fs401eX1bZM662t4NO8WQebWcZc9oubN9PnMX71AziEn8zPLK0XWS1cbn3gNPiXtlu63dr1QZ9am5kfyMw+dFsOR/yUd4Cy567hq+/uwW/29WQue4D/KdltMVvbhj/YzIP94tuc4PPF0al+Ooafl92cA7uCX04++yex+bYm/NFmDg9fPD+e6ltnt05P9TX8eu9Nxi1v7c6pfj2eWX5E+OXZ7exafij5CdtUn/KmvNzOtponyjunyJCWA3XnFcrazTwKfN7M1cC31edv7nqQ/KozGxC7kf3B9/Hy7MuA/0Pjs5/rNfCpt+7btD62/9a1vRP+vqFuyR1+qPGBH2Y+4E8GfCvgh5kP+JMB3wr4YeYD/mTAtwJ+mPmAPxnwrYAfZj7gTwZ8K+CHmQ/4kwHfCvhh5gP+ZMC3An6Y+YA/GfCtgB9mPuBPBnwr4IeZD/iTAd8K+GHmA/5kwLcCfpj5gD8Z8K2AH2Y+4E8GfCvgh5kP+JMB3wr4YeYD/mTAtwJ+mPmAPxnwrYAfZj7gTwZ8K+CHmQ/4kwHfCvhh5gP+ZMC3An6Y+YA/GfCtgB9mPuBPBnwr4IeZD/iTAd8K+ID5Wv8r6nQ4ViqX+/euhv28LsD7z5daS38DX64B3+N8GT4dfSplQa6WSFc/g7MZ8P7z1efjNB19KuVmiVQtm6o9Z/kUg/oBBPgu50vl4C7i03QMP+XzQtq5y7Ra+OS6AB8033KoFrDyr6JaL7EDv3mSCPzUMfzyGL93WG+P+OkYfl62+sAa4KdB4FeP8e3P4EyrZbfTcaqf6xb+xKdSVk/Ypgx/+TM4WwEfPt/Z+50UPRnw4fOdhr/1s+eAH2a+e8cHfpj5gD/ZaPC+H0EKfDd9veNcWhr4bgL+pnpbn08Bf1O9rc+ngL8p3/X5/jU28Dfluj77v0S9PITf/YHvZkLgbwr4VsB3Mx/wNwV8K+C7mQ74m3J+ORc+AvBzvi/nvv9jOfA31dv69BXwogEvGvCiAd9J3n/kAb6Pvv8jD2+9WuptfT4G/D31tj4f+2qFz/w38XXAd9OXBzzwS72tz6e+POCBX+ptfT707SP8xZcFwHeS9x95gO8j9z/yAC8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS/aEPCtz2RLh3Oncrl/73rU9GmetzUCfGqN/nf4VC/TnOONDQX/74BMC1MqdAWwLPH7Nf3eNN8lbYfN93tyA3psGPgpH6L/UPO/6kVWS6Rq2VTtOWn+OM9lB/q9z/xdHfsR4BeRirpA78JPU3WQb+6SR61urMbXaAj4efR8pE7VAbqGr5fYgV8d0qsHivqsItEI8Mtj/N5hvT3ip2P4eVmzA+X95dGN6K3R4FeP8dsjvl4wrZbdrt7qRk71f+/xx/jNs/qp2gXS8sRtyvDLEumAdPOygCd3f8rrh3Z2npS/0LY3w0u9PLvagPBn6219+mog+PR0D69/X90I/3SP71gPj99XwLuN31fAu43fV8C7jd9X98E//nMD/s5ug3/+STHwd3YXfOKIHytO9W7j9xXwbuP3FfBu4/cV8G7j91UMvPnVeDLX9ofavE3qaA3KX+8vWQL/ty7Br+9wD3z97qm/vJkG+OfL8OVtM5u3w0zT3jtu0tG75Dfwlx2Bfz77LjqjZQTzG+xa75Ivv0nId7v4OyXgn69g1QfnEfy08l+dx1dPFOyJ4qIl8M9XEVWH7wa++u4evH2CaB7jJ+AbBcPni6NT/XQMPy+77B751A78meLhi+fHU33rXfJHd7u+UhrFwi8Px7Nr2QXyUTzVZ/YpL3cIXz0E8OSu1VhvxHjUBvg+e/x9sMB32tMwwAcV/b544IMCzjPgRQNeNOBFA365N//RZFSh8Jd/wTt6wN84wEgBf+MAIwV8vruUO/B3DjBSwN84wEgBX+4MfEy8jvcMeNGAFw140YAXDXjROoInz4AXDXjRgBetH/iv/7jGk7srdQP/pZvc79q/rRf4O/7PmMBfqBf4O9iAv9B74HmMv9R74DniLwW8aG+B51n9xd4Cz+v4i/UDT64BLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBL9r/MXS0kDgOiPQAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-14"/> </p>

<h3>3-2 outlier(이상치)</h3>

<p>이상치를 찾는 방법또한 여러가지가 있고 그 정의를 내리는 방법도 여러가지이다. </p>

<p>아래의 예 에서는 군집의 중심점에서 거리를 재었을때 그 값이 그 군집의 평균에서 표준 편차의 1.5.배보다 크며 그 주위 5%내에있는 점들과 거리를 계산했을때 평균값에서 표준 편차의 1.5배보다 먼 거리들이 80%이상일때 그 점을 이상치라고 정하였다.       </p>

<pre><code class="r">library(plyr)

Dat_S &lt;- split(Dat, Dat$Cluster)
DIST_C &lt;- lapply(Dat_S, function(x) {
    xx &lt;- x[, 1:4]
    k &lt;- km$centers[unique(x$Cluster), ]
    x$Dist &lt;- apply(xx, 1, function(z) sqrt(sum((z - k)^2)))
    SD &lt;- sd(x$Dist)
    Mean &lt;- mean(x$Dist)
    a &lt;- rep(0, nrow(x))
    a[which(x$Dist &gt; (Mean + 1.5 * SD))] &lt;- 1
    x$Outlier_Ind &lt;- a
    x
})

DIST_C &lt;- ldply(DIST_C, data.frame)

DIST &lt;- apply(DIST_C[, 2:5], 1, function(x) apply(DIST_C[, 2:5], 1, function(y) sqrt(sum((x - 
    y)^2))))


Outlier2 &lt;- apply(DIST, 1, function(x) x[which(x &gt; 0 &amp; x &lt; quantile(x, prob = 0.05))])
AvD &lt;- mean(unlist(Outlier2))
SD &lt;- sd(unlist(Outlier2))
Outlier2 &lt;- lapply(Outlier2, function(x) length(which(x &gt; (AvD + 1.5 * SD)))/length(x))

a &lt;- rep(0, nrow(DIST))
a[which(Outlier2 &gt; 0.8)] &lt;- 1
DIST_C$Outlier2_Ind &lt;- a

DIST_C$Outlier_Ind_Sum &lt;- DIST_C$Outlier_Ind + DIST_C$Outlier2_Ind


Outlier &lt;- DIST_C[which(DIST_C$Outlier_Ind_Sum == 2), ]
</code></pre>

<p>아래의 그래프는 위에서 정해진 이상치들이 어떻게 분포되어있는지를 보여준다. 붉은색의 점들이 이상치이다.</p>

<pre><code class="r">PC &lt;- princomp(DIST_C[, 2:5])$scores
plot(PC[, 1:2], pch = 16, col = &quot;grey&quot;, main = &quot;iris 데이터 군집의 이상치&quot;, 
    xlab = &quot;PC1&quot;, ylab = &quot;PC2&quot;)
points(PC[which(DIST_C$Outlier_Ind_Sum == 2), 1], PC[which(DIST_C$Outlier_Ind_Sum == 
    2), 2], col = &quot;red&quot;, pch = 16)
legend(&quot;topright&quot;, legend = &quot;이상치&quot;, pch = 16, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAALVBMVEX9/v0AAAAREREiIiIzMzNDRENUVVRlZmV2d3aHh4e+vr7b3Nvs7ez9/v3/AADc7rYFAAAAD3RSTlP/////////////////AP9q+opeAAAACXBIWXMAAAsSAAALEgHS3X78AAAOV0lEQVR4nO2diZqbOBZGm0nSM03iev/H7XF5Y5FAaL3Sf86Xr+IyaLk6aIEC+68bSPJX6wpAGxAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXpRRxU/T/d/mHfev05vVryfpV289XpwnMMR44t/WFiIf/7+33l+Ge3xmsEiwznKb4KAEQ3QqftlfnVve4t8KNvYOxE8bj4tMVu94EhyUYIhOxfvZiHfZX+7nSLru4u+fju69S/B40z1VGKNT8Y8W/v2fH9+vfv+cpl+/P1tuUeI/GrdJT8TvxgTnAGCMrsVP09/fr37cX/5cb/GJf21bWFpwWxwgoeKP9rBL1+L/e/vzfPVnteV2vcdvpK0Wh97+7MnSPeUbo2vxf56v/vf//v7PYsstQbyrrHXS/Ry/yWN/GmCQrsW/Xt3++fVj+vXZcksRv+37nvcd4jd1Q3wBtjPs7v8L4n0bgsWvLwAhviRr8T/vre7u8RvnXvHLrNdLvc2FvV2W7jXdxOlcEdbi//z9OZ17q1r2x9eO+603h/iT9/dZLvfYLQ6N0qn4U/YNf+zRcbF+483h8XICQ4wqHk5AvCiIFwXxoiBeFMSLgnhREC8K4kVBvCiIFwXxoiBeFMSLgnhREC8K4kVBvCiIFwXxoiBeFMSLkiJ+AssUFJ+QFvzkaVfEdwfiRUG8KIgXBfGiIF4UxIuCeFEQLwrik5nnuXUVIkB8KvPcpXl/uz4vwU+L/d6fxrJNiPju8Lbry/RevCMh4rtj0a5fX1/bDW/x0+3Vy19/jkP8iy69L9r162tlfiv++980LTe5cnEytvg+CRP//OEb9hHfH0Hip/XOiB+AwDl+nYRVff8EruqXN1ghfgTCxG/H+O1IgPgYmp4OhF3AWYhfnt4F5PIN4l20vQBw2q77od6REPERGBefIxfEu0B8StY9Y3SOz5gL4u2BeFEQLwriRUG8KIgXBfGi8Hw8JIB4URAvCuJFQbwoiBcF8aIgXpR08d7rAYi3TLL4zZ374VlDUxAviqD4Ph+VzI3aHD/PnT4cnRuxVf2M+CeIFyWb+E9GgX/xbQLeX4j1eFZ2L9TEwxPEi4J4UdIv4HiXcoi3TIYLOJFZ37Yf4QI1yTDU+7I4Fb/50CaoScs5HvENQbwoTVf1eG8Hp3OiIF4UxIuCeFEQLwriRUG8KIgXBfGiIP6UMe/WQvwZg96difgzEJ85615AfOasu2FI74hXBfGiIL44NqcKxJfG6OIQ8WUx+5SmivhGjW/3sWwR8a1a36x3xI9Z7jmIL15wi2LPERF/XYBZY5lQEX8Vu2N0JhDvwu6aLBuId2D3JCwfiHcg4B3xLlbaBz0CEL/iaXntfUjziF/isLx/a4wDAfFLQsQPMgQgfolLqqPDIz4la5MEOEV8YtbdMoR3xKuCeFEQLwrii2F7LYD4Uhhf/SO+FIjvljRxiPdhul1u6eaWqe3F2k688R6RtYIGY0W8F8SXydpgY2zIVz+DsTLHhxFUWf9O9mJN/zKi2+MLiS5n3RVBXTZkJzNHQA7xkzsjxEfmUwXEB4H4fQaTgvjUOX6xxyjiv2d4Zz7rt6wEnEKGGMw0Q61VvZ1DPZ7MMbRtEMSHkzeGxi2STfwnI+e3za7D7PMgWMWQHMIo4s+y3njv1fziZWIIKuKX9Cp+QYYQep/jfd8ijnjTZLlk687oIOvOG+1O7yG0EQ/NQbwoTeZ4aA83W1bA4noA8fGE+jR5BoD4aIJ9Ir5bnOIQH5d1R7jNhfs06B3xIXgUW/QZDOIDyDVWWzpSEP/kUMqZsTCjpuZ6xD9IkhKYGPEGiZLySoL4K1nb4lzKfvs7TahRQ96b3YiRkG8ZArz7P/TSYkAntBBvasgLYn7ieLdNhdJBfACzW3zg52AWqlQiBsSbbZtv7rXzeA9LbTS69nO83ba5M/t6+4XkmauUh/arerttc+dRu+ga2g0O8cesa3e9pmZjay/ebtt8s/EeVVeLERoQ3w8jrfAQH8TDHOJzZN0TL3XRIz3ireNWlKjOoHcb4u00jMdw/T5bvDwL4g0Nhb6qNPBeuMTm4pMujGXHSlVGF/+5IGqhte8Yqcng4u15r4oj7PdbY8/xfVnPXdF96DVbw4L4xa8JxZUmQUrgOWLVbtB8jl+8tN3546sXeo4oJP6D/VH/vHq+7aHniFVbwIT4PhZ5Ad4dd+W5N7hzrhm/BfF9eD/Fs1i7nQptErkl8QllNea78usY5te9ekGphcUnFNScZwAb78GHs5r4T7TdnNJ5cM/u4ffqtQi6nXjncd5n5/eKX/1etUqnID4H7kjWvxmLy4z4wDMf41w9lW+HiTl+ce3CWvtcw3lG597QGgur+g6u1wayi+L9hrnoEB+Bt6p+8eawJD6hrKocVNYx0huNq7H4V7NYbR4n5zadlyhs0fzPslYb5oDTWvcQFuIvEDo+9RAW4sMJrm0PYRmZ47sg3GcHYdlY1fdBDx05GKtfTWKyiatWqnBhRr+MqMPOlbnCpVsA8ZnIXWMT4p8juXNfxD8YUfx9n7t6975Cc/wR2UUVvvoXKv7+86LJ4Vb1xxQ7VMv0/XDxN1evTsgaAmkn/m0+LKNp8o7+R3Q3uNeiofgiWW/obzlX7VBtNseXyXpDf+L7q/GSMPHTwZ6ZVvX9NWN/NV5yYY73nM15Mxp9js8mvknkF1b1NS/gdEEWYXOj284Q35a5W/EJc3x3g3sBTIs/nOOjs+58cXTEhbhaeQ9d1V+/HiMsPiywue2TFm0foRIW3zr6lhdwTiLv9rAYR3zEOH+e9QJnE7RumQQCR3rz4o+u28Vn/cHdBq1bpjQdzPGIL0ezKO2Jf79W8C4g/ii+jXcF4S9si4+7s2K1e3CA2uLrxV7rdG5U8cmV3XqvFbw58X1N7ZlNDSj+3GdXwl8g/nrWGzob4p/krvV4c/wpfYovZqp4Y9gU3+UxEI0j2vLdwIz429p7V+bTauuKVkn8gs7EJ1YX8W+Exb9e6szxK7rynnycNpnkLInvS/eCfFddJcV3NsB7SIsC8d2yi8K5cjtKXqJWexCfmW0U+6hsxGlIfL9z/Ip9hzchfltma/E2Dv+C7E/WmoS8K7Sx+HlWML94+TQfnUVCLRBfHF9EkbHmaCLEV8AbUkPxzPEV8McUF2uRNmotfkTyiZrLPXRhRfxQHT+j92KtYkP8GFN99ghGFz/PQ4jPH8Lg4ucxxOcM4ZVRwTaxJD6hLANkjMGRU/bmMSM+oSAb5O3wxa/vGxA/yB9nMoYRJD6xOAvi3wxyBKTjspx5DLAkfowhP4GD8Feb7r8gfhyc3dq338Di5Y6CnUuP3Mfbw87xev3/mvhETIlf0b/4y/UPXcDlaBiT4udmdyjlJDCAo53GvnK349linXsPFN/q+DYsvncQH86jDZZt0fMhEDrS9yn++0PwMn3F6KsRVt47Nh9EowBziJ/cGcWLP3oH8oD4QTlrt3TxUz7xFx8wtEbuuqbkd9pjMizuJs9XjKvdZZt7dErKr4b4yKyHA/FhWQ+HKfHl53h/RmriTc3xp9jq8T0t5S5iLbQC4iM/3n6Yuy6dmAstXXymrxEf5XEaD+ZCy3LJ1p0R4heYC82c+IuJusFaaIbEm2uboTE0x0MewvqPrdM58BE+GgZOmIjvggvLn6rinbkgPh+ji2d55+HKCU/NOT6T+KHP59LI3jB25vh56As45jAjfkZ8VcyJTygQLmBLfEJpcA0z4lnR18WOeKiKNfH0+0oYE89MXwvEi4J4UYyJZ46vhTXxUAnEl6X8CBZZAuKLUn7NElsC4ouCeFEQrwpzPNgC8aJYFs/FnIIYFs/l25IgXhTEi2JYPHN8SSyLhwNSewXi+yR5HkR8nyBelGHEs4S/yCBzPM9P1QbxoiBeFCPimeNrY0U8VAbxoiBeFPPimfrLYF08i75CIF4UxItiXTxzfCHMi4cyIF4UxIuCeFEQLwrfSSOKpW+hgoogXhTEi8IcLwqrelEQL0o28czxfUGPF6WA+GnyrvfADPR4URAvSvoFHO/AjnjLZLiAE5k1NCXDUO/LAvGWYY4XBfGi5BHvzAXxlkG8KIbE8+hETezM8TwsVRXEi4J4UeyIZ46viiHxUBPEi4J4URAvCuJFQfyYfH19He9gRjwnczn5+jozb0U8l2+ygnhREK8Kczy4MSMe6oJ4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhSj4rktozQ2xXMjVnEQLwriRbEpnjn+Oqf31a4xKh6ucn4n/RrEDwLiRUG8KszxEALiRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KCXFg2XKiT86JjpIpl1HxJtOhvgCybTriHjTyRBfIJl2HRFvOhniCyTTrmMh8WAdxIuCeFEQLwriRUG8KIgXBfGiIF4UxItS6pLt2Q0gWZPFXNmsWFR0abF1bHfJdgorPFOyW0T7VCwqurTYOgZVstxQX++PGVO9Ro0palFipVQq4uv2pphE8QmjRqWWf50rODtlSVVdfLGu6yqqhfj3guRanV/JLkb6TDaq+NiVUn9DfbXmqS2+4vEScFP9zdiqvmLzVBZf8VwgsDhT5/Fhx6orYVRZMSXFztVRxfV3Hg/mQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aKoi//cBhn5QECvyIt//Xjfyxx7Z2tnIP62ePZkSnossisQf9s+dIR4BV5zPOLFmDb/3xCvwVp85KO3PYL4xYuoJ7U7BfHvV5zHgwCIFwXxoiBeFMSLgnhREC8K4kVBvCiIFwXxoiBeFMSLgnhREC8K4kVBvCiIF+VfBU+39gS8RAoAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-16"/> </p>

<h3>3-3 군집의 주위점들</h3>

<p>이 방법은 보통 잘 쓰지않지만 사기성 거래와같이 주류의 특성을 모방하는 경우 그 거래 내역들이 보통 군집의 가장자리에 나타나게되므로 사기 탐지같은 경우에 응용할수있겠다. </p>

<p>여기서도 역시 가장자리의 정의를 내리는 방법이 주관적이며 찾아내는 방법또한 여러가지이다. 아래 예에서는 군집의 중심점에서의 거리를 측정하였을때 그 군집의 80%밖에 나타나는 점들을 주위점이라고 정하였다.  </p>

<pre><code class="r">DIST_P &lt;- lapply(Dat_S, function(x) {
    xx &lt;- x[, 1:4]
    k &lt;- km$centers[unique(x$Cluster), ]
    x$Dist &lt;- apply(xx, 1, function(z) sqrt(sum((z - k)^2)))

    a &lt;- rep(0, nrow(x))
    a[which(x$Dist &gt; quantile(x$Dist, prob = 0.8))] &lt;- 1
    x$Periphery_Ind &lt;- a
    x
})

DIST_P &lt;- ldply(DIST_P, data.frame)

Periphery &lt;- DIST_P[which(DIST_P$Periphery_Ind == 1), ]
</code></pre>

<p>아래의 그래프는 위에서 정해진 군집의 가장자리들이 어떻게 분포되어있는지를 보여준다. 붉은색 테두리가 쳐진 점들이 주위점이다. </p>

<pre><code class="r">PC &lt;- princomp(DIST_P[, 2:5])$scores
plot(PC[, 1:2], pch = 16, col = (DIST_P$Cluster + 5), main = &quot;iris 데이터 군집의 주위점들&quot;, 
    xlab = &quot;PC1&quot;, ylab = &quot;PC2&quot;)
points(PC[which(DIST_P$Periphery_Ind == 1), 1], PC[which(DIST_P$Periphery_Ind == 
    1), 2], col = &quot;red&quot;, pch = 1, cex = 1.5)
legend(&quot;topright&quot;, legend = &quot;주위점&quot;, pch = 1, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-18"/> </p>

<h3>3-4 데이터 안에있는 범주형 변수를 활용하는 방법</h3>

<p>데이터 안에 범주형 변수가 있을경우 그 변수가 어떻한 참고값을 나타낸다면, 이것을 이용해서 데이터안에있는 예외적인 (unusual) 거래내역을 찾아낼수있다.  </p>

<p>아래의 예는 iris데이터에있는 Species라는 범주형변수를 참고값으로 사용했을때, iris 꽃의 여러 종들이 어떻게 군집들 사이로 분포되었는지 보여준다. </p>

<p>여기서 각 종들마다 특정 군집들에 집중되어 있는것을 볼수있는데 versicolor라는 종중 소수의 몇개가 다른 군집에 들어가 있는것을 볼수있다. 이 말은 이 몇개의 versicolor 꽃들은 같은종의 꽃들보다 다른 종의 특성을 더 닯고있음을 얘기한다. 즉 돌연변이같은 예외적인 꽃들이라고 볼수있다. </p>

<pre><code class="r">table(Dat$Species, Dat$Cluster)
</code></pre>

<pre><code>##             
##               1  2  3  4
##   setosa      0 17  0 33
##   versicolor  2  0 48  0
##   virginica  36  0 14  0
</code></pre>

</body>

</html>

