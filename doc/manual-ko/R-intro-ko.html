<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- Created on March 3, 2013 by texi2html 1.82
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>An Introduction to R</title>

<meta name="description" content="An Introduction to R">
<meta name="keywords" content="An Introduction to R">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.82">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.roman {font-family:serif; font-weight:normal;}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="Top"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="An-Introduction-to-R"></a>
<h1 class="settitle">An Introduction to R</h1>




<p>이 문서는 통계계산 및 그래픽를 위한 언어이며 환경이기도 한 R에 대한 기초안내서 입니다.
R은 벨연구소에서 John Chambers 외 다수에 의해서 개발된 이래 수상을 받은 적이 있는 S 시스템과 유사하므로 &ldquo;GNU S&rdquo;라고도 불리우고, 매우 다양한 분야에 걸친 통계분석 및 그래픽 기능들을 제공합니다.  
예를들면, 선형 및 비선형 모델링, 다양한 통계 테스트들, 시계열분석, 클래시피케이션, 그리고 클러스터링 등이 있습니다.
이 문서는 R을 시작하는 분들에게 반드시 필요한 기본적인 데이터형에 대한 이해, 프로그래밍의 기본요소들, 그리고 통계적 모델링과 그래픽에 대한 정보를 제공합니다.
현재 이 문서의 버전은 3.0.0 Under development (2013-02-11)이며, 한국어 버전의 마지막 업데이트는 2013년 03월 01일에 이루어졌습니다.
</p>
<p>ISBN 3-900051-12-7
</p>
<p>Copyright &copy; 1990 W. N. Venables<br>
Copyright &copy; 1992 W. N. Venables &amp; D. M. Smith<br>
Copyright &copy; 1997 R. Gentleman &amp; R. Ihaka<br>
Copyright &copy; 1997, 1998 M. Maechler<br>
Copyright &copy; 1997&ndash; R Core Team<br>
Copyright &copy; 1999&ndash;2012 R Core Team
</p>
<p>Permission is granted to make and distribute verbatim copies of this
manual provided the copyright notice and this permission notice are
preserved on all copies.
</p>
<p>Permission is granted to copy and distribute modified versions of this
manual under the conditions for verbatim copying, provided that the
entire resulting derived work is distributed under the terms of a
permission notice identical to this one.
</p>
<p>Permission is granted to copy and distribute translations of this manual
into another language, under the above conditions for modified versions,
except that this permission notice may be stated in a translation
approved by the R Core Team.
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Preface">Preface</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                     
</td></tr>
<tr><td align="left" valign="top"><a href="#Introduction-and-preliminaries">1. 1 Introduction and preliminaries</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Simple-manipulations-numbers-and-vectors">2. Simple manipulations; numbers and vectors</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Objects">3. Objects, their modes and attributes</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                     
</td></tr>
<tr><td align="left" valign="top"><a href="#Factors">4. Ordered and unordered factors</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                     
</td></tr>
<tr><td align="left" valign="top"><a href="#Arrays-and-matrices">5. Arrays and matrices</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         
</td></tr>
<tr><td align="left" valign="top"><a href="#Lists-and-data-frames">6. Lists and data frames</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       
</td></tr>
<tr><td align="left" valign="top"><a href="#Reading-data-from-files">7. Reading data from files</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     
</td></tr>
<tr><td align="left" valign="top"><a href="#Probability-distributions">8. Probability distributions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   
</td></tr>
<tr><td align="left" valign="top"><a href="#Loops-and-conditional-execution">9. Grouping, loops and conditional execution</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Writing-your-own-functions">10. Writing your own functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Statistical-models-in-R">11. Statistical models in R</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     
</td></tr>
<tr><td align="left" valign="top"><a href="#Graphics">12. Graphical procedures</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    
</td></tr>
<tr><td align="left" valign="top"><a href="#Packages">13. Packages</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    
</td></tr>
<tr><td align="left" valign="top"><a href="#A-sample-session">A. A sample session</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            
</td></tr>
<tr><td align="left" valign="top"><a href="#Invoking-R">B. Invoking R</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                  
</td></tr>
<tr><td align="left" valign="top"><a href="#The-command_002dline-editor">C. The command-line editor</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     
</td></tr>
<tr><td align="left" valign="top"><a href="#Function-and-variable-index">D. Function and variable index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Concept-index">E. Concept index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               
</td></tr>
<tr><td align="left" valign="top"><a href="#References">F. References</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                  
</td></tr>
</table>

<hr size="1">
<a name="Preface"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Preface-1"></a>
<h1 class="unnumbered">Preface</h1>




<p>본래 R에 대한 이 안내서는 1990년부터 1992년 사이에 Bill Venables과 David M. Smith가 Adelaide 대학에서 S와 <small>S-PLUS</small>에 대하여 작성한 노트를 토대로 하고 있습니다.
그러나, R과 S 사이의 다른 점들을 반영하기 위하여 우리는 원래 노트의 내용에 적절한 수정을 가하고 일부의 내용들을 더욱 보강하였습니다.
이렇게 원래의 노트에 대한 수정과 재배포를 수락하고, R을 지지해주는 Bill Venables (그리고 David Smith)에게 우리는 깊은 감사의 뜻을 전합니다. 
</p>
<p>이 한국어 문서는 R Development Translation Teams의 이철희에 의해서 번역되었으며, R의 빠른 변화를 충분히 반영하되 사용의 혼돈을 줄이고 전산학 또는 통계학이 전공이 아닌 독자들을 위하여 전문용어에 대한 개념풀이와 해석을 덧붙임으로서 R이 가진 기능들을 한국어 독자들에게 맞추어 쉽게 전달하고자 하였습니다. 
본 한국어 문서에 대한 제안사항 및 정정에 관련된 내용을 <a href="mailto:gnustats@korea.gnu.org">gnustats@korea.gnu.org</a>으로 보내주시면 매우 감사드리겠습니다.
</p>
<a name="g_t_cc98_c74c-_c811_d558_b294-_c0ac_c6a9_c790_c5d0_ac8c"></a>
<h3 class="subheading">처음 접하는 사용자에게 </h3>



<p>만약 독자가 R을 처음 접하는 것이라면 R이 어떻게 동작하는가에 대한 즉각적인 이해를 가지기 위하여 Appendix A를 가장 먼저 보기를 권합니다.
많은 사용자들은 R이 가진 그래픽 기능들 때문에 이를 사용하곤 합니다. 
따라서, 그래픽 관련주제들을 <a href="#Graphics">Graphical procedures</a>에 따로 모아 독자가 필요할때마다 쉽게 찾아볼 수 있도록 하였습니다. 
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Introduction-and-preliminaries">1. 1 Introduction and preliminaries</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Introduction-and-preliminaries"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Preface" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-R-environment" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Preface" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="g_t1-Introduction-and-preliminaries"></a>
<h1 class="chapter">1. 1 Introduction and preliminaries</h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#The-R-environment">1.1 The R environment</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           
</td></tr>
<tr><td align="left" valign="top"><a href="#Related-software-and-documentation">1.2 Related software and documentation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#R-and-statistics">1.3 R and statistics</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            
</td></tr>
<tr><td align="left" valign="top"><a href="#R-and-the-window-system">1.4 R and the window system</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     
</td></tr>
<tr><td align="left" valign="top"><a href="#Using-R-interactively">1.5 Using R interactively</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       
</td></tr>
<tr><td align="left" valign="top"><a href="#Getting-help">1.7 Getting help with functions and features</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                
</td></tr>
<tr><td align="left" valign="top"><a href="#R-commands_003b-case-sensitivity-etc">1.8 R commands, case sensitivity, etc.</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Recall-and-correction-of-previous-commands">1.9 Recall and correction of previous commands</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Executing-commands-from-or-diverting-output-to-a-file">1.10 Executing commands from or diverting output to a file</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Data-permanency-and-removing-objects">1.11 Data permanency and removing objects</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
</table>

<hr size="6">
<a name="The-R-environment"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Related-software-and-documentation" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-R-environment-1"></a>
<h2 class="section">1.1 The R environment</h2>



<p>R은 데이터의 조작 및 수치연산, 그리고 시각화를 수행할 수 있는 소프트웨어 기능들을 한데 모아 놓은 통합개발환경이라고 할 수 있으며, 특히 다음과 같은 기능들을 제공하고 있습니다. 
</p> 
<ul>
<li> 
효과적인 데이터 관리 및 저장 기능들,  
</li><li> 
배열기반의 연산을 수행하기 위한 연산자들 (행렬에 더욱 특화되어 있음),
</li><li> 
데이터 분석에서 중간과정의 단계를 모두 확인하는데 필요한 기능들을 일관성 있게 잘 조합해 놓은 통합적 분석도구들, 
</li><li> 
데이터 분석 및 시각화된 결과물을 컴퓨터에서 확인 및 하드카피로의 출력할 수 있는 기능들, 
</li><li> 
조건문, 반복문, 사용자 정의 함수, 그리고 입출력을 관리할 수 있는 기능들을 가지고 있는 프로그래밍 언어를 제공합니다. 
특히 이 언어는 &rsquo;S&rsquo;라고도 불리우며 단순하면서도 효율적이며 매우 잘 개발되어 있습니다.
(실제로 시스템의 대다수의 함수들은 S언어로 작성되었습니다). 
</li></ul>



<p>&ldquo;environment&rdquo;(인바이런먼트 또는 개발환경)라는 용어는 다른 분석소프트웨어들의 경우처럼 사용방법에 제약이 많아 유용성이 없는 도구들을 추가적으로 계속 제공하는 것과는 달리 완전하게 잘 계획되어 있는 일관성있는 시스템 자체를 지칭하고자 사용합니다. 
<em>이 문서에서 역자는 environment라는 용어를 영문 그대로 environment라고 사용할 것입니다. 
그 이유는 environment라는 개념은 이 소개서의 이 부분내 문맥상 개발환경이라고 이해해도 무난하지만, 이 소개서의 내용을 뛰어넘는 프로그램의 개발에서는 environment라는 용어에 대한 개념이 단순히 개발환경은 아닙니다. 
따라서, 역자는 개념적 혼돈을 주지않기 위해서 영문 environment를 그대로 사용할 것이고, 필요시에는 추가설명을 덧붙여줄것입니다. 
프로그래머에게 필요한 더 자세한 사항은 R language definition 문서에서 다루도록 하겠습니다</em>.
</p>
<p>R은 시스템과 분석자간의 쌍방향 데이터 분석에 사용될 방법들을 새로이 개발하는데 사용되는 수단이라고 할 수 있습니다.
따라서, 방대한 양의 <em>packages</em>(패키지)에 의해서 더욱 빠르게 확장되어 개발될 수 있습니다. 
그러나, R로 쓰여진 대부분의 프로그램들은 단 하나의 데이터 분석을 위해 개발된 프로그램들이 대다수 이므로, 범용성에 제한이 있다는 것을 기억해야 합니다. 
</p>
<hr size="6">
<a name="Related-software-and-documentation"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-R-environment" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#R-and-statistics" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Related-software-and-documentation-1"></a>
<h2 class="section">1.2 Related software and documentation</h2>




<p>R을 Bell 연구실에서 근무하던 Rick Becker, John Chambers 그리고 Allan Wilks에 의해 개발되어 <small>S-PLUS</small> 시스템의 기반을 형성한 S 언어의 구현물이라고 생각하셔도 괜찮습니다. 
</p>
<p>S언어의 진화과정은 John Chambers와 그의 동료들이 쓴 네 권의 책에 의해서 정리될 수 있습니다.
R의 가장 기본적인 참고자료라고 한다면 Richard A. Becker, John M. Chambers 그리고 Allan R. Wilks가 저술한 <em>The New S Language: A Programming Environment for Data Analysis and Graphics</em>라는 책을 들 수 있습니다. 
1991년에 릴리즈된 S의 새로운 기능들에 대해서는 John M. Chambers와 Trevor J. Hastie가 편집한 <em>Statistical Models in S</em>이라는 책을 참고하시길 바랍니다. 
<strong>methods</strong> 패키지의 method(메소드)와 class(클래스)들은 John M. Chambers가 저술한 <em>Programming with Data</em>에서 찾아 볼 수 있습니다. 
더 정확한 참고자료들은 See section <a href="#References">References</a>를 살펴보세요.
</p>
<p>현재 R을 이용한 데이터 분석과 통계학에 관련된 많은 서적들이 나와 있으며, S/<small>S-PLUS</small>를 위한 문서들 역시 R을 사용하는데 도움이 될 것입니다. 
그러나, 반드시  S과 @${은 다르게 구현이 되어 있다는 것을 반드시 기억하고 계셔야 합니다.
더 자세한 사항은 See <a href="R-FAQ.html#What-documentation-exists-for-R_003f">(R-FAQ)What documentation exists for R?</a> section &lsquo;What documentation exists for R?&rsquo; in <cite>The R statistical system FAQ</cite>을 참고하시길 바랍니다. 
</p>
<hr size="6">
<a name="R-and-statistics"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Related-software-and-documentation" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#R-and-the-window-system" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="R-and-statistics-1"></a>
<h2 class="section">1.3 R and statistics</h2>
<a name="index-Packages"></a>




<p>R의 개발환경에 대한 이 안내서에서는 <em>statistics</em>(통계학)을 다루고 있지 않지만, 많은 독자들은 R을 통계시스템으로서 사용합니다. 
우리는 독자들이 R을 과거부터 현대에 이르기까지 개발되어온 많은 통계학적 방법론들이 구현되어 있는 하나의 개발환경이라고 생각해주었으면 합니다. 
이들중 일부는 기본 R 개발환경내에 포함되어 있으나, 대부분은 <em>packages</em>(패키지들)의 형태로 제공이 됩니다. 
R은 &ldquo;standard&rdquo;(기본) 혹은 &ldquo;recommended&rdquo;(추천) 패키지라고 불리는 총 25개의 패키지들과 함께 제공되며, 더 많은 패키지들을 인터넷 저장소인 <acronym>CRAN</acronym>을 통하여 <a href="http://CRAN.R-project.org">http://CRAN.R-project.org</a>) 얻을 수 있습니다. 
더 자세한 내용은 (see section <a href="#Packages">Packages</a>) 부분에서 설명합니다.
</p>
<p>가장 고전적인 통계적 방법부터 최근에 개발된 대부분의 통계적 방법들을 R과 함께 사용할 수 있으나, 이들을 찾기 위해서는 다소의 노력이 필요할 수 있습니다. 
</p>
<p>독자들은 S (여기에서는 R)이 다른 주요 통계시스템들과는 근본적으로 다르다는 점을 반드시 인지하고 있어야 합니다. 
예를들면, S에서는 통계적 분석을 일련의 절차를 통해서 할 수 있게 되어 있으며, 중간과정마다 얻어진 결과물을 객체라는 중간매체에 저장해 둡니다. 
따라서, SAS 또는 SPSS가 회귀분석 또는 판별분석을 수행하여 한 번에 방대한 양의 결과를 제공하는 것과는 달리, R은 최소한의 결과물만으르 제공하고, 더 자세한 중간 수행과정 및 결과를 확인하고 싶다면 추가적인 R 함수들을 이용해야 합니다. 
</p>
<hr size="6">
<a name="R-and-the-window-system"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#R-and-statistics" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Using-R-interactively" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="R-and-the-window-system-1"></a>
<h2 class="section">1.4 R and the window system</h2>




<p>R을 사용하는 가장 손쉬운 방법은 윈도잉 시스템(windowing sytem, 즉 여러개의 창을 띄어줄 수 있는 시스템)을 사용하는 그래픽 워크스테이션을 이용하는 것입니다.  
본 문서는 이러한 기능이 있는 시스템을 가진 독자를 위한 것입니다.
주로 X 윈도우 시스템에서의 R의 사용을 얘기할 것이지만, 이러한 설명들은 어떠한 실행된 R의 사용환경에서도 일반적으로 동일하게 적용됩니다. 
</p>
<p>때때로, 대부분 사용자들은 사용자의 컴퓨터에 있는 운영체제와 직접적인 소통을 해야할 필요성을 느낄 것입니다.
본 문서에서는 사용자가 UNIX에서의 운영체제를 다룬다고 가정한 상태에서 작성되었습니다. 
만약, R을 윈도우즈 혹은 Mac 운영체제에서 사용하시는 분들은 본문서에서 설명하는 사용법이 약간 다를 수 있다는 점을 인지해주셨으면 합니다. 
</p>
<p>최적화된 성능의 R을 워크스테이션에서 사용하기 위해서 설정하는 방법은 다소 기술적인 조정이 필요한 것을 제외하고는 단순하지만, 이 안내서에서는 이러한 기술적인 부분에서는 다루지 않습니다.  
이러한 조정에 어려움이 있는 사용자는 해당분야의 전문가의 도움을 받기를 부탁드립니다.
</p>
<hr size="6">
<a name="Using-R-interactively"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#R-and-the-window-system" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#An-introductory-session" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Using-R-interactively-1"></a>
<h2 class="section">1.5 Using R interactively</h2>


<p>R 프로그램을 실행시키면, 사용자의 입력을 기다리는 표시 &lsquo;<samp><code>&gt;</code></samp>&rsquo; (프롬프트라고 읽음)를 볼 수 있을 것입니다.
이 표시는 아마 UNIX에서의 쉘프로프트와도 동일할 수 있습니다. 
따라서, 사용자가 원한다면 R의 프롬프트를 다른 모양으로 변경하여 사용할 수 있도록 해두었습니다.
이 문서에서는 내용의 명확성을 위해서 유닉스의 쉘 프롬프트를 &lsquo;<samp><code>$</code></samp>&rsquo;라는 표시를 이용하도록 하겠습니다. 
</p>

<p>유닉스내에서 R을 사용하기 위해서는 먼저 아래의 과정들을 따라 해주시길 권장합니다.
</p>
<ol>
<li>

먼저 아래와 같이 R에서 사용할 데이터 파일들을 저장할 장소를 위한 &lsquo;<tt>work</tt>&rsquo;라는 별도의 서브 디렉토리를 생성합니다. 
그리고, 이곳이 바로 데이터와 관련하여 R을 사용하게 될 working directory (워킹 디렉토리 또는 작업디렉토리)라고 합니다. 

<table><tr><td>&nbsp;</td><td><pre class="example">$ mkdir work
$ cd work
</pre></td></tr></table>

</li><li>

아래의 명령어를 이용하여 R프로그램을 시작하세요.
<table><tr><td>&nbsp;</td><td><pre class="example">$ R
</pre></td></tr></table>

</li><li>
이제부터 R 명령어들을 이용하여 작업을 할 수 있습니다.

</li><li>
R 프로그램을 종료하기 위해서는 다음의 명령어를 사용합니다. 

<table><tr><td>&nbsp;</td><td><pre class="example">&gt; q()
</pre></td></tr></table>


<p>이처럼 종료명령어를 사용했을때에는 R프로그램은 현재 R세션에서 작업하던 데이터를 종료전에 저장할 것인지 아닌지에 대한 <kbd>yes</kbd>(예), <kbd>no</kbd>(아니요) 혹은 명령을 취소하고 다시 R세션으로 돌아갈 것인지에 대한 <kbd>cancel</kbd> (취소)를 할 것인지를 물어볼 것입니다. 
이 저장여부에 대한 메시지는 일부 시스템에서는 대화창을 통해 보여질 수도 있고, 종료명령어 다음줄에 텍스트 형식으로 나타날 수도 있습니다. 
만약, 저장을 선택한다면 저장된 데이터는 다음번에 R을 실행하였을때 다시 사용할 수 있습니다. 
</p></li></ol>

<p>새로운 R세션을 시작하는 것은 간단합니다. 
</p><ol>
<li>
&lsquo;<tt>work</tt>&rsquo;이라는 작업 (혹은 워킹) 디렉토리를 만들고 위에서 했던 것과 같이 아래의 명령을 이용하여 프로그램을 시작하면 됩니다. 
<table><tr><td>&nbsp;</td><td><pre class="example">$ cd work
$ R
</pre></td></tr></table>

</li><li>

R프로그램을 사용하고 난뒤에 세션의 끝에서 <code>q()</code> 명령어를 이용하여 종료할 수 있습니다.  
</li></ol>


<p>윈도우즈에서 R을 사용하는 방법은 기본적으로 유닉스에서의 사용방법과 동일합니다.
먼저 워킹 디렉토리에 해당하는 폴더를 생성하고, &lsquo;<tt>Start In</tt>&rsquo; 메뉴에서 R 바로가기를 바탕화면에 생성합니다.
그런 다음부터는 바탕화면의 바로가기 아이콘을 이용하여 R을 실행시킬 수 있습니다. 
</p>
<hr size="6">
<a name="An-introductory-session"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Using-R-interactively" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Getting-help" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">1.6 An introductory session</h2>


<p>다음의 내용들을 읽어보기 전에 R에 대해서 좀 더 친숙해보고자 하는 독자들은 <a href="#A-sample-session">A sample session</a>에 있는 기초세션을 따라 입력해 봄으로서 어떤식으로 작동하는지 알아보기를 강력히 권장합니다. 
</p>
<hr size="6">
<a name="Getting-help"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#An-introductory-session" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#R-commands_003b-case-sensitivity-etc" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Getting-help-with-functions-and-features"></a>
<h2 class="section">1.7 Getting help with functions and features</h2>
<a name="index-help"></a>


<p>R은 UNIX에서 <code>man</code>이라는 명령어를 도움말 기능을 사용하는 것과 유사한 기능을 제공하고 있습니다. 
예를들어, <code>solve</code>라는 함수와 같이 어떤 특정한 이름을 가지고 있는 함수들에 대한 도움말을 보고자 한다면 다음의 명령어(즉, 함수)를 이용해보세요.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; help(solve)
</pre></td></tr></table>
<a name="index-help-1"></a>

<p>아래와 같은 방법으로도 동일한 도움말 기능을 사용할 수 있습니다. 
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; ?solve
</pre></td></tr></table>
<a name="index-_003f"></a>


<p>아래와 같이 special character (특수문자)의 기능들을 알고 싶을 때에는 반드시 큰 따옴표 혹은 작은 따옴표를 함께 사용하여 &ldquo;character string(문자열)&rdquo;의 형식을 갖추어 검색을 하도록 합니다.
이러한 형식을 갖추어야 할 또 다른 경우는 <code>if</code>, <code>for</code> 그리고 <code>function</code>과 같은 R의 예약어 또는 문법에 해당하는 내용을 검색하고자 할 때입니다.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; help(&quot;[[&quot;)
</pre></td></tr></table>


<p>일반적으로 두 가지 종류의 따옴표를 이용할 수 있으나, 큰 따옴표를 사용하는 것을 권장합니다.
그 이유는 <code>&quot;It's important&quot;</code>와 같은 경우도 있을 수 있기 때문입니다.
</p>

<p>대부분의 경우 R을 설치할때 <acronym>HTML</acronym>형식의 도움말이 함께 설치되며, 아래와 같은 함수를 이용하여 해당기능을 이용할 수 있습니다. 
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; help.start()
</pre></td></tr></table>
<a name="index-help_002estart"></a>


<p>위의 함수를 입력하면, 하이퍼링크로 서로 연결이 되어 있어 도움말을 탐색할 수 있는 <acronym>HTML</acronym> 기반의 도움말 시스템을 위한 웹브라우저가 실행되게 됩니다. 
최초 <code>help.start()</code>에 의해서 로딩된 &rsquo;Search Engine and Keywords&rsquo;라는 링크가 나타는 페이지가 특히 유용한데 현재 이용가능한 함수들을 모두 보여주는 고차원 (high-level) 개념들에 대한 목록을 포함하고 있기 때문입니다.
이것은 자신이 R시스템에 대한 이해정도를 확인하고 R이 제공해 줄 수 있는 것이 무엇인지 확인이 가능하도록 해줍니다.
</p>
<a name="index-help_002esearch"></a>

<p><code>help.search</code> 명령어 (또 다른 표현으로 <code>??</code>)는 좀 더 다양한 방식으로 도움말을 검색합니다. 
예를들어, 아래와 같이 입력해보세요.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; ??solve
</pre></td></tr></table>
<a name="index-_003f_003f"></a>

<p>더 자세한 내용과 예제들을 확인해보고 싶으시다면 <code>?help.search</code>를 이용하여 확인하시길 바랍니다.
</p>
<p>특별히 찾고자 하는 도움말 주제와 연관된 예제들은 아래와 같은 방법으로 실행할 수가 있습니다. 
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; example(<var>topic</var>)
</pre></td></tr></table>
<a name="index-example"></a>

<p>윈도우즈 버전의 R은 또 다른 방법의 도움말 시스템을 가지고 있습니다. 이에 대해서 알고 싶으시다면 다음과 같이 <code>help</code>의 도움말을 살펴보시길 부탁드립니다.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; ?help
</pre></td></tr></table>


<hr size="6">
<a name="R-commands_003b-case-sensitivity-etc"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Getting-help" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Recall-and-correction-of-previous-commands" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="R-commands_002c-case-sensitivity_002c-etc_002e"></a>
<h2 class="section">1.8 R commands, case sensitivity, etc.</h2>


<p>기술적인 측면에서 말하자면, 아주 단순한 문법을 가진 R은 <em>expression language</em>(표현식을 기초로 하는 언어)입니다. 
UNIX를 기반으로 하는 다른 패키지들과 같이 <em>case sensitive</em>(대소문자를 구별)하므로, <code>A</code>와 <code>a</code>는 다른 심볼(즉, 기호)로 인식되어 서로 다른 변수들을 가리키게 되는 것을 유념하시길 바랍니다.
R에서 사용될 수 있는 기호들은 사용자의 운영체제 및 <em>locale</em>(로케일, 즉 언어설정과 관계된 운영체제의 사용국가설정)에 따라 달라질 수 있습니다.
일반적으로 모든 알파벳 기호들<a name="DOCF1" href="#FOOT1">(1)</a>은 사용이 가능하며, 일부국가에서 사용되는 엑센트가 있는 문자들 역시 사용이 가능합니다.
또한, &lsquo;<samp><code>.</code></samp>&rsquo;와 &lsquo;<samp><code>_</code></samp>&rsquo;을 함께 조합하여 사용할 수도 있습니다.
그러나, &lsquo;<samp><code>.</code></samp>&rsquo; 또는 문자로만 시작을 해야하며, 만약 &lsquo;<samp><code>.</code></samp>&rsquo;로 시작하는 표현식이 있다면 그 두번째 문자는 반드시 숫자가 아닌 문자가 와야 합니다. 
R 2.13.0 이전버전들은 표현식의 길이가 256바이트를 넘을 수 없었으나, 현재는 제약이 없습니다. 
</p>



<p>기본적인 명령어(command)란 <em>expressions</em>(표현식)과 <em>assignment</em>(할당)이라는 두가지 요소로 구성됩니다. 
만약 표현식이 할당없이 홀로 사용되게 된다면, 이는 단순 명령어와 같이 처리되어 표현식이 처리된 후에는 어떠한 값도 저장되지 않은 채로 결과를 출력하게 됩니다. 
반면에, 표현식이 할당과 같이 함께 쓰여진다면, 표현식이 처리된 후의 값을 변수에 넘겨주게 되고 할당된 결과에 대해서는 자동으로 출력되지 않도록 되어 있습니다. 
</p>
<p>일반적으로 명령어들은 세미콜론(&lsquo;<samp><code>;</code></samp>&rsquo;) 또는 새로운 행 (newline)에 의해서 구분되어지게 되어 있습니다. 
기본적인 명령어들은 열린 중괄호 &lsquo;<samp><code>{</code></samp>&rsquo;와 닫힌 중괄호 &lsquo;<samp><code>}</code></samp>&rsquo; 내에 사용되어 짐으로서 한개의 작업단위를 구분할 수 있도록 그룹을 형성할 수 있습니다.  그리고, 이러한 그룹된 표현식을 compound expression(복합 표현식)이라고 합니다. 
해쉬마크 (&lsquo;<samp><code>#</code></samp>&rsquo;)로 시작하는 <em>Comments</em>(주석)이라는 것은 해쉬마크가 있는 곳으로부터 해당 행 (또는 라인)의 끝까지 컴퓨터가 수행하지 않도록 처리해 줍니다.  
이러한 주석처리는 사용자가 프로그램을 읽기 쉽도록 도와주며 프로그램내 어디에든 위치할 수 있습니다 <a name="DOCF2" href="#FOOT2">(2)</a>.
</p>

<p>만약, 명령어가 현재행에서 끝나지 않고 다음행으로 계속 이어지게 된다면, R은 아래와 같이 다른 기호를 이용하여 continuation을 표현하게 될 것입니다. 
</p><table><tr><td>&nbsp;</td><td><pre class="example">+
</pre></td></tr></table>

<p>on second and subsequent lines and continue to read input until the
command is syntactically complete.  This prompt may be changed by the
user.  We will generally omit the continuation prompt
and indicate continuation by simple indenting.
</p>
<p>Command lines entered at the console are limited<a name="DOCF3" href="#FOOT3">(3)</a> to about 4095 bytes (not characters).
</p>
<hr size="6">
<a name="Recall-and-correction-of-previous-commands"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#R-commands_003b-case-sensitivity-etc" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Executing-commands-from-or-diverting-output-to-a-file" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Recall-and-correction-of-previous-commands-1"></a>
<h2 class="section">1.9 Recall and correction of previous commands</h2>

<p>Under many versions of UNIX and on Windows, R provides a mechanism
for recalling and re-executing previous commands.  The vertical arrow
keys on the keyboard can be used to scroll forward and backward through
a <em>command history</em>.  Once a command is located in this way, the
cursor can be moved within the command using the horizontal arrow keys,
and characters can be removed with the &lt;DEL&gt; key or added with the
other keys.  More details are provided later: see section <a href="#The-command_002dline-editor">The command-line editor</a>.
</p>
<p>The recall and editing capabilities under UNIX are highly customizable.
You can find out how to do this by reading the manual entry for the
<strong>readline</strong> library.
</p>
<p>Alternatively, the Emacs text editor provides more general support
mechanisms (via <acronym>ESS</acronym>, <em>Emacs Speaks Statistics</em>) for
working interactively with R.  See <a href="R-FAQ.html#R-and-Emacs">(R-FAQ)R and Emacs</a> section &lsquo;R and Emacs&rsquo; in <cite>The R statistical system FAQ</cite>.
</p>
<hr size="6">
<a name="Executing-commands-from-or-diverting-output-to-a-file"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Recall-and-correction-of-previous-commands" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Data-permanency-and-removing-objects" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Executing-commands-from-or-diverting-output-to-a-file-1"></a>
<h2 class="section">1.10 Executing commands from or diverting output to a file</h2>
<a name="index-Diverting-input-and-output"></a>

<p>If commands<a name="DOCF4" href="#FOOT4">(4)</a> are stored in an external
file, say &lsquo;<tt>commands.R</tt>&rsquo; in the working directory &lsquo;<tt>work</tt>&rsquo;, they
may be executed at any time in an R session with the command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; source(&quot;commands.R&quot;)
</pre></td></tr></table>
<a name="index-source"></a>

<p>For Windows <strong>Source</strong> is also available on the
<strong>File</strong> menu.  The function <code>sink</code>,
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; sink(&quot;record.lis&quot;)
</pre></td></tr></table>
<a name="index-sink"></a>

<p>will divert all subsequent output from the console to an external file,
&lsquo;<tt>record.lis</tt>&rsquo;.  The command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; sink()
</pre></td></tr></table>

<p>restores it to the console once again.
</p>
<hr size="6">
<a name="Data-permanency-and-removing-objects"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Executing-commands-from-or-diverting-output-to-a-file" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Data-permanency-and-removing-objects-1"></a>
<h2 class="section">1.11 Data permanency and removing objects</h2>

<p>The entities that R creates and manipulates are known as
<em>objects</em>.  These may be variables, arrays of numbers, character
strings, functions, or more general structures built from such
components.
</p>
<p>During an R session, objects are created and stored by name (we
discuss this process in the next session).  The R command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; objects()
</pre></td></tr></table>

<p>(alternatively, <code>ls()</code>) can be used to display the names of (most
of) the objects which are currently stored within R.  The collection
of objects currently stored is called the <em>workspace</em>.
<a name="index-Workspace"></a>
</p>
<p>To remove objects the function <code>rm</code> is available:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; rm(x, y, z, ink, junk, temp, foo, bar)
</pre></td></tr></table>
<a name="index-rm"></a>
<a name="index-Removing-objects"></a>

<p>All objects created during an R session can be stored permanently in
a file for use in future R sessions.  At the end of each R session
you are given the opportunity to save all the currently available
objects.  If you indicate that you want to do this, the objects are
written to a file called &lsquo;<tt>.RData</tt>&rsquo;<a name="DOCF5" href="#FOOT5">(5)</a> in the current directory, and the command lines used in the
session are saved to a file called &lsquo;<tt>.Rhistory</tt>&rsquo;.
</p>
<p>When R is started at later time from the same directory it reloads
the workspace from this file.  At the same time the associated commands
history is reloaded.
</p>
<p>It is recommended that you should use separate working directories for
analyses conducted with R.  It is quite common for objects with names
<code>x</code> and <code>y</code> to be created during an analysis.  Names like this
are often meaningful in the context of a single analysis, but it can be
quite hard to decide what they might be when the several analyses have
been conducted in the same directory.
</p>
<hr size="6">
<a name="Simple-manipulations-numbers-and-vectors"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Data-permanency-and-removing-objects" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Vectors-and-assignment" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction-and-preliminaries" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Objects" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Simple-manipulations_003b-numbers-and-vectors"></a>
<h1 class="chapter">2. Simple manipulations; numbers and vectors</h1>
<a name="index-Vectors"></a>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Vectors-and-assignment">2.1 Vectors and assignment</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      
</td></tr>
<tr><td align="left" valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           
</td></tr>
<tr><td align="left" valign="top"><a href="#Generating-regular-sequences">2.3 Generating regular sequences</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Logical-vectors">2.4 Logical vectors</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             
</td></tr>
<tr><td align="left" valign="top"><a href="#Missing-values">2.5 Missing values</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              
</td></tr>
<tr><td align="left" valign="top"><a href="#Character-vectors">2.6 Character vectors</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           
</td></tr>
<tr><td align="left" valign="top"><a href="#Index-vectors">2.7 Index vectors; selecting and modifying subsets of a data set</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               
</td></tr>
<tr><td align="left" valign="top"><a href="#Other-types-of-objects">2.8 Other types of objects</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      
</td></tr>
</table>

<hr size="6">
<a name="Vectors-and-assignment"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Vector-arithmetic" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Objects" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Vectors-and-assignment-1"></a>
<h2 class="section">2.1 Vectors and assignment</h2>

<p>R operates on named <em>data structures</em>.  The simplest such
structure is the numeric <em>vector</em>, which is a single entity
consisting of an ordered collection of numbers.  To set up a vector
named <code>x</code>, say, consisting of five numbers, namely 10.4, 5.6, 3.1,
6.4 and 21.7, use the R command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; x &lt;- c(10.4, 5.6, 3.1, 6.4, 21.7)
</pre></td></tr></table>
<a name="index-c"></a>
<a name="index-vector"></a>

<p>This is an <em>assignment</em> statement using the <em>function</em>
<code>c()</code> which in this context can take an arbitrary number of vector
<em>arguments</em> and whose value is a vector got by concatenating its
arguments end to end.<a name="DOCF6" href="#FOOT6">(6)</a>
</p>
<p>A number occurring by itself in an expression is taken as a vector of
length one.
</p>
<p>Notice that the assignment operator (&lsquo;<samp><code>&lt;-</code></samp>&rsquo;), which consists
of the two characters &lsquo;<samp><code>&lt;</code></samp>&rsquo; (&ldquo;less than&rdquo;) and
&lsquo;<samp><code>-</code></samp>&rsquo; (&ldquo;minus&rdquo;) occurring strictly side-by-side and it
&lsquo;points&rsquo; to the object receiving the value of the expression.
In most contexts the &lsquo;<samp><code>=</code></samp>&rsquo; operator can be used as an alternative.
<a name="index-Assignment"></a>
</p>
<p>Assignment can also be made using the function <code>assign()</code>.  An
equivalent way of making the same assignment as above is with:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; assign(&quot;x&quot;, c(10.4, 5.6, 3.1, 6.4, 21.7))
</pre></td></tr></table>

<p>The usual operator, <code>&lt;-</code>, can be thought of as a syntactic
short-cut to this.
</p>
<p>Assignments can also be made in the other direction, using the obvious
change in the assignment operator.  So the same assignment could be made
using
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; c(10.4, 5.6, 3.1, 6.4, 21.7) -&gt; x
</pre></td></tr></table>

<p>If an expression is used as a complete command, the value is printed
<em>and lost</em><a name="DOCF7" href="#FOOT7">(7)</a>.  So now if we
were to use the command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; 1/x
</pre></td></tr></table>

<p>the reciprocals of the five values would be printed at the terminal (and
the value of <code>x</code>, of course, unchanged).
</p>
<p>The further assignment
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; y &lt;- c(x, 0, x)
</pre></td></tr></table>

<p>would create a vector <code>y</code> with 11 entries consisting of two copies
of <code>x</code> with a zero in the middle place.
</p>
<hr size="6">
<a name="Vector-arithmetic"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Vectors-and-assignment" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Generating-regular-sequences" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Objects" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Vector-arithmetic-1"></a>
<h2 class="section">2.2 Vector arithmetic</h2>

<p>Vectors can be used in arithmetic expressions, in which case the
operations are performed element by element.  Vectors occurring in the
same expression need not all be of the same length.  If they are not,
the value of the expression is a vector with the same length as the
longest vector which occurs in the expression.  Shorter vectors in the
expression are <em>recycled</em> as often as need be (perhaps
fractionally) until they match the length of the longest vector.  In
particular a constant is simply repeated.  So with the above assignments
the command
<a name="index-Recycling-rule"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; v &lt;- 2*x + y + 1
</pre></td></tr></table>

<p>generates a new vector <code>v</code> of length 11 constructed by adding
together, element by element, <code>2*x</code> repeated 2.2 times, <code>y</code>
repeated just once, and <code>1</code> repeated 11 times.
</p>
<a name="index-Arithmetic-functions-and-operators"></a>
<p>The elementary arithmetic operators are the usual <code>+</code>, <code>-</code>,
<code>*</code>, <code>/</code> and <code>^</code> for raising to a power.
<a name="index-_002b"></a>
<a name="index-_002d"></a>
<a name="index-_002a"></a>
<a name="index-_002f"></a>
<a name="index-_005e"></a>
In addition all of the common arithmetic functions are available.
<code>log</code>, <code>exp</code>, <code>sin</code>, <code>cos</code>, <code>tan</code>, <code>sqrt</code>,
and so on, all have their usual meaning.
<a name="index-log"></a>
<a name="index-exp"></a>
<a name="index-sin"></a>
<a name="index-cos"></a>
<a name="index-tan"></a>
<a name="index-sqrt"></a>
<code>max</code> and <code>min</code> select the largest and smallest elements of a
vector respectively.
<a name="index-max"></a>
<a name="index-min"></a>
<code>range</code> is a function whose value is a vector of length two, namely
<code>c(min(x), max(x))</code>.
<a name="index-range"></a>
<code>length(x)</code> is the number of elements in <code>x</code>,
<a name="index-length"></a>
<code>sum(x)</code> gives the total of the elements in <code>x</code>,
<a name="index-sum"></a>
and <code>prod(x)</code> their product.
<a name="index-prod"></a>
</p>
<p>Two statistical functions are <code>mean(x)</code> which calculates the sample
mean, which is the same as <code>sum(x)/length(x)</code>,
<a name="index-mean"></a>
and <code>var(x)</code> which gives
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">sum((x-mean(x))^2)/(length(x)-1)
</pre></td></tr></table>
<a name="index-var"></a>

<p>or sample variance.  If the argument to <code>var()</code> is an
<em>n</em>-by-<em>p</em> matrix the value is a <em>p</em>-by-<em>p</em> sample
covariance matrix got by regarding the rows as independent
<em>p</em>-variate sample vectors.
</p>
<p><code>sort(x)</code> returns a vector of the same size as <code>x</code> with the
elements arranged in increasing order; however there are other more
flexible sorting facilities available (see <code>order()</code> or
<code>sort.list()</code> which produce a permutation to do the sorting).
<a name="index-sort"></a>
<a name="index-order"></a>
</p>
<p>Note that <code>max</code> and <code>min</code> select the largest and smallest
values in their arguments, even if they are given several vectors.  The
<em>parallel</em> maximum and minimum functions <code>pmax</code> and
<code>pmin</code> return a vector (of length equal to their longest argument)
that contains in each element the largest (smallest) element in that
position in any of the input vectors.
<a name="index-pmax"></a>
<a name="index-pmin"></a>
</p>
<p>For most purposes the user will not be concerned if the &ldquo;numbers&rdquo; in a
numeric vector are integers, reals or even complex.  Internally
calculations are done as double precision real numbers, or double
precision complex numbers if the input data are complex.
</p>
<p>To work with complex numbers, supply an explicit complex part.  Thus
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">sqrt(-17)
</pre></td></tr></table>

<p>will give <code>NaN</code> and a warning, but
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">sqrt(-17+0i)
</pre></td></tr></table>

<p>will do the computations as complex numbers.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Generating-regular-sequences">2.3 Generating regular sequences</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Generating-regular-sequences"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Vector-arithmetic" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Logical-vectors" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Objects" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Generating-regular-sequences-1"></a>
<h2 class="section">2.3 Generating regular sequences</h2>
<a name="index-Regular-sequences"></a>

<p>R has a number of facilities for generating commonly used sequences
of numbers.  For example <code>1:30</code> is the vector <code>c(1, 2,
&hellip;, 29, 30)</code>.
<a name="index-_003a"></a>
The colon operator has high priority within an expression, so, for
example <code>2*1:15</code> is the vector <code>c(2, 4, &hellip;, 28, 30)</code>.
Put <code>n &lt;- 10</code> and compare the sequences <code>1:n-1</code> and
<code>1:(n-1)</code>.
</p>
<p>The construction <code>30:1</code> may be used to generate a sequence
backwards.
</p>
<a name="index-seq"></a>
<p>The function <code>seq()</code> is a more general facility for generating
sequences.  It has five arguments, only some of which may be specified
in any one call.  The first two arguments, if given, specify the
beginning and end of the sequence, and if these are the only two
arguments given the result is the same as the colon operator.  That is
<code>seq(2,10)</code> is the same vector as <code>2:10</code>.
</p>
<p>Parameters to <code>seq()</code>, and to many other R functions, can also
be given in named form, in which case the order in which they appear is
irrelevant.  The first two parameters may be named
<code>from=<var>value</var></code> and <code>to=<var>value</var></code>; thus
<code>seq(1,30)</code>, <code>seq(from=1, to=30)</code> and <code>seq(to=30,
from=1)</code> are all the same as <code>1:30</code>.  The next two parameters to
<code>seq()</code> may be named <code>by=<var>value</var></code> and
<code>length=<var>value</var></code>, which specify a step size and a length for
the sequence respectively.  If neither of these is given, the default
<code>by=1</code> is assumed.
</p>
<p>For example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; seq(-5, 5, by=.2) -&gt; s3
</pre></td></tr></table>

<p>generates in <code>s3</code> the vector <code>c(-5.0, -4.8, -4.6, &hellip;,
4.6, 4.8, 5.0)</code>.  Similarly
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; s4 &lt;- seq(length=51, from=-5, by=.2)
</pre></td></tr></table>

<p>generates the same vector in <code>s4</code>.
</p>
<p>The fifth parameter may be named <code>along=<var>vector</var></code>, which if
used must be the only parameter, and creates a sequence <code>1, 2,
&hellip;, length(<var>vector</var>)</code>, or the empty sequence if the vector is
empty (as it can be).
</p>
<p>A related function is <code>rep()</code>
<a name="index-rep"></a>
which can be used for replicating an object in various complicated ways.
The simplest form is
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; s5 &lt;- rep(x, times=5)
</pre></td></tr></table>

<p>which will put five copies of <code>x</code> end-to-end in <code>s5</code>.  Another
useful version is
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; s6 &lt;- rep(x, each=5)
</pre></td></tr></table>

<p>which repeats each element of <code>x</code> five times before moving on to
the next.
</p>
<hr size="6">
<a name="Logical-vectors"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Generating-regular-sequences" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Missing-values" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Objects" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Logical-vectors-1"></a>
<h2 class="section">2.4 Logical vectors</h2>

<p>As well as numerical vectors, R allows manipulation of logical
quantities.  The elements of a logical vector can have the values
<code>TRUE</code>, <code>FALSE</code>, and <code>NA</code> (for &ldquo;not available&rdquo;, see
below).  The first two are often abbreviated as <code>T</code> and <code>F</code>,
respectively.  Note however that <code>T</code> and <code>F</code> are just
variables which are set to <code>TRUE</code> and <code>FALSE</code> by default, but
are not reserved words and hence can be overwritten by the user.  Hence,
you should always use <code>TRUE</code> and <code>FALSE</code>.
<a name="index-FALSE"></a>
<a name="index-TRUE"></a>
<a name="index-F"></a>
<a name="index-T"></a>
</p>
<p>Logical vectors are generated by <em>conditions</em>.  For example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; temp &lt;- x &gt; 13
</pre></td></tr></table>

<p>sets <code>temp</code> as a vector of the same length as <code>x</code> with values
<code>FALSE</code> corresponding to elements of <code>x</code> where the condition
is <em>not</em> met and <code>TRUE</code> where it is.
</p>
<p>The logical operators are <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>,
<code>==</code> for exact equality and <code>!=</code> for inequality.
<a name="index-_003c"></a>
<a name="index-_003c_003d"></a>
<a name="index-_003e"></a>
<a name="index-_003e_003d"></a>
<a name="index-_003d_003d"></a>
<a name="index-_0021_003d"></a>
In addition if <code>c1</code> and <code>c2</code> are logical expressions, then
<code>c1 &amp; c2</code> is their intersection (<em>&ldquo;and&rdquo;</em>), <code>c1 | c2</code>
is their union (<em>&ldquo;or&rdquo;</em>), and <code>!c1</code> is the negation of
<code>c1</code>.
<a name="index-_0021"></a>
<a name="index-_007c"></a>
<a name="index-_0026"></a>
</p>
<p>Logical vectors may be used in ordinary arithmetic, in which case they
are <em>coerced</em> into numeric vectors, <code>FALSE</code> becoming <code>0</code>
and <code>TRUE</code> becoming <code>1</code>.  However there are situations where
logical vectors and their coerced numeric counterparts are not
equivalent, for example see the next subsection.
</p>
<hr size="6">
<a name="Missing-values"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Logical-vectors" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Character-vectors" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Objects" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Missing-values-1"></a>
<h2 class="section">2.5 Missing values</h2>
<a name="index-Missing-values"></a>

<p>In some cases the components of a vector may not be completely
known.  When an element or value is &ldquo;not available&rdquo; or a &ldquo;missing
value&rdquo; in the statistical sense, a place within a vector may be
reserved for it by assigning it the special value <code>NA</code>.
<a name="index-NA"></a>
In general any operation on an <code>NA</code> becomes an <code>NA</code>.  The
motivation for this rule is simply that if the specification of an
operation is incomplete, the result cannot be known and hence is not
available.
</p>
<a name="index-is_002ena"></a>
<p>The function <code>is.na(x)</code> gives a logical vector of the same size as
<code>x</code> with value <code>TRUE</code> if and only if the corresponding element
in <code>x</code> is <code>NA</code>.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; z &lt;- c(1:3,NA);  ind &lt;- is.na(z)
</pre></td></tr></table>

<p>Notice that the logical expression <code>x == NA</code> is quite different
from <code>is.na(x)</code> since <code>NA</code> is not really a value but a marker
for a quantity that is not available.  Thus <code>x == NA</code> is a vector
of the same length as <code>x</code> <em>all</em> of whose values are <code>NA</code>
as the logical expression itself is incomplete and hence undecidable.
</p>
<p>Note that there is a second kind of &ldquo;missing&rdquo; values which are
produced by numerical computation, the so-called <em>Not a Number</em>,
<code>NaN</code>,
<a name="index-NaN"></a>
values.  Examples are
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; 0/0
</pre></td></tr></table>

<p>or
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; Inf - Inf
</pre></td></tr></table>

<p>which both give <code>NaN</code> since the result cannot be defined sensibly.
</p>
<p>In summary, <code>is.na(xx)</code> is <code>TRUE</code> <em>both</em> for <code>NA</code>
and <code>NaN</code> values.  To differentiate these, <code>is.nan(xx)</code> is only
<code>TRUE</code> for <code>NaN</code>s.
<a name="index-is_002enan"></a>
</p>
<p>Missing values are sometimes printed as <code>&lt;NA&gt;</code> when character
vectors are printed without quotes.
</p>
<hr size="6">
<a name="Character-vectors"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Missing-values" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index-vectors" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Objects" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Character-vectors-1"></a>
<h2 class="section">2.6 Character vectors</h2>
<a name="index-Character-vectors"></a>

<p>Character quantities and character vectors are used frequently in R,
for example as plot labels.  Where needed they are denoted by a sequence
of characters delimited by the double quote character, e.g.,
<code>&quot;x-values&quot;</code>, <code>&quot;New iteration results&quot;</code>.
</p>
<p>Character strings are entered using either matching double (<code>&quot;</code>) or
single (<code>'</code>) quotes, but are printed using double quotes (or
sometimes without quotes).  They use C-style escape sequences, using
<code>\</code> as the escape character, so <code>\\</code> is entered and printed as
<code>\\</code>, and inside double quotes <code>&quot;</code> is entered as <code>\&quot;</code>.
Other useful escape sequences are <code>\n</code>, newline, <code>\t</code>, tab and
<code>\b</code>, backspace&mdash;see <code>?Quotes</code> for a full list.
</p>
<p>Character vectors may be concatenated into a vector by the <code>c()</code>
function; examples of their use will emerge frequently.
<a name="index-c-1"></a>
</p>
<a name="index-paste"></a>
<p>The <code>paste()</code> function takes an arbitrary number of arguments and
concatenates them one by one into character strings.  Any numbers given
among the arguments are coerced into character strings in the evident
way, that is, in the same way they would be if they were printed.  The
arguments are by default separated in the result by a single blank
character, but this can be changed by the named parameter,
<code>sep=<var>string</var></code>, which changes it to <code><var>string</var></code>,
possibly empty.
</p>
<p>For example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; labs &lt;- paste(c(&quot;X&quot;,&quot;Y&quot;), 1:10, sep=&quot;&quot;)
</pre></td></tr></table>

<p>makes <code>labs</code> into the character vector
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">c(&quot;X1&quot;, &quot;Y2&quot;, &quot;X3&quot;, &quot;Y4&quot;, &quot;X5&quot;, &quot;Y6&quot;, &quot;X7&quot;, &quot;Y8&quot;, &quot;X9&quot;, &quot;Y10&quot;)
</pre></td></tr></table>

<p>Note particularly that recycling of short lists takes place here too;
thus <code>c(&quot;X&quot;, &quot;Y&quot;)</code> is repeated 5 times to match the sequence
<code>1:10</code>.
<a name="DOCF8" href="#FOOT8">(8)</a>
</p>
<hr size="6">
<a name="Index-vectors"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Character-vectors" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Other-types-of-objects" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Objects" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Index-vectors_003b-selecting-and-modifying-subsets-of-a-data-set"></a>
<h2 class="section">2.7 Index vectors; selecting and modifying subsets of a data set</h2>
<a name="index-Indexing-vectors"></a>

<p>Subsets of the elements of a vector may be selected by appending to the
name of the vector an <em>index vector</em> in square brackets.  More
generally any expression that evaluates to a vector may have subsets of
its elements similarly selected by appending an index vector in square
brackets immediately after the expression.
</p>

<p>Such index vectors can be any of four distinct types.
</p>
<ol>
<li>
<strong>A logical vector</strong>.  In this case the index vector must be of the
same length as the vector from which elements are to be selected.
Values corresponding to <code>TRUE</code> in the index vector are selected and
those corresponding to <code>FALSE</code> are omitted.  For example

<table><tr><td>&nbsp;</td><td><pre class="example">&gt; y &lt;- x[!is.na(x)]
</pre></td></tr></table>

<p>creates (or re-creates) an object <code>y</code> which will contain the
non-missing values of <code>x</code>, in the same order.  Note that if
<code>x</code> has missing values, <code>y</code> will be shorter than <code>x</code>.
Also
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; (x+1)[(!is.na(x)) &amp; x&gt;0] -&gt; z
</pre></td></tr></table>

<p>creates an object <code>z</code> and places in it the values of the vector
<code>x+1</code> for which the corresponding value in <code>x</code> was both
non-missing and positive.
</p>
</li><li>
<strong>A vector of positive integral quantities</strong>.  In this case the
values in the index vector must lie in the set {1, 2, &hellip;,
<code>length(x)</code>}.  The corresponding elements of the vector are
selected and concatenated, <em>in that order</em>, in the result.  The
index vector can be of any length and the result is of the same length
as the index vector.  For example <code>x[6]</code> is the sixth component of
<code>x</code> and

<table><tr><td>&nbsp;</td><td><pre class="example">&gt; x[1:10]
</pre></td></tr></table>

<p>selects the first 10 elements of <code>x</code> (assuming <code>length(x)</code> is
not less than 10).  Also
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; c(&quot;x&quot;,&quot;y&quot;)[rep(c(1,2,2,1), times=4)]
</pre></td></tr></table>

<p>(an admittedly unlikely thing to do) produces a character vector of
length 16 consisting of <code>&quot;x&quot;, &quot;y&quot;, &quot;y&quot;, &quot;x&quot;</code> repeated four times.
</p>
</li><li>
<strong>A vector of negative integral quantities</strong>.  Such an index vector
specifies the values to be <em>excluded</em> rather than included.  Thus

<table><tr><td>&nbsp;</td><td><pre class="example">&gt; y &lt;- x[-(1:5)]
</pre></td></tr></table>

<p>gives <code>y</code> all but the first five elements of <code>x</code>.
</p>
</li><li>
<strong>A vector of character strings</strong>.  This possibility only applies
where an object has a <code>names</code> attribute to identify its components.
In this case a sub-vector of the names vector may be used in the same way
as the positive integral labels in item 2 further above.

<table><tr><td>&nbsp;</td><td><pre class="example">&gt; fruit &lt;- c(5, 10, 1, 20)
&gt; names(fruit) &lt;- c(&quot;orange&quot;, &quot;banana&quot;, &quot;apple&quot;, &quot;peach&quot;)
&gt; lunch &lt;- fruit[c(&quot;apple&quot;,&quot;orange&quot;)]
</pre></td></tr></table>

<p>The advantage is that alphanumeric <em>names</em> are often easier to
remember than <em>numeric indices</em>.  This option is particularly
useful in connection with data frames, as we shall see later.
</p>
</li></ol>

<p>An indexed expression can also appear on the receiving end of an
assignment, in which case the assignment operation is performed
<em>only on those elements of the vector</em>.  The expression must be of
the form <code>vector[<var>index_vector</var>]</code> as having an arbitrary
expression in place of the vector name does not make much sense here.
</p>
<p>For example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; x[is.na(x)] &lt;- 0
</pre></td></tr></table>

<p>replaces any missing values in <code>x</code> by zeros and
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; y[y &lt; 0] &lt;- -y[y &lt; 0]
</pre></td></tr></table>

<p>has the same effect as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; y &lt;- abs(y)
</pre></td></tr></table>

<hr size="6">
<a name="Other-types-of-objects"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Index-vectors" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Objects" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Objects" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Other-types-of-objects-1"></a>
<h2 class="section">2.8 Other types of objects</h2>

<p>Vectors are the most important type of object in R, but there are
several others which we will meet more formally in later sections.
</p>
<ul>
<li>
<em>matrices</em> or more generally <em>arrays</em> are multi-dimensional
generalizations of vectors.  In fact, they <em>are</em> vectors that can
be indexed by two or more indices and will be printed in special ways.
See section <a href="#Arrays-and-matrices">Arrays and matrices</a>.

</li><li>
<em>factors</em> provide compact ways to handle categorical data.
See section <a href="#Factors">Ordered and unordered factors</a>.

</li><li>
<em>lists</em> are a general form of vector in which the various elements
need not be of the same type, and are often themselves vectors or lists.
Lists provide a convenient way to return the results of a statistical
computation.  See section <a href="#Lists">Lists</a>.

</li><li>
<em>data frames</em> are matrix-like structures, in which the columns can
be of different types.  Think of data frames as &lsquo;data matrices&rsquo; with one
row per observational unit but with (possibly) both numerical and
categorical variables.  Many experiments are best described by data
frames: the treatments are categorical but the response is numeric.
See section <a href="#Data-frames">Data frames</a>.

</li><li>
<em>functions</em> are themselves objects in R which can be stored in
the project&rsquo;s workspace.  This provides a simple and convenient way to
extend R.  See section <a href="#Writing-your-own-functions">Writing your own functions</a>.

</li></ul>

<hr size="6">
<a name="Objects"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Other-types-of-objects" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-intrinsic-attributes-mode-and-length" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Simple-manipulations-numbers-and-vectors" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Factors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Objects_002c-their-modes-and-attributes"></a>
<h1 class="chapter">3. Objects, their modes and attributes</h1>
<a name="index-Objects"></a>
<a name="index-Attributes"></a>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#The-intrinsic-attributes-mode-and-length">3.1 Intrinsic attributes: mode and length</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Changing-the-length-of-an-object">3.2 Changing the length of an object</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Getting-and-setting-attributes">3.3 Getting and setting attributes</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#The-class-of-an-object">3.4 The class of an object</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      
</td></tr>
</table>

<hr size="6">
<a name="The-intrinsic-attributes-mode-and-length"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Objects" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Changing-the-length-of-an-object" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Objects" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Objects" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Factors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Intrinsic-attributes_003a-mode-and-length"></a>
<h2 class="section">3.1 Intrinsic attributes: mode and length</h2>

<p>The entities R operates on are technically known as <em>objects</em>.
Examples are vectors of numeric (real) or complex values, vectors of
logical values and vectors of character strings.  These are known as
&ldquo;atomic&rdquo; structures since their components are all of the same type,
or <em>mode</em>, namely <em>numeric</em><a name="DOCF9" href="#FOOT9">(9)</a>, <em>complex</em>,
<em>logical</em>, <em>character</em> and <em>raw</em>.
</p>
<p>Vectors must have their values <em>all of the same mode</em>.  Thus any
given vector must be unambiguously either <em>logical</em>,
<em>numeric</em>, <em>complex</em>, <em>character</em> or <em>raw</em>.  (The
only apparent exception to this rule is the special &ldquo;value&rdquo; listed as
<code>NA</code> for quantities not available, but in fact there are several
types of <code>NA</code>).  Note that a vector can be empty and still have a
mode.  For example the empty character string vector is listed as
<code>character(0)</code> and the empty numeric vector as <code>numeric(0)</code>.
</p>
<p>R also operates on objects called <em>lists</em>, which are of mode
<em>list</em>.  These are ordered sequences of objects which individually
can be of any mode.  <em>lists</em> are known as &ldquo;recursive&rdquo; rather than
atomic structures since their components can themselves be lists in
their own right.
</p>
<p>The other recursive structures are those of mode <em>function</em> and
<em>expression</em>.  Functions are the objects that form part of the R
system along with similar user written functions, which we discuss in
some detail later.  Expressions as objects form an
advanced part of R which will not be discussed in this guide, except
indirectly when we discuss <em>formulae</em> used with modeling in R.
</p>
<p>By the <em>mode</em> of an object we mean the basic type of its
fundamental constituents.  This is a special case of a &ldquo;property&rdquo;
of an object.  Another property of every object is its <em>length</em>.  The
functions <code>mode(<var>object</var>)</code> and <code>length(<var>object</var>)</code> can be
used to find out the mode and length of any defined structure
<a name="DOCF10" href="#FOOT10">(10)</a>.
</p>
<p>Further properties of an object are usually provided by
<code>attributes(<var>object</var>)</code>, see <a href="#Getting-and-setting-attributes">Getting and setting attributes</a>.
Because of this, <em>mode</em> and <em>length</em> are also called &ldquo;intrinsic
attributes&rdquo; of an object.
<a name="index-mode"></a>
<a name="index-length-1"></a>
</p>
<p>For example, if <code>z</code> is a complex vector of length 100, then in an
expression <code>mode(z)</code> is the character string <code>&quot;complex&quot;</code> and
<code>length(z)</code> is <code>100</code>.
</p>
<p>R caters for changes of mode almost anywhere it could be considered
sensible to do so, (and a few where it might not be).  For example with
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; z &lt;- 0:9
</pre></td></tr></table>

<p>we could put
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; digits &lt;- as.character(z)
</pre></td></tr></table>

<p>after which <code>digits</code> is the character vector <code>c(&quot;0&quot;, &quot;1&quot;, &quot;2&quot;,
&hellip;, &quot;9&quot;)</code>.  A further <em>coercion</em>, or change of mode,
reconstructs the numerical vector again:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; d &lt;- as.integer(digits)
</pre></td></tr></table>

<p>Now <code>d</code> and <code>z</code> are the same.<a name="DOCF11" href="#FOOT11">(11)</a>  There is a
large collection of functions of the form <code>as.<var>something</var>()</code>
for either coercion from one mode to another, or for investing an object
with some other attribute it may not already possess.  The reader should
consult the different help files to become familiar with them.
</p>

<hr size="6">
<a name="Changing-the-length-of-an-object"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-intrinsic-attributes-mode-and-length" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Getting-and-setting-attributes" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Objects" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Objects" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Factors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Changing-the-length-of-an-object-1"></a>
<h2 class="section">3.2 Changing the length of an object</h2>

<p>An &ldquo;empty&rdquo; object may still have a mode.  For example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; e &lt;- numeric()
</pre></td></tr></table>

<p>makes <code>e</code> an empty vector structure of mode numeric.  Similarly
<code>character()</code> is a empty character vector, and so on.  Once an
object of any size has been created, new components may be added to it
simply by giving it an index value outside its previous range.  Thus
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; e[3] &lt;- 17
</pre></td></tr></table>

<p>now makes <code>e</code> a vector of length 3, (the first two components of
which are at this point both <code>NA</code>).  This applies to any structure
at all, provided the mode of the additional component(s) agrees with the
mode of the object in the first place.
</p>
<p>This automatic adjustment of lengths of an object is used often, for
example in the <code>scan()</code> function for input.  (see section <a href="#The-scan_0028_0029-function">The <code>scan()</code> function</a>.)
</p>
<p>Conversely to truncate the size of an object requires only an assignment
to do so.  Hence if <code>alpha</code> is an object of length 10, then
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; alpha &lt;- alpha[2 * 1:5]
</pre></td></tr></table>

<p>makes it an object of length 5 consisting of just the former components
with even index.  (The old indices are not retained, of course.)  We can
then retain just the first three values by
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; length(alpha) &lt;- 3
</pre></td></tr></table>

<p>and vectors can be extended (by missing values) in the same way.
</p>
<hr size="6">
<a name="Getting-and-setting-attributes"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Changing-the-length-of-an-object" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-class-of-an-object" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Objects" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Objects" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Factors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Getting-and-setting-attributes-1"></a>
<h2 class="section">3.3 Getting and setting attributes</h2>
<a name="index-attr"></a>
<a name="index-attributes"></a>

<p>The function <code>attributes(<var>object</var>)</code>
<a name="index-attributes-1"></a>
returns a list of all the non-intrinsic attributes currently defined for
that object.  The function <code>attr(<var>object</var>, <var>name</var>)</code>
<a name="index-attr-1"></a>
can be used to select a specific attribute.  These functions are rarely
used, except in rather special circumstances when some new attribute is
being created for some particular purpose, for example to associate a
creation date or an operator with an R object.  The concept, however,
is very important.
</p>
<p>Some care should be exercised when assigning or deleting attributes
since they are an integral part of the object system used in R.
</p>
<p>When it is used on the left hand side of an assignment it can be used
either to associate a new attribute with <code><var>object</var></code> or to
change an existing one.  For example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; attr(z, &quot;dim&quot;) &lt;- c(10,10)
</pre></td></tr></table>

<p>allows R to treat <code>z</code> as if it were a 10-by-10 matrix.
</p>
<hr size="6">
<a name="The-class-of-an-object"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Getting-and-setting-attributes" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Factors" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Objects" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Objects" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Factors" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-class-of-an-object-1"></a>
<h2 class="section">3.4 The class of an object</h2>
<a name="index-Classes"></a>

<p>All objects in R have a <em>class</em>, reported by the function
<code>class</code>.  For simple vectors this is just the mode, for example
<code>&quot;numeric&quot;</code>, <code>&quot;logical&quot;</code>, <code>&quot;character&quot;</code> or <code>&quot;list&quot;</code>,
but <code>&quot;matrix&quot;</code>, <code>&quot;array&quot;</code>, <code>&quot;factor&quot;</code> and
<code>&quot;data.frame&quot;</code> are other possible values.
</p>
<p>A special attribute known as the <em>class</em> of the object is used to
allow for an object-oriented style<a name="DOCF12" href="#FOOT12">(12)</a> of
programming in R.  For example if an object has class
<code>&quot;data.frame&quot;</code>, it will be printed in a certain way, the
<code>plot()</code> function will display it graphically in a certain way, and
other so-called generic functions such as <code>summary()</code> will react to
it as an argument in a way sensitive to its class.
</p>
<p>To remove temporarily the effects of class, use the function
<code>unclass()</code>.
<a name="index-unclass"></a>
For example if <code>winter</code> has the class <code>&quot;data.frame&quot;</code> then
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; winter
</pre></td></tr></table>

<p>will print it in data frame form, which is rather like a matrix, whereas
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; unclass(winter)
</pre></td></tr></table>

<p>will print it as an ordinary list.  Only in rather special situations do
you need to use this facility, but one is when you are learning to come
to terms with the idea of class and generic functions.
</p>
<p>Generic functions and classes will be discussed further in <a href="#Object-orientation">Classes, generic functions and object orientation</a>, but only briefly.
</p>
<hr size="6">
<a name="Factors"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-class-of-an-object" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#A-specific-example" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Objects" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ordered-and-unordered-factors"></a>
<h1 class="chapter">4. Ordered and unordered factors</h1>
<a name="index-Factors"></a>
<a name="index-Ordered-factors"></a>

<p>A <em>factor</em> is a vector object used to specify a discrete
classification (grouping) of the components of other vectors of the same length.
R provides both <em>ordered</em> and <em>unordered</em> factors.
While the &ldquo;real&rdquo; application of factors is with model formulae
(see section <a href="#Contrasts">Contrasts</a>), we here look at a specific example.
</p>
<hr size="6">
<a name="A-specific-example"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Factors" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-function-tapply_0028_0029-and-ragged-arrays" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Factors" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Factors" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">4.1 A specific example</h2>

<p>Suppose, for example, we have a sample of 30 tax accountants from all
the states and territories of Australia<a name="DOCF13" href="#FOOT13">(13)</a>
and their individual state of origin is specified by a character vector
of state mnemonics as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; state &lt;- c(&quot;tas&quot;, &quot;sa&quot;,  &quot;qld&quot;, &quot;nsw&quot;, &quot;nsw&quot;, &quot;nt&quot;,  &quot;wa&quot;,  &quot;wa&quot;,
             &quot;qld&quot;, &quot;vic&quot;, &quot;nsw&quot;, &quot;vic&quot;, &quot;qld&quot;, &quot;qld&quot;, &quot;sa&quot;,  &quot;tas&quot;,
             &quot;sa&quot;,  &quot;nt&quot;,  &quot;wa&quot;,  &quot;vic&quot;, &quot;qld&quot;, &quot;nsw&quot;, &quot;nsw&quot;, &quot;wa&quot;,
             &quot;sa&quot;,  &quot;act&quot;, &quot;nsw&quot;, &quot;vic&quot;, &quot;vic&quot;, &quot;act&quot;)
</pre></td></tr></table>

<p>Notice that in the case of a character vector, &ldquo;sorted&rdquo; means sorted
in alphabetical order.
</p>
<p>A <em>factor</em> is similarly created using the <code>factor()</code> function:
<a name="index-factor"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; statef &lt;- factor(state)
</pre></td></tr></table>

<p>The <code>print()</code> function handles factors slightly differently from
other objects:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; statef
 [1] tas sa  qld nsw nsw nt  wa  wa  qld vic nsw vic qld qld sa
[16] tas sa  nt  wa  vic qld nsw nsw wa  sa  act nsw vic vic act
Levels:  act nsw nt qld sa tas vic wa
</pre></td></tr></table>

<p>To find out the levels of a factor the function <code>levels()</code> can be
used.
<a name="index-levels"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; levels(statef)
[1] &quot;act&quot; &quot;nsw&quot; &quot;nt&quot;  &quot;qld&quot; &quot;sa&quot;  &quot;tas&quot; &quot;vic&quot; &quot;wa&quot;
</pre></td></tr></table>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#The-function-tapply_0028_0029-and-ragged-arrays">4.2 The function <code>tapply()</code> and ragged arrays</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Ordered-factors">4.3 Ordered factors</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             
</td></tr>
</table>

<hr size="6">
<a name="The-function-tapply_0028_0029-and-ragged-arrays"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#A-specific-example" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ordered-factors" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Factors" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Factors" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-function-tapply_0028_0029-and-ragged-arrays-1"></a>
<h2 class="section">4.2 The function <code>tapply()</code> and ragged arrays</h2>
<a name="index-tapply"></a>

<p>To continue the previous example, suppose we have the incomes of the
same tax accountants in another vector (in suitably large units of
money)
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; incomes &lt;- c(60, 49, 40, 61, 64, 60, 59, 54, 62, 69, 70, 42, 56,
               61, 61, 61, 58, 51, 48, 65, 49, 49, 41, 48, 52, 46,
               59, 46, 58, 43)
</pre></td></tr></table>

<p>To calculate the sample mean income for each state we can now use the
special function <code>tapply()</code>:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; incmeans &lt;- tapply(incomes, statef, mean)
</pre></td></tr></table>

<p>giving a means vector with the components labelled by the levels
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">   act    nsw     nt    qld     sa    tas    vic     wa
44.500 57.333 55.500 53.600 55.000 60.500 56.000 52.250
</pre></td></tr></table>

<p>The function <code>tapply()</code> is used to apply a function, here
<code>mean()</code>, to each group of components of the first argument, here
<code>incomes</code>, defined by the levels of the second component, here
<code>statef</code><a name="DOCF14" href="#FOOT14">(14)</a>, as if they were separate vector
structures.  The result is a structure of the same length as the levels
attribute of the factor containing the results.  The reader should
consult the help document for more details.
</p>
<p>Suppose further we needed to calculate the standard errors of the state
income means.  To do this we need to write an R function to calculate
the standard error for any given vector.  Since there is an builtin
function <code>var()</code> to calculate the sample variance, such a function
is a very simple one liner, specified by the assignment:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; stderr &lt;- function(x) sqrt(var(x)/length(x))
</pre></td></tr></table>

<p>(Writing functions will be considered later in <a href="#Writing-your-own-functions">Writing your own functions</a>, and in this case was unnecessary as R also has a builtin
function <code>sd()</code>.)
<a name="index-sd"></a>
<a name="index-var-1"></a>
After this assignment, the standard errors are calculated by
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; incster &lt;- tapply(incomes, statef, stderr)
</pre></td></tr></table>

<p>and the values calculated are then
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; incster
act    nsw  nt    qld     sa tas   vic     wa
1.5 4.3102 4.5 4.1061 2.7386 0.5 5.244 2.6575
</pre></td></tr></table>

<p>As an exercise you may care to find the usual 95% confidence limits for
the state mean incomes.  To do this you could use <code>tapply()</code> once
more with the <code>length()</code> function to find the sample sizes, and the
<code>qt()</code> function to find the percentage points of the appropriate
<em>t</em>-distributions.  (You could also investigate R&rsquo;s facilities
for <em>t</em>-tests.)
</p>
<p>The function <code>tapply()</code> can also be used to handle more complicated
indexing of a vector by multiple categories.  For example, we might wish
to split the tax accountants by both state and sex.  However in this
simple instance (just one factor) what happens can be thought of as
follows.  The values in the vector are collected into groups
corresponding to the distinct entries in the factor.  The function is
then applied to each of these groups individually.  The value is a
vector of function results, labelled by the <code>levels</code> attribute of
the factor.
</p>
<p>The combination of a vector and a labelling factor is an example of what
is sometimes called a <em>ragged array</em>, since the subclass sizes are
possibly irregular.  When the subclass sizes are all the same the
indexing may be done implicitly and much more efficiently, as we see in
the next section.
</p>

<hr size="6">
<a name="Ordered-factors"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-function-tapply_0028_0029-and-ragged-arrays" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Factors" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Factors" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ordered-factors-1"></a>
<h2 class="section">4.3 Ordered factors</h2>
<a name="index-ordered"></a>

<p>The levels of factors are stored in alphabetical order, or in the order
they were specified to <code>factor</code> if they were specified explicitly.
</p>
<p>Sometimes the levels will have a natural ordering that we want to record
and want our statistical analysis to make use of.  The <code>ordered()</code>
<a name="index-ordered-1"></a>
function creates such ordered factors but is otherwise identical to
<code>factor</code>.  For most purposes the only difference between ordered
and unordered factors is that the former are printed showing the
ordering of the levels, but the contrasts generated for them in fitting
linear models are different.
</p>

<hr size="6">
<a name="Arrays-and-matrices"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Ordered-factors" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Factors" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Arrays-and-matrices-1"></a>
<h1 class="chapter">5. Arrays and matrices</h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Arrays">5.1 Arrays</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                      
</td></tr>
<tr><td align="left" valign="top"><a href="#Array-indexing">5.2 Array indexing. Subsections of an array</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              
</td></tr>
<tr><td align="left" valign="top"><a href="#Index-matrices">5.3 Index matrices</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              
</td></tr>
<tr><td align="left" valign="top"><a href="#The-array_0028_0029-function">5.4 The <code>array()</code> function</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        
</td></tr>
<tr><td align="left" valign="top"><a href="#The-outer-product-of-two-arrays">5.5 The outer product of two arrays</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Generalized-transpose-of-an-array">5.6 Generalized transpose of an array</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Matrix-facilities">5.7 Matrix facilities</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           
</td></tr>
<tr><td align="left" valign="top"><a href="#Forming-partitioned-matrices">5.8 Forming partitioned matrices, <code>cbind()</code> and <code>rbind()</code></a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#The-concatenation-function-c_0028_0029-with-arrays">5.9 The concatenation function, <code>c()</code>, with arrays</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Frequency-tables-from-factors">5.10 Frequency tables from factors</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
</table>

<hr size="6">
<a name="Arrays"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Array-indexing" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Arrays-1"></a>
<h2 class="section">5.1 Arrays</h2>
<a name="index-Arrays"></a>
<a name="index-Matrices"></a>

<p>An array can be considered as a multiply subscripted collection of data
entries, for example numeric.  R allows simple facilities for
creating and handling arrays, and in particular the special case of
matrices.
</p>
<p>A dimension vector is a vector of non-negative integers.  If its length is
<em>k</em> then the array is <em>k</em>-dimensional, e.g.&nbsp;a matrix is a
<em>2</em>-dimensional array.  The dimensions are indexed from one up to
the values given in the dimension vector.
</p>
<p>A vector can be used by R as an array only if it has a dimension
vector as its <em>dim</em> attribute.  Suppose, for example, <code>z</code> is a
vector of 1500 elements.  The assignment
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; dim(z) &lt;- c(3,5,100)
</pre></td></tr></table>
<a name="index-dim"></a>

<p>gives it the <em>dim</em> attribute that allows it to be treated as a
<em>3</em> by <em>5</em> by <em>100</em> array.
</p>
<p>Other functions such as <code>matrix()</code> and <code>array()</code> are available
for simpler and more natural looking assignments, as we shall see in
<a href="#The-array_0028_0029-function">The <code>array()</code> function</a>.
</p>
<p>The values in the data vector give the values in the array in the same
order as they would occur in FORTRAN, that is &ldquo;column major order,&rdquo;
with the first subscript moving fastest and the last subscript slowest.
</p>
<p>For example if the dimension vector for an array, say <code>a</code>, is
<code>c(3,4,2)</code> then there are 3 * 4 * 2
= 24 entries in <code>a</code> and the data vector holds them in the order
<code>a[1,1,1], a[2,1,1], &hellip;, a[2,4,2], a[3,4,2]</code>.
</p>
<p>Arrays can be one-dimensional: such arrays are usually treated in the
same way as vectors (including when printing), but the exceptions can
cause confusion.
</p>
<hr size="6">
<a name="Array-indexing"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Arrays" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index-matrices" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Array-indexing_002e-Subsections-of-an-array"></a>
<h2 class="section">5.2 Array indexing. Subsections of an array</h2>
<a name="index-Indexing-of-and-by-arrays"></a>

<p>Individual elements of an array may be referenced by giving the name of
the array followed by the subscripts in square brackets, separated by
commas.
</p>
<p>More generally, subsections of an array may be specified by giving a
sequence of <em>index vectors</em> in place of subscripts; however
<em>if any index position is given an empty index vector, then the
full range of that subscript is taken</em>.
</p>
<p>Continuing the previous example, <code>a[2,,]</code> is a 4 *
2 array with dimension vector <code>c(4,2)</code> and data vector containing
the values
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">c(a[2,1,1], a[2,2,1], a[2,3,1], a[2,4,1],
  a[2,1,2], a[2,2,2], a[2,3,2], a[2,4,2])
</pre></td></tr></table>

<p>in that order.  <code>a[,,]</code> stands for the entire array, which is the
same as omitting the subscripts entirely and using <code>a</code> alone.
</p>
<p>For any array, say <code>Z</code>, the dimension vector may be referenced
explicitly as <code>dim(Z)</code> (on either side of an assignment).
</p>
<p>Also, if an array name is given with just <em>one subscript or index
vector</em>, then the corresponding values of the data vector only are used;
in this case the dimension vector is ignored.  This is not the case,
however, if the single index is not a vector but itself an array, as we
next discuss.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Index-matrices">5.3 Index matrices</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#The-array_0028_0029-function">5.4 The <code>array()</code> function</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Index-matrices"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Array-indexing" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-array_0028_0029-function" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Index-matrices-1"></a>
<h2 class="section">5.3 Index matrices</h2>

<p>As well as an index vector in any subscript position, a matrix may be
used with a single <em>index matrix</em> in order either to assign a vector
of quantities to an irregular collection of elements in the array, or to
extract an irregular collection as a vector.
</p>
<p>A matrix example makes the process clear.  In the case of a doubly
indexed array, an index matrix may be given consisting of two columns
and as many rows as desired.  The entries in the index matrix are the
row and column indices for the doubly indexed array.  Suppose for
example we have a <em>4</em> by <em>5</em> array <code>X</code> and we wish to do
the following:
</p>
<ul>
<li>
Extract elements <code>X[1,3]</code>, <code>X[2,2]</code> and <code>X[3,1]</code> as a
vector structure, and
</li><li>
Replace these entries in the array <code>X</code> by zeroes.
</li></ul>
<p>In this case we need a <em>3</em> by <em>2</em> subscript array, as in the
following example.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; x &lt;- array(1:20, dim=c(4,5))   # <span class="roman">Generate a 4 by 5 array.</span>
&gt; x
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    5    9   13   17
[2,]    2    6   10   14   18
[3,]    3    7   11   15   19
[4,]    4    8   12   16   20
&gt; i &lt;- array(c(1:3,3:1), dim=c(3,2))
&gt; i                             # <span class="roman"><code>i</code> is a 3 by 2 index array.</span>
     [,1] [,2]
[1,]    1    3
[2,]    2    2
[3,]    3    1
&gt; x[i]                          # <span class="roman">Extract those elements</span>
[1] 9 6 3
&gt; x[i] &lt;- 0                     # <span class="roman">Replace those elements by zeros.</span>
&gt; x
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    5    0   13   17
[2,]    2    0   10   14   18
[3,]    0    7   11   15   19
[4,]    4    8   12   16   20
&gt;
</pre></td></tr></table>
<p>Negative indices are not allowed in index matrices.  <code>NA</code> and zero
values are allowed: rows in the index matrix containing a zero are
ignored, and rows containing an <code>NA</code> produce an <code>NA</code> in the
result.
</p>

<p>As a less trivial example, suppose we wish to generate an (unreduced)
design matrix for a block design defined by factors <code>blocks</code>
(<code>b</code> levels) and <code>varieties</code> (<code>v</code> levels).  Further
suppose there are <code>n</code> plots in the experiment.  We could proceed as
follows:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; Xb &lt;- matrix(0, n, b)
&gt; Xv &lt;- matrix(0, n, v)
&gt; ib &lt;- cbind(1:n, blocks)
&gt; iv &lt;- cbind(1:n, varieties)
&gt; Xb[ib] &lt;- 1
&gt; Xv[iv] &lt;- 1
&gt; X &lt;- cbind(Xb, Xv)
</pre></td></tr></table>

<p>To construct the incidence matrix, <code>N</code> say, we could use
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; N &lt;- crossprod(Xb, Xv)
</pre></td></tr></table>
<a name="index-crossprod"></a>

<p>However a simpler direct way of producing this matrix is to use
<code>table()</code>:
<a name="index-table"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; N &lt;- table(blocks, varieties)
</pre></td></tr></table>

<p>Index matrices must be numerical: any other form of matrix (e.g.&nbsp;a
logical or character matrix) supplied as a matrix is treated as an
indexing vector.
</p>
<hr size="6">
<a name="The-array_0028_0029-function"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Index-matrices" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-recycling-rule" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-array_0028_0029-function-1"></a>
<h2 class="section">5.4 The <code>array()</code> function</h2>
<a name="index-array"></a>

<p>As well as giving a vector structure a <code>dim</code> attribute, arrays can
be constructed from vectors by the <code>array</code> function, which has the
form
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; Z &lt;- array(<var>data_vector</var>, <var>dim_vector</var>)
</pre></td></tr></table>

<p>For example, if the vector <code>h</code> contains 24 or fewer, numbers then
the command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; Z &lt;- array(h, dim=c(3,4,2))
</pre></td></tr></table>

<p>would use <code>h</code> to set up <em>3</em> by <em>4</em> by <em>2</em> array in
<code>Z</code>.  If the size of <code>h</code> is exactly 24 the result is the same as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; Z &lt;- h ; dim(Z) &lt;- c(3,4,2)
</pre></td></tr></table>

<p>However if <code>h</code> is shorter than 24, its values are recycled from the
beginning again to make it up to size 24 (see section <a href="#The-recycling-rule">Mixed vector and array arithmetic. The recycling rule</a>)
but <code>dim(h) &lt;- c(3,4,2)</code> would signal an error about mismatching
length.
As an extreme but common example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; Z &lt;- array(0, c(3,4,2))
</pre></td></tr></table>

<p>makes <code>Z</code> an array of all zeros.
</p>
<p>At this point <code>dim(Z)</code> stands for the dimension vector
<code>c(3,4,2)</code>, and <code>Z[1:24]</code> stands for the data vector as it was
in <code>h</code>, and <code>Z[]</code> with an empty subscript or <code>Z</code> with no
subscript stands for the entire array as an array.
</p>
<p>Arrays may be used in arithmetic expressions and the result is an array
formed by element-by-element operations on the data vector.  The
<code>dim</code> attributes of operands generally need to be the same, and
this becomes the dimension vector of the result.  So if <code>A</code>,
<code>B</code> and <code>C</code> are all similar arrays, then
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; D &lt;- 2*A*B + C + 1
</pre></td></tr></table>

<p>makes <code>D</code> a similar array with its data vector being the result of
the given element-by-element operations.  However the precise rule
concerning mixed array and vector calculations has to be considered a
little more carefully.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#The-recycling-rule">5.4.1 Mixed vector and array arithmetic. The recycling rule</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          
</td></tr>
</table>

<hr size="6">
<a name="The-recycling-rule"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-array_0028_0029-function" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-outer-product-of-two-arrays" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-array_0028_0029-function" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Mixed-vector-and-array-arithmetic_002e-The-recycling-rule"></a>
<h3 class="subsection">5.4.1 Mixed vector and array arithmetic. The recycling rule</h3>
<a name="index-Recycling-rule-1"></a>

<p>The precise rule affecting element by element mixed calculations with
vectors and arrays is somewhat quirky and hard to find in the
references.  From experience we have found the following to be a reliable
guide.
</p>
<ul>
<li>
The expression is scanned from left to right.
</li><li>
Any short vector operands are extended by recycling their values until
they match the size of any other operands.
</li><li>
As long as short vectors and arrays <em>only</em> are encountered, the
arrays must all have the same <code>dim</code> attribute or an error results.
</li><li>
Any vector operand longer than a matrix or array operand generates an error.
</li><li>
If array structures are present and no error or coercion to vector has
been precipitated, the result is an array structure with the common
<code>dim</code> attribute of its array operands.
</li></ul>

<hr size="6">
<a name="The-outer-product-of-two-arrays"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-recycling-rule" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Generalized-transpose-of-an-array" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-outer-product-of-two-arrays-1"></a>
<h2 class="section">5.5 The outer product of two arrays</h2>
<a name="index-Outer-products-of-arrays"></a>

<p>An important operation on arrays is the <em>outer product</em>.  If
<code>a</code> and <code>b</code> are two numeric arrays, their outer product is an
array whose dimension vector is obtained by concatenating their two
dimension vectors (order is important), and whose data vector is got by
forming all possible products of elements of the data vector of <code>a</code>
with those of <code>b</code>.  The outer product is formed by the special
operator <code>%o%</code>:
<a name="index-_0025o_0025"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; ab &lt;- a %o% b
</pre></td></tr></table>

<p>An alternative is
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; ab &lt;- outer(a, b, &quot;*&quot;)
</pre></td></tr></table>
<a name="index-outer"></a>

<p>The multiplication function can be replaced by an arbitrary function of
two variables.  For example if we wished to evaluate the function
f(x; y) = cos(y)/(1 + x^2)over a regular grid of values with <em>x</em>- and <em>y</em>-coordinates
defined by the R vectors <code>x</code> and <code>y</code> respectively, we could
proceed as follows:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; f &lt;- function(x, y) cos(y)/(1 + x^2)
&gt; z &lt;- outer(x, y, f)
</pre></td></tr></table>

<p>In particular the outer product of two ordinary vectors is a doubly
subscripted array (that is a matrix, of rank at most 1).  Notice that
the outer product operator is of course non-commutative.  Defining your
own R functions will be considered further in <a href="#Writing-your-own-functions">Writing your own functions</a>.
</p>
<a name="An-example_003a-Determinants-of-2-by-2-single_002ddigit-matrices"></a>
<h4 class="subsubheading">An example: Determinants of 2 by 2 single-digit matrices</h4>

<p>As an artificial but cute example, consider the determinants of <em>2</em>
by <em>2</em> matrices <em>[a, b; c, d]</em> where each entry is a
non-negative integer in the range <em>0, 1, &hellip;, 9</em>, that is a
digit.
</p>
<p>The problem is to find the determinants, <em>ad - bc</em>, of all possible
matrices of this form and represent the frequency with which each value
occurs as a <em>high density</em> plot.  This amounts to finding the
probability distribution of the determinant if each digit is chosen
independently and uniformly at random.
</p>
<p>A neat way of doing this uses the <code>outer()</code> function twice:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; d &lt;- outer(0:9, 0:9)
&gt; fr &lt;- table(outer(d, d, &quot;-&quot;))
&gt; plot(as.numeric(names(fr)), fr, type=&quot;h&quot;,
       xlab=&quot;Determinant&quot;, ylab=&quot;Frequency&quot;)
</pre></td></tr></table>

<p>Notice the coercion of the <code>names</code> attribute of the frequency table
to numeric in order to recover the range of the determinant values.  The
&ldquo;obvious&rdquo; way of doing this problem with <code>for</code> loops, to be
discussed in <a href="#Loops-and-conditional-execution">Grouping, loops and conditional execution</a>, is so inefficient as
to be impractical.
</p>
<p>It is also perhaps surprising that about 1 in 20 such matrices is
singular.
</p>
<hr size="6">
<a name="Generalized-transpose-of-an-array"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-outer-product-of-two-arrays" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Matrix-facilities" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Generalized-transpose-of-an-array-1"></a>
<h2 class="section">5.6 Generalized transpose of an array</h2>
<a name="index-Generalized-transpose-of-an-array"></a>

<p>The function <code>aperm(a, perm)</code>
<a name="index-aperm"></a>
may be used to permute an array, <code>a</code>.  The argument <code>perm</code>
must be a permutation of the integers <em>1, &hellip;, k</em>, where
<em>k</em> is the number of subscripts in <code>a</code>.  The result of the
function is an array of the same size as <code>a</code> but with old dimension
given by <code>perm[j]</code> becoming the new <code>j</code>-th dimension.  The
easiest way to think of this operation is as a generalization of
transposition for matrices.  Indeed if <code>A</code> is a matrix, (that is, a
doubly subscripted array) then <code>B</code> given by
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; B &lt;- aperm(A, c(2,1))
</pre></td></tr></table>

<p>is just the transpose of <code>A</code>.  For this special case a simpler
function <code>t()</code>
<a name="index-t"></a>
is available, so we could have used <code>B &lt;- t(A)</code>.
</p>
<hr size="6">
<a name="Matrix-facilities"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Generalized-transpose-of-an-array" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Multiplication" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Matrix-facilities-1"></a>
<h2 class="section">5.7 Matrix facilities</h2>


<p>As noted above, a matrix is just an array with two subscripts.  However
it is such an important special case it needs a separate discussion.
R contains many operators and functions that are available only for
matrices.  For example <code>t(X)</code> is the matrix transpose function, as
noted above.  The functions <code>nrow(A)</code> and <code>ncol(A)</code> give the
number of rows and columns in the matrix <code>A</code> respectively.
<a name="index-nrow"></a>
<a name="index-ncol"></a>
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Multiplication">5.7.1 Matrix multiplication</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              
</td></tr>
<tr><td align="left" valign="top"><a href="#Linear-equations-and-inversion">5.7.2 Linear equations and inversion</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Eigenvalues-and-eigenvectors">5.7.3 Eigenvalues and eigenvectors</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Singular-value-decomposition-and-determinants">5.7.4 Singular value decomposition and determinants</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Least-squares-fitting-and-the-QR-decomposition">5.7.5 Least squares fitting and the QR decomposition</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
</table>

<hr size="6">
<a name="Multiplication"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Matrix-facilities" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Linear-equations-and-inversion" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Matrix-facilities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Matrix-multiplication"></a>
<h3 class="subsection">5.7.1 Matrix multiplication</h3>

<a name="index-Matrix-multiplication"></a>
<p>The operator <code>%*%</code> is used for matrix multiplication.
<a name="index-_0025_002a_0025"></a>
An <em>n</em> by <em>1</em> or <em>1</em> by <em>n</em> matrix may of course be
used as an <em>n</em>-vector if in the context such is appropriate.
Conversely, vectors which occur in matrix multiplication expressions are
automatically promoted either to row or column vectors, whichever is
multiplicatively coherent, if possible, (although this is not always
unambiguously possible, as we see later).
</p>
<p>If, for example, <code>A</code> and <code>B</code> are square matrices of the same
size, then
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; A * B
</pre></td></tr></table>

<p>is the matrix of element by element products and
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; A %*% B
</pre></td></tr></table>

<p>is the matrix product.  If <code>x</code> is a vector, then
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; x %*% A %*% x
</pre></td></tr></table>

<p>is a quadratic form.<a name="DOCF15" href="#FOOT15">(15)</a>
</p>
<a name="index-crossprod-1"></a>
<p>The function <code>crossprod()</code> forms &ldquo;crossproducts&rdquo;, meaning that
<code>crossprod(X, y)</code> is the same as <code>t(X) %*% y</code> but the
operation is more efficient.  If the second argument to
<code>crossprod()</code> is omitted it is taken to be the same as the first.
</p>
<a name="index-diag"></a>
<p>The meaning of <code>diag()</code> depends on its argument.  <code>diag(v)</code>,
where <code>v</code> is a vector, gives a diagonal matrix with elements of the
vector as the diagonal entries.  On the other hand <code>diag(M)</code>, where
<code>M</code> is a matrix, gives the vector of main diagonal entries of
<code>M</code>.  This is the same convention as that used for <code>diag()</code> in
<small>MATLAB</small>.  Also, somewhat confusingly, if <code>k</code> is a single
numeric value then <code>diag(k)</code> is the <code>k</code> by <code>k</code> identity
matrix!
</p>
<hr size="6">
<a name="Linear-equations-and-inversion"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Multiplication" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Eigenvalues-and-eigenvectors" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Matrix-facilities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Linear-equations-and-inversion-1"></a>
<h3 class="subsection">5.7.2 Linear equations and inversion</h3>

<a name="index-Linear-equations"></a>
<a name="index-solve"></a>
<p>Solving linear equations is the inverse of matrix multiplication.
When after
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; b &lt;- A %*% x
</pre></td></tr></table>

<p>only <code>A</code> and <code>b</code> are given, the vector <code>x</code> is the
solution of that linear equation system.  In R,
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; solve(A,b)
</pre></td></tr></table>

<p>solves the system, returning <code>x</code> (up to some accuracy loss).
Note that in linear algebra, formally
<code>x = A^{-1} %*% b</code>where
<code>A^{-1}</code> denotes the <em>inverse</em> of
<code>A</code>, which can be computed by
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">solve(A)
</pre></td></tr></table>

<p>but rarely is needed.  Numerically, it is both inefficient and
potentially unstable to compute <code>x &lt;- solve(A) %*% b</code> instead of
<code>solve(A,b)</code>.
</p>
<p>The quadratic form &nbsp;<code>x %*% A^{-1} %*%
x</code> &nbsp; which is used in multivariate computations, should be computed by
something like<a name="DOCF16" href="#FOOT16">(16)</a> <code>x %*% solve(A,x)</code>, rather than
computing the inverse of <code>A</code>.
</p>
<hr size="6">
<a name="Eigenvalues-and-eigenvectors"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Linear-equations-and-inversion" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Singular-value-decomposition-and-determinants" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Matrix-facilities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Eigenvalues-and-eigenvectors-1"></a>
<h3 class="subsection">5.7.3 Eigenvalues and eigenvectors</h3>
<a name="index-Eigenvalues-and-eigenvectors"></a>

<a name="index-eigen"></a>
<p>The function <code>eigen(Sm)</code> calculates the eigenvalues and
eigenvectors of a symmetric matrix <code>Sm</code>.  The result of this
function is a list of two components named <code>values</code> and
<code>vectors</code>.  The assignment
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; ev &lt;- eigen(Sm)
</pre></td></tr></table>

<p>will assign this list to <code>ev</code>.  Then <code>ev$val</code> is the vector of
eigenvalues of <code>Sm</code> and <code>ev$vec</code> is the matrix of
corresponding eigenvectors.  Had we only needed the eigenvalues we could
have used the assignment:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; evals &lt;- eigen(Sm)$values
</pre></td></tr></table>

<p><code>evals</code> now holds the vector of eigenvalues and the second
component is discarded.  If the expression
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; eigen(Sm)
</pre></td></tr></table>

<p>is used by itself as a command the two components are printed, with
their names.  For large matrices it is better to avoid computing the
eigenvectors if they are not needed by using the expression
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; evals &lt;- eigen(Sm, only.values = TRUE)$values
</pre></td></tr></table>


<hr size="6">
<a name="Singular-value-decomposition-and-determinants"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Eigenvalues-and-eigenvectors" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Least-squares-fitting-and-the-QR-decomposition" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Matrix-facilities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Singular-value-decomposition-and-determinants-1"></a>
<h3 class="subsection">5.7.4 Singular value decomposition and determinants</h3>
<a name="index-Singular-value-decomposition"></a>

<a name="index-svd"></a>
<p>The function <code>svd(M)</code> takes an arbitrary matrix argument, <code>M</code>,
and calculates the singular value decomposition of <code>M</code>.  This
consists of a matrix of orthonormal columns <code>U</code> with the same
column space as <code>M</code>, a second matrix of orthonormal columns
<code>V</code> whose column space is the row space of <code>M</code> and a diagonal
matrix of positive entries <code>D</code> such that <code>M = U %*% D %*%
t(V)</code>.  <code>D</code> is actually returned as a vector of the diagonal
elements.  The result of <code>svd(M)</code> is actually a list of three
components named <code>d</code>, <code>u</code> and <code>v</code>, with evident meanings.
</p>
<p>If <code>M</code> is in fact square, then, it is not hard to see that
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; absdetM &lt;- prod(svd(M)$d)
</pre></td></tr></table>

<p>calculates the absolute value of the determinant of <code>M</code>.  If this
calculation were needed often with a variety of matrices it could be
defined as an R function
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; absdet &lt;- function(M) prod(svd(M)$d)
</pre></td></tr></table>

<a name="index-Determinants"></a>
<p>after which we could use <code>absdet()</code> as just another R function.
As a further trivial but potentially useful example, you might like to
consider writing a function, say <code>tr()</code>, to calculate the trace of
a square matrix.  [Hint: You will not need to use an explicit loop.
Look again at the <code>diag()</code> function.]
</p>
<a name="index-det"></a>
<a name="index-determinant"></a>
<p>R has a builtin function <code>det</code> to calculate a determinant,
including the sign, and another, <code>determinant</code>, to give the sign
and modulus (optionally on log scale),
</p>

<hr size="6">
<a name="Least-squares-fitting-and-the-QR-decomposition"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Singular-value-decomposition-and-determinants" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Forming-partitioned-matrices" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Matrix-facilities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Least-squares-fitting-and-the-QR-decomposition-1"></a>
<h3 class="subsection">5.7.5 Least squares fitting and the QR decomposition</h3>
<a name="index-Least-squares-fitting"></a>
<a name="index-QR-decomposition"></a>

<p>The function <code>lsfit()</code> returns a list giving results of a least
squares fitting procedure.  An assignment such as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; ans &lt;- lsfit(X, y)
</pre></td></tr></table>
<a name="index-lsfit"></a>

<p>gives the results of a least squares fit where <code>y</code> is the vector of
observations and <code>X</code> is the design matrix.  See the help facility
for more details, and also for the follow-up function <code>ls.diag()</code>
for, among other things, regression diagnostics.  Note that a grand mean
term is automatically included and need not be included explicitly as a
column of <code>X</code>.  Further note that you almost always will prefer
using <code>lm(.)</code> (see section <a href="#Linear-models">Linear models</a>) to <code>lsfit()</code> for
regression modelling.
</p>
<a name="index-qr"></a>
<p>Another closely related function is <code>qr()</code> and its allies.
Consider the following assignments
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; Xplus &lt;- qr(X)
&gt; b &lt;- qr.coef(Xplus, y)
&gt; fit &lt;- qr.fitted(Xplus, y)
&gt; res &lt;- qr.resid(Xplus, y)
</pre></td></tr></table>

<p>These compute the orthogonal projection of <code>y</code> onto the range of
<code>X</code> in <code>fit</code>, the projection onto the orthogonal complement in
<code>res</code> and the coefficient vector for the projection in <code>b</code>,
that is, <code>b</code> is essentially the result of the <small>MATLAB</small>
&lsquo;backslash&rsquo; operator.
</p>
<p>It is not assumed that <code>X</code> has full column rank.  Redundancies will
be discovered and removed as they are found.
</p>
<p>This alternative is the older, low-level way to perform least squares
calculations.  Although still useful in some contexts, it would now
generally be replaced by the statistical models features, as will be
discussed in <a href="#Statistical-models-in-R">Statistical models in R</a>.
</p>

<hr size="6">
<a name="Forming-partitioned-matrices"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Least-squares-fitting-and-the-QR-decomposition" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-concatenation-function-c_0028_0029-with-arrays" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Forming-partitioned-matrices_002c-cbind_0028_0029-and-rbind_0028_0029"></a>
<h2 class="section">5.8 Forming partitioned matrices, <code>cbind()</code> and <code>rbind()</code></h2>
<a name="index-cbind"></a>
<a name="index-rbind"></a>

<p>As we have already seen informally, matrices can be built up from other
vectors and matrices by the functions <code>cbind()</code> and <code>rbind()</code>.
Roughly <code>cbind()</code> forms matrices by binding together matrices
horizontally, or column-wise, and <code>rbind()</code> vertically, or
row-wise.
</p>
<p>In the assignment
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; X &lt;- cbind(<var>arg_1</var>, <var>arg_2</var>, <var>arg_3</var>, &hellip;)
</pre></td></tr></table>

<p>the arguments to <code>cbind()</code> must be either vectors of any length, or
matrices with the same column size, that is the same number of rows.
The result is a matrix with the concatenated arguments <var>arg_1</var>,
<var>arg_2</var>, &hellip; forming the columns.
</p>
<p>If some of the arguments to <code>cbind()</code> are vectors they may be
shorter than the column size of any matrices present, in which case they
are cyclically extended to match the matrix column size (or the length
of the longest vector if no matrices are given).
</p>
<p>The function <code>rbind()</code> does the corresponding operation for rows.
In this case any vector argument, possibly cyclically extended, are of
course taken as row vectors.
</p>
<p>Suppose <code>X1</code> and <code>X2</code> have the same number of rows.  To
combine these by columns into a matrix <code>X</code>, together with an
initial column of <code>1</code>s we can use
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; X &lt;- cbind(1, X1, X2)
</pre></td></tr></table>

<p>The result of <code>rbind()</code> or <code>cbind()</code> always has matrix status.
Hence <code>cbind(x)</code> and <code>rbind(x)</code> are possibly the simplest ways
explicitly to allow the vector <code>x</code> to be treated as a column or row
matrix respectively.
</p>
<hr size="6">
<a name="The-concatenation-function-c_0028_0029-with-arrays"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Forming-partitioned-matrices" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Frequency-tables-from-factors" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-concatenation-function_002c-c_0028_0029_002c-with-arrays"></a>
<h2 class="section">5.9 The concatenation function, <code>c()</code>, with arrays</h2>

<p>It should be noted that whereas <code>cbind()</code> and <code>rbind()</code> are
concatenation functions that respect <code>dim</code> attributes, the basic
<code>c()</code> function does not, but rather clears numeric objects of all
<code>dim</code> and <code>dimnames</code> attributes.  This is occasionally useful
in its own right.
</p>
<p>The official way to coerce an array back to a simple vector object is to
use <code>as.vector()</code>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; vec &lt;- as.vector(X)
</pre></td></tr></table>
<a name="index-as_002evector"></a>

<p>However a similar result can be achieved by using <code>c()</code> with just
one argument, simply for this side-effect:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; vec &lt;- c(X)
</pre></td></tr></table>
<a name="index-c-2"></a>

<p>There are slight differences between the two, but ultimately the choice
between them is largely a matter of style (with the former being
preferable).
</p>
<hr size="6">
<a name="Frequency-tables-from-factors"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-concatenation-function-c_0028_0029-with-arrays" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Frequency-tables-from-factors-1"></a>
<h2 class="section">5.10 Frequency tables from factors</h2>
<a name="index-Tabulation"></a>

<p>Recall that a factor defines a partition into groups.  Similarly a pair
of factors defines a two way cross classification, and so on.
<a name="index-table-1"></a>
The function <code>table()</code> allows frequency tables to be calculated
from equal length factors.  If there are <em>k</em> factor arguments,
the result is a <em>k</em>-way array of frequencies.
</p>
<p>Suppose, for example, that <code>statef</code> is a factor giving the state
code for each entry in a data vector.  The assignment
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; statefr &lt;- table(statef)
</pre></td></tr></table>

<p>gives in <code>statefr</code> a table of frequencies of each state in the
sample.  The frequencies are ordered and labelled by the <code>levels</code>
attribute of the factor.  This simple case is equivalent to, but more
convenient than,
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; statefr &lt;- tapply(statef, statef, length)
</pre></td></tr></table>

<p>Further suppose that <code>incomef</code> is a factor giving a suitably
defined &ldquo;income class&rdquo; for each entry in the data vector, for example
with the <code>cut()</code> function:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; factor(cut(incomes, breaks = 35+10*(0:7))) -&gt; incomef
</pre></td></tr></table>
<a name="index-cut"></a>

<p>Then to calculate a two-way table of frequencies:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; table(incomef,statef)
         statef
incomef   act nsw nt qld sa tas vic wa
  (35,45]   1   1  0   1  0   0   1  0
  (45,55]   1   1  1   1  2   0   1  3
  (55,65]   0   3  1   3  2   2   2  1
  (65,75]   0   1  0   0  0   0   1  0
</pre></td></tr></table>

<p>Extension to higher-way frequency tables is immediate.
</p>
<hr size="6">
<a name="Lists-and-data-frames"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Frequency-tables-from-factors" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Lists" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Arrays-and-matrices" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Lists-and-data-frames-1"></a>
<h1 class="chapter">6. Lists and data frames</h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Lists">6.1 Lists</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                       
</td></tr>
<tr><td align="left" valign="top"><a href="#Constructing-and-modifying-lists">6.2 Constructing and modifying lists</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Data-frames">6.3 Data frames</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 
</td></tr>
</table>

<hr size="6">
<a name="Lists"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Constructing-and-modifying-lists" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Lists-1"></a>
<h2 class="section">6.1 Lists</h2>
<a name="index-Lists"></a>

<p>An R <em>list</em> is an object consisting of an ordered collection of
objects known as its <em>components</em>.
</p>
<p>There is no particular need for the components to be of the same mode or
type, and, for example, a list could consist of a numeric vector, a
logical value, a matrix, a complex vector, a character array, a
function, and so on.  Here is a simple example of how to make a list:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; Lst &lt;- list(name=&quot;Fred&quot;, wife=&quot;Mary&quot;, no.children=3,
              child.ages=c(4,7,9))
</pre></td></tr></table>
<a name="index-list"></a>

<p>Components are always <em>numbered</em> and may always be referred to as
such.  Thus if <code>Lst</code> is the name of a list with four components,
these may be individually referred to as <code>Lst[[1]]</code>,
<code>Lst[[2]]</code>, <code>Lst[[3]]</code> and <code>Lst[[4]]</code>.  If, further,
<code>Lst[[4]]</code> is a vector subscripted array then <code>Lst[[4]][1]</code> is
its first entry.
</p>
<p>If <code>Lst</code> is a list, then the function <code>length(Lst)</code> gives the
number of (top level) components it has.
</p>
<p>Components of lists may also be <em>named</em>, and in this case the
component may be referred to either by giving the component name as a
character string in place of the number in double square brackets, or,
more conveniently, by giving an expression of the form
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; <var>name</var>$<var>component_name</var>
</pre></td></tr></table>

<p>for the same thing.
</p>
<p>This is a very useful convention as it makes it easier to get the right
component if you forget the number.
</p>
<p>So in the simple example given above:
</p>
<p><code>Lst$name</code> is the same as <code>Lst[[1]]</code> and is the string
<code>&quot;Fred&quot;</code>,
</p>
<p><code>Lst$wife</code> is the same as <code>Lst[[2]]</code> and is the string
<code>&quot;Mary&quot;</code>,
</p>
<p><code>Lst$child.ages[1]</code> is the same as <code>Lst[[4]][1]</code> and is the
number <code>4</code>.
</p>
<p>Additionally, one can also use the names of the list components in
double square brackets, i.e., <code>Lst[[&quot;name&quot;]]</code> is the same as
<code>Lst$name</code>.  This is especially useful, when the name of the
component to be extracted is stored in another variable as in
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; x &lt;- &quot;name&quot;; Lst[[x]]
</pre></td></tr></table>

<p>It is very important to distinguish <code>Lst[[1]]</code> from <code>Lst[1]</code>.
&lsquo;<samp><code>[[<var>&hellip;</var>]]</code></samp>&rsquo; is the operator used to select a single
element, whereas &lsquo;<samp><code>[<var>&hellip;</var>]</code></samp>&rsquo; is a general subscripting
operator.  Thus the former is the <em>first object in the list</em>
<code>Lst</code>, and if it is a named list the name is <em>not</em> included.
The latter is a <em>sublist of the list <code>Lst</code> consisting of the
first entry only.  If it is a named list, the names are transferred to
the sublist.</em>
</p>
<p>The names of components may be abbreviated down to the minimum number of
letters needed to identify them uniquely.  Thus <code>Lst$coefficients</code>
may be minimally specified as <code>Lst$coe</code> and <code>Lst$covariance</code>
as <code>Lst$cov</code>.
</p>
<p>The vector of names is in fact simply an attribute of the list like any
other and may be handled as such.  Other structures besides lists may,
of course, similarly be given a <em>names</em> attribute also.
</p>
<hr size="6">
<a name="Constructing-and-modifying-lists"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Lists" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Concatenating-lists" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Constructing-and-modifying-lists-1"></a>
<h2 class="section">6.2 Constructing and modifying lists</h2>

<p>New lists may be formed from existing objects by the function
<code>list()</code>.  An assignment of the form
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; Lst &lt;- list(<var>name_1</var>=<var>object_1</var>, <var>&hellip;</var>, <var>name_m</var>=<var>object_m</var>)
</pre></td></tr></table>

<p>sets up a list <code>Lst</code> of <em>m</em> components using <var>object_1</var>,
&hellip;, <var>object_m</var> for the components and giving them names as
specified by the argument names, (which can be freely chosen).  If these
names are omitted, the components are numbered only.  The components
used to form the list are <em>copied</em> when forming the new list and
the originals are not affected.
</p>
<p>Lists, like any subscripted object, can be extended by specifying
additional components.  For example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; Lst[5] &lt;- list(matrix=Mat)
</pre></td></tr></table>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Concatenating-lists">6.2.1 Concatenating lists</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         
</td></tr>
</table>

<hr size="6">
<a name="Concatenating-lists"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Constructing-and-modifying-lists" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Data-frames" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Constructing-and-modifying-lists" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Concatenating-lists-1"></a>
<h3 class="subsection">6.2.1 Concatenating lists</h3>
<a name="index-Concatenating-lists"></a>

<a name="index-c-3"></a>
<p>When the concatenation function <code>c()</code> is given list arguments, the
result is an object of mode list also, whose components are those of the
argument lists joined together in sequence.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; list.ABC &lt;- c(list.A, list.B, list.C)
</pre></td></tr></table>

<p>Recall that with vector objects as arguments the concatenation function
similarly joined together all arguments into a single vector structure.
In this case all other attributes, such as <code>dim</code> attributes, are
discarded.
</p>

<hr size="6">
<a name="Data-frames"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Concatenating-lists" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Making-data-frames" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Data-frames-1"></a>
<h2 class="section">6.3 Data frames</h2>
<a name="index-Data-frames"></a>

<p>A <em>data frame</em> is a list with class <code>&quot;data.frame&quot;</code>.  There are
restrictions on lists that may be made into data frames, namely
</p>
<ul>
<li>
The components must be vectors (numeric, character, or logical),
factors, numeric matrices, lists, or other data frames.
</li><li>
Matrices, lists, and data frames provide as many variables to the new
data frame as they have columns, elements, or variables, respectively.
</li><li>
Numeric vectors, logicals and factors are included as is, and by
default<a name="DOCF17" href="#FOOT17">(17)</a> character vectors are coerced to be
factors, whose levels are the unique values appearing in the vector.
</li><li>
Vector structures appearing as variables of the data frame must all have
the <em>same length</em>, and matrix structures must all have the same
<em>row size</em>.
</li></ul>

<p>A data frame may for many purposes be regarded as a matrix with columns
possibly of differing modes and attributes.  It may be displayed in
matrix form, and its rows and columns extracted using matrix indexing
conventions.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Making-data-frames">6.3.1 Making data frames</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          
</td></tr>
<tr><td align="left" valign="top"><a href="#attach_0028_0029-and-detach_0028_0029">6.3.2 <code>attach() and <code>detach()</code></code></a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       
</td></tr>
<tr><td align="left" valign="top"><a href="#Working-with-data-frames">6.3.3 Working with data frames</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">    
</td></tr>
<tr><td align="left" valign="top"><a href="#Attaching-arbitrary-lists">6.3.4 Attaching arbitrary lists</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   
</td></tr>
<tr><td align="left" valign="top"><a href="#Managing-the-search-path">6.3.5 Managing the search path</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">    
</td></tr>
</table>

<hr size="6">
<a name="Making-data-frames"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Data-frames" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#attach_0028_0029-and-detach_0028_0029" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Data-frames" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Making-data-frames-1"></a>
<h3 class="subsection">6.3.1 Making data frames</h3>

<p>Objects satisfying the restrictions placed on the columns (components)
of a data frame may be used to form one using the function
<code>data.frame</code>:
<a name="index-data_002eframe"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; accountants &lt;- data.frame(home=statef, loot=incomes, shot=incomef)
</pre></td></tr></table>

<p>A list whose components conform to the restrictions of a data frame may
be <em>coerced</em> into a data frame using the function
<code>as.data.frame()</code>
<a name="index-as_002edata_002eframe"></a>
</p>
<p>The simplest way to construct a data frame from scratch is to use the
<code>read.table()</code> function to read an entire data frame from an
external file.  This is discussed further in <a href="#Reading-data-from-files">Reading data from files</a>.
</p>
<hr size="6">
<a name="attach_0028_0029-and-detach_0028_0029"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Making-data-frames" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Working-with-data-frames" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Data-frames" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="attach_0028_0029-and-detach_0028_0029-1"></a>
<h3 class="subsection">6.3.2 <code>attach() and <code>detach()</code></code></h3>
<a name="index-attach"></a>
<a name="index-detach"></a>

<p>The <code>$</code> notation, such as <code>accountants$home</code>, for list
components is not always very convenient.  A useful facility would be
somehow to make the components of a list or data frame temporarily
visible as variables under their component name, without the need to
quote the list name explicitly each time.
</p>
<p>The <code>attach()</code> function takes a &lsquo;database&rsquo; such as a list or data
frame as its argument.  Thus suppose <code>lentils</code> is a
data frame with three variables <code>lentils$u</code>, <code>lentils$v</code>,
<code>lentils$w</code>.  The attach
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; attach(lentils)
</pre></td></tr></table>

<p>places the data frame in the search path at position 2, and provided
there are no variables <code>u</code>, <code>v</code> or <code>w</code> in position 1,
<code>u</code>, <code>v</code> and <code>w</code> are available as variables from the data
frame in their own right.  At this point an assignment such as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; u &lt;- v+w
</pre></td></tr></table>

<p>does not replace the component <code>u</code> of the data frame, but rather
masks it with another variable <code>u</code> in the working directory at
position 1 on the search path.  To make a permanent change to the
data frame itself, the simplest way is to resort once again to the
<code>$</code> notation:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; lentils$u &lt;- v+w
</pre></td></tr></table>

<p>However the new value of component <code>u</code> is not visible until the
data frame is detached and attached again.
</p>
<p>To detach a data frame, use the function
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; detach()
</pre></td></tr></table>

<p>More precisely, this statement detaches from the search path the entity
currently at position 2.  Thus in the present context the variables
<code>u</code>, <code>v</code> and <code>w</code> would be no longer visible, except under
the list notation as <code>lentils$u</code> and so on.  Entities at positions
greater than 2 on the search path can be detached by giving their number
to <code>detach</code>, but it is much safer to always use a name, for example
by <code>detach(lentils)</code> or <code>detach(&quot;lentils&quot;)</code>
</p>
<blockquote><p><b>Note:</b> In R lists and data frames can only be attached at position 2 or
above, and what is attached is a <em>copy</em> of the original object.
You can alter the attached values <em>via</em> <code>assign</code>, but the
original list or data frame is unchanged.
</p></blockquote>

<hr size="6">
<a name="Working-with-data-frames"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#attach_0028_0029-and-detach_0028_0029" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Attaching-arbitrary-lists" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Data-frames" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Working-with-data-frames-1"></a>
<h3 class="subsection">6.3.3 Working with data frames</h3>

<p>A useful convention that allows you to work with many different problems
comfortably together in the same working directory is
</p>
<ul>
<li>
gather together all variables for any well defined and separate problem
in a data frame under a suitably informative name;
</li><li>
when working with a problem attach the appropriate data frame at
position 2, and use the working directory at level 1 for
operational quantities and temporary variables;
</li><li>
before leaving a problem, add any variables you wish to keep for future
reference to the data frame using the <code>$</code> form of assignment, and
then <code>detach()</code>;
</li><li>
finally remove all unwanted variables from the working directory and
keep it as clean of left-over temporary variables as possible.
</li></ul>

<p>In this way it is quite simple to work with many problems in the same
directory, all of which have variables named <code>x</code>, <code>y</code> and
<code>z</code>, for example.
</p>
<hr size="6">
<a name="Attaching-arbitrary-lists"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Working-with-data-frames" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Managing-the-search-path" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Data-frames" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Attaching-arbitrary-lists-1"></a>
<h3 class="subsection">6.3.4 Attaching arbitrary lists</h3>

<p><code>attach()</code> is a generic function that allows not only directories
and data frames to be attached to the search path, but other classes of
object as well.  In particular any object of mode <code>&quot;list&quot;</code> may be
attached in the same way:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; attach(any.old.list)
</pre></td></tr></table>

<p>Anything that has been attached can be detached by <code>detach</code>, by
position number or, preferably, by name.
</p>
<hr size="6">
<a name="Managing-the-search-path"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Attaching-arbitrary-lists" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Data-frames" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Managing-the-search-path-1"></a>
<h3 class="subsection">6.3.5 Managing the search path</h3>
<a name="index-search"></a>
<a name="index-Search-path"></a>

<p>The function <code>search</code> shows the current search path and so is
a very useful way to keep track of which data frames and lists (and
packages) have been attached and detached.  Initially it gives
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; search()
[1] &quot;.GlobalEnv&quot;   &quot;Autoloads&quot;    &quot;package:base&quot;
</pre></td></tr></table>
<p>where <code>.GlobalEnv</code> is the workspace.<a name="DOCF18" href="#FOOT18">(18)</a>
</p>
<p>After <code>lentils</code> is attached we have
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; search()
[1] &quot;.GlobalEnv&quot;   &quot;lentils&quot;      &quot;Autoloads&quot;    &quot;package:base&quot;
&gt; ls(2)
[1] &quot;u&quot; &quot;v&quot; &quot;w&quot;
</pre></td></tr></table>

<p>and as we see <code>ls</code> (or <code>objects</code>) can be used to examine the
contents of any position on the search path.
</p>
<p>Finally, we detach the data frame and confirm it has been removed from
the search path.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; detach(&quot;lentils&quot;)
&gt; search()
[1] &quot;.GlobalEnv&quot;   &quot;Autoloads&quot;    &quot;package:base&quot;
</pre></td></tr></table>

<hr size="6">
<a name="Reading-data-from-files"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Managing-the-search-path" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-read_002etable_0028_0029-function" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Lists-and-data-frames" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Probability-distributions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Reading-data-from-files-1"></a>
<h1 class="chapter">7. Reading data from files</h1>
<a name="index-Reading-data-from-files"></a>

<p>Large data objects will usually be read as values from external files
rather than entered during an R session at the keyboard.  R input
facilities are simple and their requirements are fairly strict and even
rather inflexible.  There is a clear presumption by the designers of
R that you will be able to modify your input files using other tools,
such as file editors or Perl<a name="DOCF19" href="#FOOT19">(19)</a> to fit in with the requirements of R.  Generally
this is very simple.
</p>
<p>If variables are to be held mainly in data frames, as we strongly
suggest they should be, an entire data frame can be read directly with
the <code>read.table()</code> function.  There is also a more primitive input
function, <code>scan()</code>, that can be called directly.
</p>
<p>For more details on importing data into R and also exporting data,
see the <em>R Data Import/Export</em> manual.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#The-read_002etable_0028_0029-function">7.1 The <code>read.table()</code> function</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   
</td></tr>
<tr><td align="left" valign="top"><a href="#The-scan_0028_0029-function">7.2 The <code>scan()</code> function</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         
</td></tr>
<tr><td align="left" valign="top"><a href="#Accessing-builtin-datasets">7.3 Accessing builtin datasets</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Editing-data">7.4 Editing data</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                
</td></tr>
</table>

<hr size="6">
<a name="The-read_002etable_0028_0029-function"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-scan_0028_0029-function" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Probability-distributions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-read_002etable_0028_0029-function-1"></a>
<h2 class="section">7.1 The <code>read.table()</code> function</h2>
<a name="index-read_002etable"></a>

<p>To read an entire data frame directly, the external file will normally
have a special form.
</p>
<ul>
<li>
The first line of the file should have a <em>name</em> for each variable
in the data frame.

</li><li>
Each additional line of the file has as its first item a <em>row label</em>
and the values for each variable.
</li></ul>

<p>If the file has one fewer item in its first line than in its second, this
arrangement is presumed to be in force.  So the first few lines of a file
to be read as a data frame might look as follows.
</p>
<blockquote><table class="cartouche" border="1"><tr><td>
<table><tr><td>&nbsp;</td><td><pre class="example"><span class="roman">Input file form with names and row labels:</span>

     Price    Floor     Area   Rooms     Age  Cent.heat
01   52.00    111.0      830     5       6.2      no
02   54.75    128.0      710     5       7.5      no
03   57.50    101.0     1000     5       4.2      no
04   57.50    131.0      690     6       8.8      no
05   59.75     93.0      900     5       1.9     yes
...
</pre></td></tr></table>
</td></tr></table>
</blockquote>

<p>By default numeric items (except row labels) are read as numeric
variables and non-numeric variables, such as <code>Cent.heat</code> in the
example, as factors.  This can be changed if necessary.
</p>
<p>The function <code>read.table()</code> can then be used to read the data frame
directly
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; HousePrice &lt;- read.table(&quot;houses.data&quot;)
</pre></td></tr></table>

<p>Often you will want to omit including the row labels directly and use the
default labels.  In this case the file may omit the row label column as in
the following.
</p>
<blockquote><table class="cartouche" border="1"><tr><td>
<table><tr><td>&nbsp;</td><td><pre class="example"><span class="roman">Input file form without row labels:</span>

Price    Floor     Area   Rooms     Age  Cent.heat
52.00    111.0      830     5       6.2      no
54.75    128.0      710     5       7.5      no
57.50    101.0     1000     5       4.2      no
57.50    131.0      690     6       8.8      no
59.75     93.0      900     5       1.9     yes
...
</pre></td></tr></table>
</td></tr></table>
</blockquote>

<p>The data frame may then be read as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; HousePrice &lt;- read.table(&quot;houses.data&quot;, header=TRUE)
</pre></td></tr></table>

<p>where the <code>header=TRUE</code> option specifies that the first line is a
line of headings, and hence, by implication from the form of the file,
that no explicit row labels are given.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#The-scan_0028_0029-function">7.2 The <code>scan()</code> function</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="The-scan_0028_0029-function"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-read_002etable_0028_0029-function" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Accessing-builtin-datasets" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Probability-distributions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-scan_0028_0029-function-1"></a>
<h2 class="section">7.2 The <code>scan()</code> function</h2>
<a name="index-scan"></a>

<p>Suppose the data vectors are of equal length and are to be read in
parallel.  Further suppose that there are three vectors, the first of
mode character and the remaining two of mode numeric, and the file is
&lsquo;<tt>input.dat</tt>&rsquo;.  The first step is to use <code>scan()</code> to read in the
three vectors as a list, as follows
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; inp &lt;- scan(&quot;input.dat&quot;, list(&quot;&quot;,0,0))
</pre></td></tr></table>

<p>The second argument is a dummy list structure that establishes the mode
of the three vectors to be read.  The result, held in <code>inp</code>, is a
list whose components are the three vectors read in.  To separate the
data items into three separate vectors, use assignments like
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; label &lt;- inp[[1]]; x &lt;- inp[[2]]; y &lt;- inp[[3]]
</pre></td></tr></table>

<p>More conveniently, the dummy list can have named components, in which
case the names can be used to access the vectors read in.  For example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; inp &lt;- scan(&quot;input.dat&quot;, list(id=&quot;&quot;, x=0, y=0))
</pre></td></tr></table>

<p>If you wish to access the variables separately they may either be
re-assigned to variables in the working frame:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; label &lt;- inp$id; x &lt;- inp$x; y &lt;- inp$y
</pre></td></tr></table>

<p>or the list may be attached at position 2 of the search path
(see section <a href="#Attaching-arbitrary-lists">Attaching arbitrary lists</a>).
</p>
<p>If the second argument is a single value and not a list, a single vector
is read in, all components of which must be of the same mode as the
dummy value.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; X &lt;- matrix(scan(&quot;light.dat&quot;, 0), ncol=5, byrow=TRUE)
</pre></td></tr></table>

<p>There are more elaborate input facilities available and these are
detailed in the manuals.
</p>
<hr size="6">
<a name="Accessing-builtin-datasets"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-scan_0028_0029-function" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Loading-data-from-other-R-packages" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Probability-distributions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Accessing-builtin-datasets-1"></a>
<h2 class="section">7.3 Accessing builtin datasets</h2>
<a name="index-Accessing-builtin-datasets"></a>
<a name="index-data"></a>

<p>Around 100 datasets are supplied with R (in package <strong>datasets</strong>),
and others are available in packages (including the recommended packages
supplied with R).  To see the list of datasets currently available
use
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">data()
</pre></td></tr></table>

<p>As from R version 2.0.0 all the datasets supplied with R are
available directly by name.  However, many packages still use the
earlier convention in which <code>data</code> was also used to load datasets
into R, for example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">data(infert)
</pre></td></tr></table>

<p>and this can still be used with the standard packages (as in this
example).  In most cases this will load an R object of the same name.
However, in a few cases it loads several objects, so see the on-line
help for the object to see what to expect.
</p>
<hr size="6">
<a name="Loading-data-from-other-R-packages"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Accessing-builtin-datasets" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Editing-data" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Accessing-builtin-datasets" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Probability-distributions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">7.3.1 Loading data from other R packages</h3>

<p>To access data from a particular package, use the <code>package</code>
argument, for example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">data(package=&quot;rpart&quot;)
data(Puromycin, package=&quot;datasets&quot;)
</pre></td></tr></table>

<p>If a package has been attached by <code>library</code>, its datasets are
automatically included in the search.
</p>
<p>User-contributed packages can be a rich source of datasets.
</p>
<hr size="6">
<a name="Editing-data"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Loading-data-from-other-R-packages" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Probability-distributions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Probability-distributions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Editing-data-1"></a>
<h2 class="section">7.4 Editing data</h2>

<a name="index-edit"></a>
<p>When invoked on a data frame or matrix, <code>edit</code> brings up a separate
spreadsheet-like environment for editing.  This is useful for making
small changes once a data set has been read.  The command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; xnew &lt;- edit(xold)
</pre></td></tr></table>

<p>will allow you to edit your data set <code>xold</code>, and on completion the
changed object is assigned to <code>xnew</code>.  If you want to alter the
original dataset <code>xold</code>, the simplest way is to use
<code>fix(xold)</code>, which is equivalent to <code>xold &lt;- edit(xold)</code>.
</p>
<p>Use
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; xnew &lt;- edit(data.frame())
</pre></td></tr></table>

<p>to enter new data via the spreadsheet interface.
</p>

<hr size="6">
<a name="Probability-distributions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Editing-data" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#R-as-a-set-of-statistical-tables" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Reading-data-from-files" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Loops-and-conditional-execution" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Probability-distributions-1"></a>
<h1 class="chapter">8. Probability distributions</h1>
<a name="index-Probability-distributions"></a>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#R-as-a-set-of-statistical-tables">8.1 R as a set of statistical tables</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#One_002d-and-two_002dsample-tests">8.3 One- and two-sample tests</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   
</td></tr>
</table>

<hr size="6">
<a name="R-as-a-set-of-statistical-tables"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Probability-distributions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examining-the-distribution-of-a-set-of-data" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Probability-distributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Probability-distributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Loops-and-conditional-execution" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="R-as-a-set-of-statistical-tables-1"></a>
<h2 class="section">8.1 R as a set of statistical tables</h2>

<p>One convenient use of R is to provide a comprehensive set of
statistical tables.  Functions are provided to evaluate the cumulative
distribution function P(X &lt;= x),
the probability density function and the quantile function (given
<em>q</em>, the smallest <em>x</em> such that P(X &lt;= x) &gt; q),
and to simulate from the distribution.
</p>
<blockquote>@multitable{Distribution namessss}<p>{names, names{arguments, arguments
</p> Distribution <p> R name </p><p> additional arguments
</p> beta <p> <code>beta</code> </p><p> <code>shape1, shape2, ncp</code>
</p> binomial <p>  <code>binom</code> </p><p> <code>size, prob</code>
</p> Cauchy <p> <code>cauchy</code> </p><p> <code>location, scale</code>
</p> chi-squared <p> <code>chisq</code> </p><p> <code>df, ncp</code>
</p> exponential <p> <code>exp</code> </p><p> <code>rate</code>
</p> F <p> <code>f</code> </p><p> <code>df1, df2, ncp</code>
</p> gamma <p> <code>gamma</code> </p><p> <code>shape, scale</code>
</p> geometric <p> <code>geom</code> </p><p> <code>prob</code>
</p> hypergeometric <p> <code>hyper</code> </p><p> <code>m, n, k</code>
</p> log-normal <p> <code>lnorm</code> </p><p> <code>meanlog, sdlog</code>
</p> logistic <p> <code>logis</code> </p><p> <code>location, scale</code>
</p> negative binomial <p> <code>nbinom</code> </p><p> <code>size, prob</code>
</p> normal <p> <code>norm</code> </p><p> <code>mean, sd</code>
</p> Poisson <p> <code>pois</code> </p><p> <code>lambda</code>
</p> signed rank <p> <code>signrank</code> </p><p> <code>n</code>
</p> Student&rsquo;s t <p> <code>t</code> </p><p> <code>df, ncp</code>
</p> uniform <p> <code>unif</code> </p><p> <code>min, max</code>
</p> Weibull <p> <code>weibull</code> </p><p> <code>shape, scale</code>
</p> Wilcoxon <p> <code>wilcox</code> </p><p> <code>m, n</code>
</p></blockquote>

@end quotation

<p>Prefix the name given here by &lsquo;<samp>d</samp>&rsquo; for the density, &lsquo;<samp>p</samp>&rsquo; for the
CDF, &lsquo;<samp>q</samp>&rsquo; for the quantile function and &lsquo;<samp>r</samp>&rsquo; for simulation
(<em>r</em>andom deviates).  The first argument is <code>x</code> for
<code>d<var>xxx</var></code>, <code>q</code> for <code>p<var>xxx</var></code>, <code>p</code> for
<code>q<var>xxx</var></code> and <code>n</code> for <code>r<var>xxx</var></code> (except for
<code>rhyper</code>, <code>rsignrank</code> and <code>rwilcox</code>, for which it is
<code>nn</code>).  In not quite all cases is the non-centrality parameter
<code>ncp</code> currently available: see the on-line help for details.
</p>
<p>The <code>p<var>xxx</var></code> and <code>q<var>xxx</var></code> functions all have logical
arguments <code>lower.tail</code> and <code>log.p</code> and the <code>d<var>xxx</var></code>
ones have <code>log</code>.  This allows, e.g., getting the cumulative (or
&ldquo;integrated&rdquo;) <em>hazard</em> function, H(t) = - log(1 - F(t)), by
</p>
<table><tr><td>&nbsp;</td><td><pre class="example"> - p<var>xxx</var>(t, ..., lower.tail = FALSE, log.p = TRUE)
</pre></td></tr></table>

<p>or more accurate log-likelihoods (by <code>d<var>xxx</var>(..., log =
TRUE)</code>), directly.
</p>
<p>In addition there are functions <code>ptukey</code> and <code>qtukey</code> for the
distribution of the studentized range of samples from a normal
distribution, and <code>dmultinom</code> and <code>rmultinom</code> for the
multinomial distribution. Further distributions are available in
contributed packages, notably <a href="http://CRAN.R-project.org/package=SuppDists"><strong>SuppDists</strong></a>.
</p>
<p>Here are some examples
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; ## <span class="roman">2-tailed p-value for t distribution</span>
&gt; 2*pt(-2.43, df = 13)
&gt; ## <span class="roman">upper 1% point for an F(2, 7) distribution</span>
&gt; qf(0.01, 2, 7, lower.tail = FALSE)
</pre></td></tr></table>

<p>See the on-line help on <code>RNG</code> for how random-number generation is
done in R.
</p>
<hr size="6">
<a name="Examining-the-distribution-of-a-set-of-data"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#R-as-a-set-of-statistical-tables" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#One_002d-and-two_002dsample-tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Probability-distributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Probability-distributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Loops-and-conditional-execution" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Examining-the-distribution-of-a-set-of-data-1"></a>
<h2 class="section">8.2 Examining the distribution of a set of data</h2>

<p>Given a (univariate) set of data we can examine its distribution in a
large number of ways.  The simplest is to examine the numbers.  Two
slightly different summaries are given by <code>summary</code> and
<code>fivenum</code>
<a name="index-summary"></a>
<a name="index-fivenum"></a>
and a display of the numbers by <code>stem</code> (a &ldquo;stem and leaf&rdquo; plot).
<a name="index-stem"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; attach(faithful)
&gt; summary(eruptions)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
  1.600   2.163   4.000   3.488   4.454   5.100
&gt; fivenum(eruptions)
[1] 1.6000 2.1585 4.0000 4.4585 5.1000
&gt; stem(eruptions)

  The decimal point is 1 digit(s) to the left of the |

  16 | 070355555588
  18 | 000022233333335577777777888822335777888
  20 | 00002223378800035778
  22 | 0002335578023578
  24 | 00228
  26 | 23
  28 | 080
  30 | 7
  32 | 2337
  34 | 250077
  36 | 0000823577
  38 | 2333335582225577
  40 | 0000003357788888002233555577778
  42 | 03335555778800233333555577778
  44 | 02222335557780000000023333357778888
  46 | 0000233357700000023578
  48 | 00000022335800333
  50 | 0370
</pre></td></tr></table>

<p>A stem-and-leaf plot is like a histogram, and R has a function
<code>hist</code> to plot histograms.
<a name="index-hist"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; hist(eruptions)
## <span class="roman">make the bins smaller, make a plot of density</span>
&gt; hist(eruptions, seq(1.6, 5.2, 0.2), prob=TRUE)
&gt; lines(density(eruptions, bw=0.1))
&gt; rug(eruptions) # <span class="roman">show the actual data points</span>
</pre></td></tr></table>

<a name="index-density"></a>
<a name="index-Density-estimation"></a>
<p>More elegant density plots can be made by <code>density</code>, and we added a
line produced by <code>density</code> in this example.  The bandwidth
<code>bw</code> was chosen by trial-and-error as the default gives too much
smoothing (it usually does for &ldquo;interesting&rdquo; densities).  (Better
automated methods of bandwidth choice are available, and in this example
<code>bw = &quot;SJ&quot;</code> gives a good result.)
</p>

<p>We can plot the empirical cumulative distribution function by using the
function <code>ecdf</code>.
<a name="index-ecdf"></a>
<a name="index-Empirical-CDFs"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; plot(ecdf(eruptions), do.points=FALSE, verticals=TRUE)
</pre></td></tr></table>

<p>This distribution is obviously far from any standard distribution.
How about the right-hand mode, say eruptions of longer than 3 minutes?
Let us fit a normal distribution and overlay the fitted CDF.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; long &lt;- eruptions[eruptions &gt; 3]
&gt; plot(ecdf(long), do.points=FALSE, verticals=TRUE)
&gt; x &lt;- seq(3, 5.4, 0.01)
&gt; lines(x, pnorm(x, mean=mean(long), sd=sqrt(var(long))), lty=3)
</pre></td></tr></table>


<p>Quantile-quantile (Q-Q) plots can help us examine this more carefully.
<a name="index-Quantile_002dquantile-plots"></a>
<a name="index-qqnorm"></a>
<a name="index-qqline"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">par(pty=&quot;s&quot;)       # arrange for a square figure region
qqnorm(long); qqline(long)
</pre></td></tr></table>

<p>which shows a reasonable fit but a shorter right tail than one would
expect from a normal distribution.  Let us compare this with some
simulated data from a <em>t</em> distribution
</p>

<table><tr><td>&nbsp;</td><td><pre class="example">x &lt;- rt(250, df = 5)
qqnorm(x); qqline(x)
</pre></td></tr></table>

<p>which will usually (if it is a random sample) show longer tails than
expected for a normal.  We can make a Q-Q plot against the generating
distribution by
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">qqplot(qt(ppoints(250), df = 5), x, xlab = &quot;Q-Q plot for t dsn&quot;)
qqline(x)
</pre></td></tr></table>

<p>Finally, we might want a more formal test of agreement with normality
(or not).  R provides the Shapiro-Wilk test
<a name="index-Shapiro_002dWilk-test"></a>
<a name="index-shapiro_002etest"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; shapiro.test(long)

         Shapiro-Wilk normality test

data:  long
W = 0.9793, p-value = 0.01052
</pre></td></tr></table>

<p>and the Kolmogorov-Smirnov test
<a name="index-Kolmogorov_002dSmirnov-test"></a>
<a name="index-ks_002etest"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; ks.test(long, &quot;pnorm&quot;, mean = mean(long), sd = sqrt(var(long)))

         One-sample Kolmogorov-Smirnov test

data:  long
D = 0.0661, p-value = 0.4284
alternative hypothesis: two.sided
</pre></td></tr></table>

<p>(Note that the distribution theory is not valid here as we
have estimated the parameters of the normal distribution from the same
sample.)
</p>
<hr size="6">
<a name="One_002d-and-two_002dsample-tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Examining-the-distribution-of-a-set-of-data" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Loops-and-conditional-execution" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Probability-distributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Probability-distributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Loops-and-conditional-execution" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="One_002d-and-two_002dsample-tests-1"></a>
<h2 class="section">8.3 One- and two-sample tests</h2>
<a name="index-One_002d-and-two_002dsample-tests"></a>

<p>So far we have compared a single sample to a normal distribution.  A
much more common operation is to compare aspects of two samples.  Note
that in R, all &ldquo;classical&rdquo; tests including the ones used below are
in package <strong>stats</strong> which is normally loaded.
</p>
<p>Consider the following sets of data on the latent heat of the fusion of
ice (<em>cal/gm</em>) from Rice (1995, p.490)
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">Method A: 79.98 80.04 80.02 80.04 80.03 80.03 80.04 79.97
          80.05 80.03 80.02 80.00 80.02
Method B: 80.02 79.94 79.98 79.97 79.97 80.03 79.95 79.97
</pre></td></tr></table>

<p>Boxplots provide a simple graphical comparison of the two samples.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">A &lt;- scan()
79.98 80.04 80.02 80.04 80.03 80.03 80.04 79.97
80.05 80.03 80.02 80.00 80.02

B &lt;- scan()
80.02 79.94 79.98 79.97 79.97 80.03 79.95 79.97

boxplot(A, B)
</pre></td></tr></table>
<a name="index-boxplot"></a>
<a name="index-Box-plots"></a>

<p>which indicates that the first group tends to give higher results than
the second.
</p>

<p>To test for the equality of the means of the two examples, we can use
an <em>unpaired</em> <em>t</em>-test by
<a name="index-Student_0027s-t-test"></a>
<a name="index-t_002etest"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; t.test(A, B)

         Welch Two Sample t-test

data:  A and B
t = 3.2499, df = 12.027, p-value = 0.00694
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.01385526 0.07018320
sample estimates:
mean of x mean of y
 80.02077  79.97875
</pre></td></tr></table>

<p>which does indicate a significant difference, assuming normality.  By
default the R function does not assume equality of variances in the
two samples (in contrast to the similar <small>S-PLUS</small> <code>t.test</code>
function).  We can use the F test to test for equality in the variances,
provided that the two samples are from normal populations.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; var.test(A, B)

         F test to compare two variances

data:  A and B
F = 0.5837, num df = 12, denom df =  7, p-value = 0.3938
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.1251097 2.1052687
sample estimates:
ratio of variances
         0.5837405
</pre></td></tr></table>
<a name="index-var_002etest"></a>

<p>which shows no evidence of a significant difference, and so we can use
the classical <em>t</em>-test that assumes equality of the variances.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; t.test(A, B, var.equal=TRUE)

         Two Sample t-test

data:  A and B
t = 3.4722, df = 19, p-value = 0.002551
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.01669058 0.06734788
sample estimates:
mean of x mean of y
 80.02077  79.97875
</pre></td></tr></table>

<p>All these tests assume normality of the two samples.  The two-sample
Wilcoxon (or Mann-Whitney) test only assumes a common continuous
distribution under the null hypothesis.
</p>
<a name="index-Wilcoxon-test"></a>
<a name="index-wilcox_002etest"></a>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; wilcox.test(A, B)

         Wilcoxon rank sum test with continuity correction

data:  A and B
W = 89, p-value = 0.007497
alternative hypothesis: true location shift is not equal to 0

Warning message:
Cannot compute exact p-value with ties in: wilcox.test(A, B)
</pre></td></tr></table>

<p>Note the warning: there are several ties in each sample, which suggests
strongly that these data are from a discrete distribution (probably due
to rounding).
</p>
<p>There are several ways to compare graphically the two samples.  We have
already seen a pair of boxplots.  The following
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; plot(ecdf(A), do.points=FALSE, verticals=TRUE, xlim=range(A, B))
&gt; plot(ecdf(B), do.points=FALSE, verticals=TRUE, add=TRUE)
</pre></td></tr></table>

<p>will show the two empirical CDFs, and <code>qqplot</code> will perform a Q-Q
plot of the two samples.  The Kolmogorov-Smirnov test is of the maximal
vertical distance between the two ecdf&rsquo;s, assuming a common continuous
distribution:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; ks.test(A, B)

         Two-sample Kolmogorov-Smirnov test

data:  A and B
D = 0.5962, p-value = 0.05919
alternative hypothesis: two-sided

Warning message:
cannot compute correct p-values with ties in: ks.test(A, B)
</pre></td></tr></table>

<hr size="6">
<a name="Loops-and-conditional-execution"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#One_002d-and-two_002dsample-tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Grouped-expressions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Probability-distributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Grouping_002c-loops-and-conditional-execution"></a>
<h1 class="chapter">9. Grouping, loops and conditional execution</h1>
<a name="index-Loops-and-conditional-execution"></a>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Grouped-expressions">9.1 Grouped expressions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         
</td></tr>
<tr><td align="left" valign="top"><a href="#Control-statements">9.2 Control statements</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          
</td></tr>
</table>

<hr size="6">
<a name="Grouped-expressions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Loops-and-conditional-execution" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Control-statements" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Loops-and-conditional-execution" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Loops-and-conditional-execution" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Grouped-expressions-1"></a>
<h2 class="section">9.1 Grouped expressions</h2>
<a name="index-Grouped-expressions"></a>

<p>R is an expression language in the sense that its only command type
is a function or expression which returns a result.  Even an assignment
is an expression whose result is the value assigned, and it may be used
wherever any expression may be used; in particular multiple assignments
are possible.
</p>
<p>Commands may be grouped together in braces, <code>{<var>expr_1</var>;
<var>&hellip;</var>; <var>expr_m</var>}</code>, in which case the value of the group
is the result of the last expression in the group evaluated.  Since such
a group is also an expression it may, for example, be itself included in
parentheses and used a part of an even larger expression, and so on.
</p>
<hr size="6">
<a name="Control-statements"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Grouped-expressions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Conditional-execution" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Loops-and-conditional-execution" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Loops-and-conditional-execution" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Control-statements-1"></a>
<h2 class="section">9.2 Control statements</h2>
<a name="index-Control-statements"></a>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Conditional-execution">9.2.1 Conditional execution: <code>if</code> statements</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       
</td></tr>
<tr><td align="left" valign="top"><a href="#Repetitive-execution">9.2.2 Repetitive execution: <code>for</code> loops, <code>repeat</code> and <code>while</code></a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        
</td></tr>
</table>

<hr size="6">
<a name="Conditional-execution"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Control-statements" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Repetitive-execution" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Loops-and-conditional-execution" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Control-statements" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Conditional-execution_003a-if-statements"></a>
<h3 class="subsection">9.2.1 Conditional execution: <code>if</code> statements</h3>
<a name="index-if"></a>

<p>The language has available a conditional construction of the form
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; if (<var>expr_1</var>) <var>expr_2</var> else <var>expr_3</var>
</pre></td></tr></table>
<a name="index-if-1"></a>
<a name="index-else"></a>

<p>where <var>expr_1</var> must evaluate to a single logical value and the
result of the entire expression is then evident.
</p>
<a name="index-_0026_0026"></a>
<a name="index-_007c_007c"></a>
<p>The &ldquo;short-circuit&rdquo; operators <code>&amp;&amp;</code> and <code>||</code> are often used
as part of the condition in an <code>if</code> statement.  Whereas <code>&amp;</code>
and <code>|</code> apply element-wise to vectors, <code>&amp;&amp;</code> and <code>||</code>
apply to vectors of length one, and only evaluate their second argument
if necessary.
</p>
<a name="index-ifelse"></a>
<p>There is a vectorized version of the <code>if</code>/<code>else</code> construct,
the <code>ifelse</code> function.  This has the form <code>ifelse(condition, a,
b)</code> and returns a vector of the length of its longest argument, with
elements <code>a[i]</code> if <code>condition[i]</code> is true, otherwise
<code>b[i]</code>.
</p>

<hr size="6">
<a name="Repetitive-execution"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Conditional-execution" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Loops-and-conditional-execution" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Control-statements" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Repetitive-execution_003a-for-loops_002c-repeat-and-while"></a>
<h3 class="subsection">9.2.2 Repetitive execution: <code>for</code> loops, <code>repeat</code> and <code>while</code></h3>
<a name="index-for"></a>

<p>There is also a <code>for</code> loop construction which has the form
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; for (<code><var>name</var></code> in <var>expr_1</var>) <var>expr_2</var>
</pre></td></tr></table>

<p>where <code><var>name</var></code> is the loop variable.  <var>expr_1</var> is a
vector expression, (often a sequence like <code>1:20</code>), and
<var>expr_2</var> is often a grouped expression with its sub-expressions
written in terms of the dummy <em>name</em>.  <var>expr_2</var> is repeatedly
evaluated as <var>name</var> ranges through the values in the vector result
of <var>expr_1</var>.
</p>
<p>As an example, suppose <code>ind</code> is a vector of class indicators and we
wish to produce separate plots of <code>y</code> versus <code>x</code> within
classes.  One possibility here is to use <code>coplot()</code>,<a name="DOCF20" href="#FOOT20">(20)</a>
which will produce an array of plots corresponding to each level of the
factor.  Another way to do this, now putting all plots on the one
display, is as follows:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; xc &lt;- split(x, ind)
&gt; yc &lt;- split(y, ind)
&gt; for (i in 1:length(yc)) {
    plot(xc[[i]], yc[[i]])
    abline(lsfit(xc[[i]], yc[[i]]))
  }
</pre></td></tr></table>

<a name="index-split"></a>

<p>(Note the function <code>split()</code> which produces a list of vectors
obtained by splitting a larger vector according to the classes specified
by a factor.  This is a useful function, mostly used in connection
with boxplots.  See the <code>help</code> facility for further details.)
</p>
<blockquote><p><strong>Warning</strong>: <code>for()</code> loops are used in R code much less
often than in compiled languages.  Code that takes a &lsquo;whole object&rsquo; view
is likely to be both clearer and faster in R.
</p></blockquote>

<p>Other looping facilities include the
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; repeat <var>expr</var>
</pre></td></tr></table>
<a name="index-repeat"></a>

<p>statement and the
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; while (<var>condition</var>) <var>expr</var>
</pre></td></tr></table>
<a name="index-while"></a>

<p>statement.
</p>
<p>The <code>break</code> statement can be used to terminate any loop, possibly
abnormally.  This is the only way to terminate <code>repeat</code> loops.
<a name="index-break"></a>
</p>
<p>The <code>next</code> statement can be used to discontinue one particular
cycle and skip to the &ldquo;next&rdquo;.
<a name="index-next"></a>
</p>
<p>Control statements are most often used in connection with
<em>functions</em> which are discussed in <a href="#Writing-your-own-functions">Writing your own functions</a>, and where more examples will emerge.
</p>

<hr size="6">
<a name="Writing-your-own-functions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Repetitive-execution" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-examples" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Loops-and-conditional-execution" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Writing-your-own-functions-1"></a>
<h1 class="chapter">10. Writing your own functions</h1>
<a name="index-Writing-functions"></a>

<p>As we have seen informally along the way, the R language allows the
user to create objects of mode <em>function</em>.  These are true R
functions that are stored in a special internal form and may be used in
further expressions and so on.  In the process, the language gains
enormously in power, convenience and elegance, and learning to write
useful functions is one of the main ways to make your use of R
comfortable and productive.
</p>
<p>It should be emphasized that most of the functions supplied as part of
the R system, such as <code>mean()</code>, <code>var()</code>,
<code>postscript()</code> and so on, are themselves written in R and thus
do not differ materially from user written functions.
</p>
<p>A function is defined by an assignment of the form
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; <var>name</var> &lt;- function(<var>arg_1</var>, <var>arg_2</var>, &hellip;) <var>expression</var>
</pre></td></tr></table>
<a name="index-function"></a>

<p>The <var>expression</var> is an R expression, (usually a grouped
expression), that uses the arguments, <var>arg_i</var>, to calculate a value.
The value of the expression is the value returned for the function.
</p>
<p>A call to the function then usually takes the form
<code><var>name</var>(<var>expr_1</var>, <var>expr_2</var>, &hellip;)</code> and may occur
anywhere a function call is legitimate.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Simple-examples">10.1 Simple examples</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             
</td></tr>
<tr><td align="left" valign="top"><a href="#Defining-new-binary-operators">10.2 Defining new binary operators</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Named-arguments-and-defaults">10.3 Named arguments and defaults</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#The-three-dots-argument">10.4 The &lsquo;<samp>&hellip;</samp>&rsquo; argument</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     
</td></tr>
<tr><td align="left" valign="top"><a href="#Assignment-within-functions">10.5 Assignments within functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#More-advanced-examples">10.6 More advanced examples</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      
</td></tr>
<tr><td align="left" valign="top"><a href="#Scope">10.7 Scope</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                       
</td></tr>
<tr><td align="left" valign="top"><a href="#Customizing-the-environment">10.8 Customizing the environment</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Object-orientation">10.9 Classes, generic functions and object orientation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          
</td></tr>
</table>

<hr size="6">
<a name="Simple-examples"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Defining-new-binary-operators" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Simple-examples-1"></a>
<h2 class="section">10.1 Simple examples</h2>

<p>As a first example, consider a function to calculate the two sample
<em>t</em>-statistic, showing &ldquo;all the steps&rdquo;.  This is an artificial
example, of course, since there are other, simpler ways of achieving the
same end.
</p>
<p>The function is defined as follows:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; twosam &lt;- function(y1, y2) {
    n1  &lt;- length(y1); n2  &lt;- length(y2)
    yb1 &lt;- mean(y1);   yb2 &lt;- mean(y2)
    s1  &lt;- var(y1);    s2  &lt;- var(y2)
    s &lt;- ((n1-1)*s1 + (n2-1)*s2)/(n1+n2-2)
    tst &lt;- (yb1 - yb2)/sqrt(s*(1/n1 + 1/n2))
    tst
  }
</pre></td></tr></table>

<p>With this function defined, you could perform two sample <em>t</em>-tests
using a call such as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; tstat &lt;- twosam(data$male, data$female); tstat
</pre></td></tr></table>

<p>As a second example, consider a function to emulate directly the
<small>MATLAB</small> backslash command, which returns the coefficients of the
orthogonal projection of the vector <em>y</em> onto the column space of
the matrix, <em>X</em>.  (This is ordinarily called the least squares
estimate of the regression coefficients.)  This would ordinarily be
done with the <code>qr()</code> function; however this is sometimes a bit
tricky to use directly and it pays to have a simple function such as the
following to use it safely.
</p>
<p>Thus given a <em>n</em> by <em>1</em> vector <em>y</em> and an <em>n</em> by
<em>p</em> matrix <em>X</em> then <em>X \ y</em> is defined as
(X&rsquo;X)^{-}X&rsquo;y, where (X&rsquo;X)^{-}
is a generalized inverse of <em>X&rsquo;X</em>.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; bslash &lt;- function(X, y) {
  X &lt;- qr(X)
  qr.coef(X, y)
}
</pre></td></tr></table>

<p>After this object is created it may be used in statements such as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; regcoeff &lt;- bslash(Xmat, yvar)
</pre></td></tr></table>

<p>and so on.
</p>
<p>The classical R function <code>lsfit()</code> does this job quite well, and
more<a name="DOCF21" href="#FOOT21">(21)</a>.  It in turn uses the functions <code>qr()</code> and <code>qr.coef()</code>
in the slightly counterintuitive way above to do this part of the
calculation.  Hence there is probably some value in having just this
part isolated in a simple to use function if it is going to be in
frequent use.  If so, we may wish to make it a matrix binary operator
for even more convenient use.
</p>
<hr size="6">
<a name="Defining-new-binary-operators"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Simple-examples" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Named-arguments-and-defaults" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Defining-new-binary-operators-1"></a>
<h2 class="section">10.2 Defining new binary operators</h2>
<a name="index-Binary-operators"></a>

<p>Had we given the <code>bslash()</code> function a different name, namely one of
the form
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">%<var>anything</var>%
</pre></td></tr></table>

<p>it could have been used as a <em>binary operator</em> in expressions
rather than in function form.  Suppose, for example, we choose <code>!</code>
for the internal character.  The function definition would then start as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; &quot;%!%&quot; &lt;- function(X, y) { &hellip; }
</pre></td></tr></table>

<p>(Note the use of quote marks.)  The function could then be used as
<code>X %!% y</code>.  (The backslash symbol itself is not a convenient choice
as it presents special problems in this context.)
</p>
<p>The matrix multiplication operator, <code>%*%</code>, and the outer product
matrix operator <code>%o%</code> are other examples of binary operators
defined in this way.
</p>
<hr size="6">
<a name="Named-arguments-and-defaults"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Defining-new-binary-operators" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-three-dots-argument" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Named-arguments-and-defaults-1"></a>
<h2 class="section">10.3 Named arguments and defaults</h2>
<a name="index-Named-arguments"></a>
<a name="index-Default-values"></a>

<p>As first noted in <a href="#Generating-regular-sequences">Generating regular sequences</a>, if arguments to
called functions are given in the &ldquo;<code><var>name</var>=<var>object</var></code>&rdquo;
form, they may be given in any order.  Furthermore the argument sequence
may begin in the unnamed, positional form, and specify named arguments
after the positional arguments.
</p>
<p>Thus if there is a function <code>fun1</code> defined by
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; fun1 &lt;- function(data, data.frame, graph, limit) {
    <span class="roman">[function body omitted]</span>
  }
</pre></td></tr></table>

<p>then the function may be invoked in several ways, for example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; ans &lt;- fun1(d, df, TRUE, 20)
&gt; ans &lt;- fun1(d, df, graph=TRUE, limit=20)
&gt; ans &lt;- fun1(data=d, limit=20, graph=TRUE, data.frame=df)
</pre></td></tr></table>

<p>are all equivalent.
</p>
<p>In many cases arguments can be given commonly appropriate default
values, in which case they may be omitted altogether from the call when
the defaults are appropriate.  For example, if <code>fun1</code> were defined
as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; fun1 &lt;- function(data, data.frame, graph=TRUE, limit=20) { &hellip; }
</pre></td></tr></table>

<p>it could be called as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; ans &lt;- fun1(d, df)
</pre></td></tr></table>

<p>which is now equivalent to the three cases above, or as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; ans &lt;- fun1(d, df, limit=10)
</pre></td></tr></table>

<p>which changes one of the defaults.
</p>
<p>It is important to note that defaults may be arbitrary expressions, even
involving other arguments to the same function; they are not restricted
to be constants as in our simple example here.
</p>
<hr size="6">
<a name="The-three-dots-argument"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Named-arguments-and-defaults" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Assignment-within-functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-_2026-argument"></a>
<h2 class="section">10.4 The &lsquo;<samp>&hellip;</samp>&rsquo; argument</h2>


<p>Another frequent requirement is to allow one function to pass on
argument settings to another.  For example many graphics functions use
the function <code>par()</code> and functions like <code>plot()</code> allow the
user to pass on graphical parameters to <code>par()</code> to control the
graphical output.  (See section <a href="#The-par_0028_0029-function">Permanent changes: The <code>par()</code> function</a>, for more details on the
<code>par()</code> function.)  This can be done by including an extra
argument, literally &lsquo;<samp>&hellip;</samp>&rsquo;, of the function, which may then be
passed on.  An outline example is given below.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">fun1 &lt;- function(data, data.frame, graph=TRUE, limit=20, ...) {
  <span class="roman">[omitted statements]</span>
  if (graph)
    par(pch=&quot;*&quot;, ...)
  <span class="roman">[more omissions]</span>
}
</pre></td></tr></table>

<p>Less frequently, a function will need to refer to components of
&lsquo;<samp>&hellip;</samp>&rsquo;.  The expression <code>list(...)</code> evaluates all such
arguments and returns them in a named list, while <code>..1</code>,
<code>..2</code>, etc. evaluate them one at a time, with &lsquo;<samp>..n</samp>&rsquo;
returning the n&rsquo;th unmatched argument.
</p>
<hr size="6">
<a name="Assignment-within-functions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-three-dots-argument" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#More-advanced-examples" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Assignments-within-functions"></a>
<h2 class="section">10.5 Assignments within functions</h2>

<p>Note that <em>any ordinary assignments done within the function are
local and temporary and are lost after exit from the function</em>.  Thus
the assignment <code>X &lt;- qr(X)</code> does not affect the value of the
argument in the calling program.
</p>
<p>To understand completely the rules governing the scope of R assignments
the reader needs to be familiar with the notion of an evaluation
<em>frame</em>.  This is a somewhat advanced, though hardly difficult,
topic and is not covered further here.
</p>
<p>If global and permanent assignments are intended within a function, then
either the &ldquo;superassignment&rdquo; operator, <code>&lt;&lt;-</code> or the function
<code>assign()</code> can be used.  See the <code>help</code> document for details.
<small>S-PLUS</small> users should be aware that <code>&lt;&lt;-</code> has different semantics
in R.  These are discussed further in <a href="#Scope">Scope</a>.
</p>
<hr size="6">
<a name="More-advanced-examples"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Assignment-within-functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Efficiency-factors-in-block-designs" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="More-advanced-examples-1"></a>
<h2 class="section">10.6 More advanced examples</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Efficiency-factors-in-block-designs">10.6.1 Efficiency factors in block designs</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Dropping-all-names-in-a-printed-array">10.6.2 Dropping all names in a printed array</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Recursive-numerical-integration">10.6.3 Recursive numerical integration</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
</table>

<hr size="6">
<a name="Efficiency-factors-in-block-designs"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#More-advanced-examples" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Dropping-all-names-in-a-printed-array" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#More-advanced-examples" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Efficiency-factors-in-block-designs-1"></a>
<h3 class="subsection">10.6.1 Efficiency factors in block designs</h3>

<p>As a more complete, if a little pedestrian, example of a function,
consider finding the efficiency factors for a block design.  (Some
aspects of this problem have already been discussed in <a href="#Index-matrices">Index matrices</a>.)
</p>
<p>A block design is defined by two factors, say <code>blocks</code> (<code>b</code>
levels) and <code>varieties</code> (<code>v</code> levels).  If <em>R</em> and
<em>K</em> are the <em>v</em> by <em>v</em> and <em>b</em> by <em>b</em>
<em>replications</em> and <em>block size</em> matrices, respectively, and
<em>N</em> is the <em>b</em> by <em>v</em> incidence matrix, then the
efficiency factors are defined as the eigenvalues of the matrix
E = I_v - R^{-1/2}N&rsquo;K^{-1}NR^{-1/2} = I_v - A&rsquo;A, where
A = K^{-1/2}NR^{-1/2}.
One way to write the function is given below.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; bdeff &lt;- function(blocks, varieties) {
    blocks &lt;- as.factor(blocks)             # <span class="roman">minor safety move</span>
    b &lt;- length(levels(blocks))
    varieties &lt;- as.factor(varieties)       # <span class="roman">minor safety move</span>
    v &lt;- length(levels(varieties))
    K &lt;- as.vector(table(blocks))           # <span class="roman">remove dim attr</span>
    R &lt;- as.vector(table(varieties))        # <span class="roman">remove dim attr</span>
    N &lt;- table(blocks, varieties)
    A &lt;- 1/sqrt(K) * N * rep(1/sqrt(R), rep(b, v))
    sv &lt;- svd(A)
    list(eff=1 - sv$d^2, blockcv=sv$u, varietycv=sv$v)
}
</pre></td></tr></table>

<p>It is numerically slightly better to work with the singular value
decomposition on this occasion rather than the eigenvalue routines.
</p>
<p>The result of the function is a list giving not only the efficiency
factors as the first component, but also the block and variety canonical
contrasts, since sometimes these give additional useful qualitative
information.
</p>
<hr size="6">
<a name="Dropping-all-names-in-a-printed-array"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Efficiency-factors-in-block-designs" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Recursive-numerical-integration" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#More-advanced-examples" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Dropping-all-names-in-a-printed-array-1"></a>
<h3 class="subsection">10.6.2 Dropping all names in a printed array</h3>

<p>For printing purposes with large matrices or arrays, it is often useful
to print them in close block form without the array names or numbers.
Removing the <code>dimnames</code> attribute will not achieve this effect, but
rather the array must be given a <code>dimnames</code> attribute consisting of
empty strings.  For example to print a matrix, <code>X</code>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; temp &lt;- X
&gt; dimnames(temp) &lt;- list(rep(&quot;&quot;, nrow(X)), rep(&quot;&quot;, ncol(X)))
&gt; temp; rm(temp)
</pre></td></tr></table>

<p>This can be much more conveniently done using a function,
<code>no.dimnames()</code>, shown below, as a &ldquo;wrap around&rdquo; to achieve the
same result.  It also illustrates how some effective and useful user
functions can be quite short.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">no.dimnames &lt;- function(a) {
  ## <span class="roman">Remove all dimension names from an array for compact printing.</span>
  d &lt;- list()
  l &lt;- 0
  for(i in dim(a)) {
    d[[l &lt;- l + 1]] &lt;- rep(&quot;&quot;, i)
  }
  dimnames(a) &lt;- d
  a
}
</pre></td></tr></table>

<p>With this function defined, an array may be printed in close format
using
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; no.dimnames(X)
</pre></td></tr></table>

<p>This is particularly useful for large integer arrays, where patterns are
the real interest rather than the values.
</p>
<hr size="6">
<a name="Recursive-numerical-integration"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Dropping-all-names-in-a-printed-array" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Scope" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#More-advanced-examples" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Recursive-numerical-integration-1"></a>
<h3 class="subsection">10.6.3 Recursive numerical integration</h3>

<p>Functions may be recursive, and may themselves define functions within
themselves.  Note, however, that such functions, or indeed variables,
are not inherited by called functions in higher evaluation frames as
they would be if they were on the search path.
</p>
<p>The example below shows a naive way of performing one-dimensional
numerical integration.  The integrand is evaluated at the end points of
the range and in the middle.  If the one-panel trapezium rule answer is
close enough to the two panel, then the latter is returned as the value.
Otherwise the same process is recursively applied to each panel.  The
result is an adaptive integration process that concentrates function
evaluations in regions where the integrand is farthest from linear.
There is, however, a heavy overhead, and the function is only
competitive with other algorithms when the integrand is both smooth and
very difficult to evaluate.
</p>
<p>The example is also given partly as a little puzzle in R programming.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">area &lt;- function(f, a, b, eps = 1.0e-06, lim = 10) {
  fun1 &lt;- function(f, a, b, fa, fb, a0, eps, lim, fun) {
    ## <span class="roman">function `fun1' is only visible inside `area'</span>
    d &lt;- (a + b)/2
    h &lt;- (b - a)/4
    fd &lt;- f(d)
    a1 &lt;- h * (fa + fd)
    a2 &lt;- h * (fd + fb)
    if(abs(a0 - a1 - a2) &lt; eps || lim == 0)
      return(a1 + a2)
    else {
      return(fun(f, a, d, fa, fd, a1, eps, lim - 1, fun) +
             fun(f, d, b, fd, fb, a2, eps, lim - 1, fun))
    }
  }
  fa &lt;- f(a)
  fb &lt;- f(b)
  a0 &lt;- ((fa + fb) * (b - a))/2
  fun1(f, a, b, fa, fb, a0, eps, lim, fun1)
}
</pre></td></tr></table>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Scope">10.7 Scope</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Object-orientation">10.9 Classes, generic functions and object orientation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Scope"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Recursive-numerical-integration" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Customizing-the-environment" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Scope-1"></a>
<h2 class="section">10.7 Scope</h2>
<a name="index-Scope"></a>

<p>The discussion in this section is somewhat more technical than in other
parts of this document.  However, it details one of the major differences
between <small>S-PLUS</small> and R.
</p>
<p>The symbols which occur in the body of a function can be divided into
three classes; formal parameters, local variables and free variables.
The formal parameters of a function are those occurring in the argument
list of the function.  Their values are determined by the process of
<em>binding</em> the actual function arguments to the formal parameters.
Local variables are those whose values are determined by the evaluation
of expressions in the body of the functions.  Variables which are not
formal parameters or local variables are called free variables.  Free
variables become local variables if they are assigned to.  Consider the
following function definition.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">f &lt;- function(x) {
  y &lt;- 2*x
  print(x)
  print(y)
  print(z)
}
</pre></td></tr></table>

<p>In this function, <code>x</code> is a formal parameter, <code>y</code> is a local
variable and <code>z</code> is a free variable.
</p>
<p>In R the free variable bindings are resolved by first looking in the
environment in which the function was created.  This is called
<em>lexical scope</em>.  First we define a function called <code>cube</code>.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">cube &lt;- function(n) {
  sq &lt;- function() n*n
  n*sq()
}
</pre></td></tr></table>

<p>The variable <code>n</code> in the function <code>sq</code> is not an argument to that
function.  Therefore it is a free variable and the scoping rules must be
used to ascertain the value that is to be associated with it.  Under static
scope (<small>S-PLUS</small>) the value is that associated with a global variable named
<code>n</code>.  Under lexical scope (R) it is the parameter to the function
<code>cube</code> since that is the active binding for the variable <code>n</code> at
the time the function <code>sq</code> was defined.  The difference between
evaluation in R and evaluation in <small>S-PLUS</small> is that <small>S-PLUS</small> looks for a
global variable called <code>n</code> while R first looks for a variable
called <code>n</code> in the environment created when <code>cube</code> was invoked.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">## <span class="roman">first evaluation in S</span>
S&gt; cube(2)
Error in sq(): Object &quot;n&quot; not found
Dumped
S&gt; n &lt;- 3
S&gt; cube(2)
[1] 18
## <span class="roman">then the same function evaluated in R</span>
R&gt; cube(2)
[1] 8
</pre></td></tr></table>

<p>Lexical scope can also be used to give functions <em>mutable state</em>.
In the following example we show how R can be used to mimic a bank
account.  A functioning bank account needs to have a balance or total, a
function for making withdrawals, a function for making deposits and a
function for stating the current balance.  We achieve this by creating
the three functions within <code>account</code> and then returning a list
containing them.  When <code>account</code> is invoked it takes a numerical
argument <code>total</code> and returns a list containing the three functions.
Because these functions are defined in an environment which contains
<code>total</code>, they will have access to its value.
</p>
<p>The special assignment operator, <code>&lt;&lt;-</code>,
<a name="index-_003c_003c_002d"></a>
is used to change the value associated with <code>total</code>.  This operator
looks back in enclosing environments for an environment that contains
the symbol <code>total</code> and when it finds such an environment it
replaces the value, in that environment, with the value of right hand
side.  If the global or top-level environment is reached without finding
the symbol <code>total</code> then that variable is created and assigned to
there.  For most users <code>&lt;&lt;-</code> creates a global variable and assigns
the value of the right hand side to it<a name="DOCF22" href="#FOOT22">(22)</a>.  Only when <code>&lt;&lt;-</code> has
been used in a function that was returned as the value of another
function will the special behavior described here occur.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">open.account &lt;- function(total) {
  list(
    deposit = function(amount) {
      if(amount &lt;= 0)
        stop(&quot;Deposits must be positive!\n&quot;)
      total &lt;&lt;- total + amount
      cat(amount, &quot;deposited.  Your balance is&quot;, total, &quot;\n\n&quot;)
    },
    withdraw = function(amount) {
      if(amount &gt; total)
        stop(&quot;You don't have that much money!\n&quot;)
      total &lt;&lt;- total - amount
      cat(amount, &quot;withdrawn.  Your balance is&quot;, total, &quot;\n\n&quot;)
    },
    balance = function() {
      cat(&quot;Your balance is&quot;, total, &quot;\n\n&quot;)
    }
  )
}

ross &lt;- open.account(100)
robert &lt;- open.account(200)

ross$withdraw(30)
ross$balance()
robert$balance()

ross$deposit(50)
ross$balance()
ross$withdraw(500)
</pre></td></tr></table>

<hr size="6">
<a name="Customizing-the-environment"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Scope" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Object-orientation" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Customizing-the-environment-1"></a>
<h2 class="section">10.8 Customizing the environment</h2>
<a name="index-Customizing-the-environment"></a>

<p>Users can customize their environment in several different ways.  There
is a site initialization file and every directory can have its own
special initialization file.  Finally, the special functions
<code>.First</code> and <code>.Last</code> can be used.
</p>
<p>The location of the site initialization file is taken from the value of
the <code>R_PROFILE</code> environment variable.  If that variable is unset,
the file &lsquo;<tt>Rprofile.site</tt>&rsquo; in the R home subdirectory &lsquo;<tt>etc</tt>&rsquo; is
used.  This file should contain the commands that you want to execute
every time R is started under your system.  A second, personal,
profile file named &lsquo;<tt>.Rprofile</tt>&rsquo;<a name="DOCF23" href="#FOOT23">(23)</a> can be placed in any directory.  If R is invoked in that
directory then that file will be sourced.  This file gives individual
users control over their workspace and allows for different startup
procedures in different working directories.  If no &lsquo;<tt>.Rprofile</tt>&rsquo;
file is found in the startup directory, then R looks for a
&lsquo;<tt>.Rprofile</tt>&rsquo; file in the user&rsquo;s home directory and uses that (if it
exists).  If the environment variable <code>R_PROFILE_USER</code> is set, the
file it points to is used instead of the &lsquo;<tt>.Rprofile</tt>&rsquo; files.
</p>
<p>Any function named <code>.First()</code> in either of the two profile files or
in the &lsquo;<tt>.RData</tt>&rsquo; image has a special status.  It is automatically
performed at the beginning of an R session and may be used to
initialize the environment.  For example, the definition in the example
below alters the prompt to <code>$</code> and sets up various other useful
things that can then be taken for granted in the rest of the session.
</p>
<p>Thus, the sequence in which files are executed is, &lsquo;<tt>Rprofile.site</tt>&rsquo;,
the user profile, &lsquo;<tt>.RData</tt>&rsquo; and then <code>.First()</code>.  A definition
in later files will mask definitions in earlier files.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; .First &lt;- function() {
  options(prompt=&quot;$ &quot;, continue=&quot;+\t&quot;)  # <span class="roman"><code>$</code> is the prompt</span>
  options(digits=5, length=999)         # <span class="roman">custom numbers and printout</span>
  x11()                                 # <span class="roman">for graphics</span>
  par(pch = &quot;+&quot;)                        # <span class="roman">plotting character</span>
  source(file.path(Sys.getenv(&quot;HOME&quot;), &quot;R&quot;, &quot;mystuff.R&quot;))
                                        # <span class="roman">my personal functions</span>
  library(MASS)                         # <span class="roman">attach a package</span>
}
</pre></td></tr></table>
<a name="index-_002eFirst"></a>

<p>Similarly a function <code>.Last()</code>, if defined, is (normally) executed
at the very end of the session.  An example is given below.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; .Last &lt;- function() {
  graphics.off()                        # <span class="roman">a small safety measure.</span>
  cat(paste(date(),&quot;\nAdios\n&quot;))        # <span class="roman">Is it time for lunch?</span>
}
</pre></td></tr></table>
<a name="index-_002eLast"></a>

<hr size="6">
<a name="Object-orientation"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Customizing-the-environment" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Classes_002c-generic-functions-and-object-orientation"></a>
<h2 class="section">10.9 Classes, generic functions and object orientation</h2>
<a name="index-Classes-1"></a>
<a name="index-Generic-functions"></a>
<a name="index-Object-orientation"></a>

<p>The class of an object determines how it will be treated by what are
known as <em>generic</em> functions.  Put the other way round, a generic
function performs a task or action on its arguments <em>specific to
the class of the argument itself</em>.  If the argument lacks any <code>class</code>
attribute, or has a class not catered for specifically by the generic
function in question, there is always a <em>default action</em> provided.
</p>
<p>An example makes things clearer.  The class mechanism offers the user
the facility of designing and writing generic functions for special
purposes.  Among the other generic functions are <code>plot()</code> for
displaying objects graphically, <code>summary()</code> for summarizing
analyses of various types, and <code>anova()</code> for comparing statistical
models.
</p>
<p>The number of generic functions that can treat a class in a specific way
can be quite large.  For example, the functions that can accommodate in
some fashion objects of class <code>&quot;data.frame&quot;</code> include
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">[     [[&lt;-    any    as.matrix
[&lt;-   mean    plot   summary
</pre></td></tr></table>

<a name="index-methods"></a>
<p>A currently complete list can be got by using the <code>methods()</code>
function:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; methods(class=&quot;data.frame&quot;)
</pre></td></tr></table>

<p>Conversely the number of classes a generic function can handle can also
be quite large.  For example the <code>plot()</code> function has a default
method and variants for objects of classes <code>&quot;data.frame&quot;</code>,
<code>&quot;density&quot;</code>, <code>&quot;factor&quot;</code>, and more.  A complete list can be got
again by using the <code>methods()</code> function:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; methods(plot)
</pre></td></tr></table>

<p>For many generic functions the function body is quite short, for example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; coef
function (object, ...)
UseMethod(&quot;coef&quot;)
</pre></td></tr></table>

<p>The presence of <code>UseMethod</code> indicates this is a generic function.
To see what methods are available we can use <code>methods()</code>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; methods(coef)
[1] coef.aov*         coef.Arima*       coef.default*     coef.listof*
[5] coef.nls*         coef.summary.nls*

   Non-visible functions are asterisked
</pre></td></tr></table>

<p>In this example there are six methods, none of which can be seen by
typing its name.  We can read these by either of
</p>
<a name="index-getAnywhere"></a>
<a name="index-getS3method"></a>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; getAnywhere(&quot;coef.aov&quot;)
A single object matching 'coef.aov' was found
It was found in the following places
  registered S3 method for coef from namespace stats
  namespace:stats
with value

function (object, ...)
{
    z &lt;- object$coef
    z[!is.na(z)]
}

&gt; getS3method(&quot;coef&quot;, &quot;aov&quot;)
function (object, ...)
{
    z &lt;- object$coef
    z[!is.na(z)]
}
</pre></td></tr></table>


<p>The reader is referred to the <em>R Language Definition</em> for a more
complete discussion of this mechanism.
</p>

<hr size="6">
<a name="Statistical-models-in-R"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Object-orientation" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Formulae-for-statistical-models" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Writing-your-own-functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Statistical-models-in-R-1"></a>
<h1 class="chapter">11. Statistical models in R</h1>
<a name="index-Statistical-models"></a>

<p>This section presumes the reader has some familiarity with statistical
methodology, in particular with regression analysis and the analysis of
variance.  Later we make some rather more ambitious presumptions, namely
that something is known about generalized linear models and nonlinear
regression.
</p>
<p>The requirements for fitting statistical models are sufficiently well
defined to make it possible to construct general tools that apply in a
broad spectrum of problems.
</p>
<p>R provides an interlocking suite of facilities that make fitting
statistical models very simple.  As we mention in the introduction, the
basic output is minimal, and one needs to ask for the details by calling
extractor functions.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Formulae-for-statistical-models">11.1 Defining statistical models; formulae</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Linear-models">11.2 Linear models</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               
</td></tr>
<tr><td align="left" valign="top"><a href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Analysis-of-variance-and-model-comparison">11.4 Analysis of variance and model comparison</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Updating-fitted-models">11.5 Updating fitted models</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      
</td></tr>
<tr><td align="left" valign="top"><a href="#Generalized-linear-models">11.6 Generalized linear models</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   
</td></tr>
<tr><td align="left" valign="top"><a href="#Nonlinear-least-squares-and-maximum-likelihood-models">11.7 Nonlinear least squares and maximum likelihood models</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">    
</td></tr>
</table>

<hr size="6">
<a name="Formulae-for-statistical-models"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Contrasts" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Defining-statistical-models_003b-formulae"></a>
<h2 class="section">11.1 Defining statistical models; formulae</h2>
<a name="index-Formulae"></a>

<p>The template for a statistical model is a linear regression model with
independent, homoscedastic errors
</p>
<table><tr><td>&nbsp;</td><td><pre class="display">y_i = sum_{j=0}^p beta_j x_{ij} + e_i, &nbsp;&nbsp;&nbsp;&nbsp;i = 1, &hellip;, n,
</pre></td></tr></table>
<p>where the e_i are NID(0, sigma^2).
In matrix terms this would be written
</p>
<table><tr><td>&nbsp;</td><td><pre class="display">y = X &nbsp;beta + e
</pre></td></tr></table>

<p>where the <em>y</em> is the response vector, <em>X</em> is the <em>model
matrix</em> or <em>design matrix</em> and has columns
<em>x_0, x_1, &hellip;, x_p</em>,
the determining variables.  Very often <em>x_0</em>
will be a column of ones defining an <em>intercept</em> term.
</p>
<a name="Examples"></a>
<h4 class="subsubheading">Examples</h4>

<p>Before giving a formal specification, a few examples may usefully set
the picture.
</p>
<p>Suppose <code>y</code>, <code>x</code>, <code>x0</code>, <code>x1</code>, <code>x2</code>, &hellip; are
numeric variables, <code>X</code> is a matrix and <code>A</code>, <code>B</code>,
<code>C</code>, &hellip; are factors.  The following formulae on the left
side below specify statistical models as described on the right.
</p>
<dl compact="compact">
<dt> <code>y ~ x</code></dt>
<dt> <code>y ~ 1 + x</code></dt>
<dd><p>Both imply the same simple linear regression model of <em>y</em> on
<em>x</em>.  The first has an implicit intercept term, and the second an
explicit one.
</p>
</dd>
<dt> <code>y ~ 0 + x</code></dt>
<dt> <code>y ~ -1 + x</code></dt>
<dt> <code>y ~ x - 1</code></dt>
<dd><p>Simple linear regression of <em>y</em> on <em>x</em> through the origin
(that is, without an intercept term).
</p>
</dd>
<dt> <code>log(y) ~ x1 + x2</code></dt>
<dd><p>Multiple regression of the transformed variable,
log(y),
on <em>x1</em> and <em>x2</em> (with an implicit intercept term).
</p>
</dd>
<dt> <code>y ~ poly(x,2)</code></dt>
<dt> <code>y ~ 1 + x + I(x^2)</code></dt>
<dd><p>Polynomial regression of <em>y</em> on <em>x</em> of degree 2.  The first
form uses orthogonal polynomials, and the second uses explicit powers,
as basis.
</p>
</dd>
<dt> <code>y ~ X + poly(x,2)</code></dt>
<dd><p>Multiple regression <em>y</em> with model matrix consisting of the matrix
<em>X</em> as well as polynomial terms in <em>x</em> to degree 2.
</p>
</dd>
<dt> <code>y ~ A</code></dt>
<dd><p>Single classification analysis of variance model of <em>y</em>, with
classes determined by <em>A</em>.
</p>
</dd>
<dt> <code>y ~ A + x</code></dt>
<dd><p>Single classification analysis of covariance model of <em>y</em>, with
classes determined by <em>A</em>, and with covariate <em>x</em>.
</p>
</dd>
<dt> <code>y ~ A*B</code></dt>
<dt> <code>y ~ A + B + A:B</code></dt>
<dt> <code>y ~ B %in% A</code></dt>
<dt> <code>y ~ A/B</code></dt>
<dd><p>Two factor non-additive model of <em>y</em> on <em>A</em> and <em>B</em>.  The
first two specify the same crossed classification and the second two
specify the same nested classification.  In abstract terms all four
specify the same model subspace.
</p>
</dd>
<dt> <code>y ~ (A + B + C)^2</code></dt>
<dt> <code>y ~ A*B*C - A:B:C</code></dt>
<dd><p>Three factor experiment but with a model containing main effects and two
factor interactions only.  Both formulae specify the same model.
</p>
</dd>
<dt> <code>y ~ A * x</code></dt>
<dt> <code>y ~ A/x</code></dt>
<dt> <code>y ~ A/(1 + x) - 1</code></dt>
<dd><p>Separate simple linear regression models of <em>y</em> on <em>x</em> within
the levels of <em>A</em>, with different codings.  The last form produces
explicit estimates of as many different intercepts and slopes as there
are levels in <em>A</em>.
</p>
</dd>
<dt> <code>y ~ A*B + Error(C)</code></dt>
<dd><p>An experiment with two treatment factors, <em>A</em> and <em>B</em>, and
error strata determined by factor <em>C</em>.  For example a split plot
experiment, with whole plots (and hence also subplots), determined by
factor <em>C</em>.
</p></dd>
</dl>

<a name="index-_007e"></a>
<p>The operator <code>~</code> is used to define a <em>model formula</em> in R.
The form, for an ordinary linear model, is
</p>
<table><tr><td>&nbsp;</td><td><pre class="example"><var>response</var> ~ <var>op_1</var> <var>term_1</var> <var>op_2</var> <var>term_2</var> <var>op_3</var> <var>term_3</var> <var>&hellip;</var>
</pre></td></tr></table>

<p>where
</p>
<dl compact="compact">
<dt> <var>response</var></dt>
<dd><p>is a vector or matrix, (or expression evaluating to a vector or matrix)
defining the response variable(s).
</p></dd>
<dt> <var>op_i</var></dt>
<dd><p>is an operator, either <code>+</code> or <code>-</code>, implying the inclusion or
exclusion of a term in the model, (the first is optional).
</p></dd>
<dt> <var>term_i</var></dt>
<dd><p>is either
</p><ul>
<li>
a vector or matrix expression, or <code>1</code>,
</li><li>
a factor, or
</li><li>
a <em>formula expression</em> consisting of factors, vectors or matrices
connected by <em>formula operators</em>.
</li></ul>
<p>In all cases each term defines a collection of columns either to be
added to or removed from the model matrix.  A <code>1</code> stands for an
intercept column and is by default included in the model matrix unless
explicitly removed.
</p>
</dd>
</dl>

<p>The <em>formula operators</em> are similar in effect to the Wilkinson and
Rogers notation used by such programs as Glim and Genstat.  One
inevitable change is that the operator &lsquo;<samp><code>.</code></samp>&rsquo; becomes
&lsquo;<samp><code>:</code></samp>&rsquo; since the period is a valid name character in R.
</p>
<p>The notation is summarized below (based on Chambers &amp; Hastie, 1992,
p.29):
</p>
<dl compact="compact">
<dt> <code><var>Y</var> ~ <var>M</var></code></dt>
<dd><p><var>Y</var> is modeled as <var>M</var>.
</p>
</dd>
<dt> <code><var>M_1</var> + <var>M_2</var></code></dt>
<dd><p>Include <var>M_1</var> and <var>M_2</var>.
</p>
</dd>
<dt> <code><var>M_1</var> - <var>M_2</var></code></dt>
<dd><p>Include <var>M_1</var> leaving out terms of <var>M_2</var>.
</p>
</dd>
<dt> <code><var>M_1</var> : <var>M_2</var></code></dt>
<dd><p>The tensor product of <var>M_1</var> and <var>M_2</var>.  If both terms are
factors, then the &ldquo;subclasses&rdquo; factor.
</p>
</dd>
<dt> <code><var>M_1</var> %in% <var>M_2</var></code></dt>
<dd><p>Similar to <code><var>M_1</var>:<var>M_2</var></code>, but with a different coding.
</p>
</dd>
<dt> <code><var>M_1</var> * <var>M_2</var></code></dt>
<dd><p><code><var>M_1</var> + <var>M_2</var> + <var>M_1</var>:<var>M_2</var></code>.
</p>
</dd>
<dt> <code><var>M_1</var> / <var>M_2</var></code></dt>
<dd><p><code><var>M_1</var> + <var>M_2</var> %in% <var>M_1</var></code>.
</p>
</dd>
<dt> <code><var>M</var>^<var>n</var></code></dt>
<dd><p>All terms in <var>M</var> together with &ldquo;interactions&rdquo; up to order <var>n</var>
</p>
</dd>
<dt> <code>I(<var>M</var>)</code></dt>
<dd><p>Insulate <var>M</var>.  Inside <var>M</var> all operators have their normal
arithmetic meaning, and that term appears in the model matrix.
</p></dd>
</dl>

<p>Note that inside the parentheses that usually enclose function arguments
all operators have their normal arithmetic meaning.  The function
<code>I()</code> is an identity function used to allow terms in model formulae
to be defined using arithmetic operators.
</p>
<p>Note particularly that the model formulae specify the <em>columns
of the model matrix</em>, the specification of the parameters being
implicit.  This is not the case in other contexts, for example in
specifying nonlinear models.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Contrasts">11.1.1 Contrasts</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                   
</td></tr>
</table>

<hr size="6">
<a name="Contrasts"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Formulae-for-statistical-models" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Linear-models" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Formulae-for-statistical-models" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Contrasts-1"></a>
<h3 class="subsection">11.1.1 Contrasts</h3>
<a name="index-Contrasts"></a>

<p>We need at least some idea how the model formulae specify the columns of
the model matrix.  This is easy if we have continuous variables, as each
provides one column of the model matrix (and the intercept will provide
a column of ones if included in the model).
</p>
<a name="index-Factors-1"></a>
<a name="index-Ordered-factors-1"></a>
<p>What about a <em>k</em>-level factor <code>A</code>?  The answer differs for
unordered and ordered factors.  For <em>unordered</em> factors <em>k -
1</em> columns are generated for the indicators of the second, &hellip;,
<em>k</em>th levels of the factor. (Thus the implicit parameterization is
to contrast the response at each level with that at the first.)  For
<em>ordered</em> factors the <em>k - 1</em> columns are the orthogonal
polynomials on <em>1, &hellip;, k</em>, omitting the constant term.
</p>
<p>Although the answer is already complicated, it is not the whole story.
First, if the intercept is omitted in a model that contains a factor
term, the first such term is encoded into <em>k</em> columns giving the
indicators for all the levels.  Second, the whole behavior can be
changed by the <code>options</code> setting for <code>contrasts</code>.  The default
setting in R is
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">options(contrasts = c(&quot;contr.treatment&quot;, &quot;contr.poly&quot;))
</pre></td></tr></table>

<p>The main reason for mentioning this is that R and S have
different defaults for unordered factors, S using Helmert
contrasts.  So if you need to compare your results to those of a textbook
or paper which used <small>S-PLUS</small>, you will need to set
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">options(contrasts = c(&quot;contr.helmert&quot;, &quot;contr.poly&quot;))
</pre></td></tr></table>

<p>This is a deliberate difference, as treatment contrasts (R&rsquo;s default)
are thought easier for newcomers to interpret.
</p>
<p>We have still not finished, as the contrast scheme to be used can be set
for each term in the model using the functions <code>contrasts</code> and
<code>C</code>.
<a name="index-contrasts"></a>
<a name="index-C"></a>
</p>
<p>We have not yet considered interaction terms: these generate the
products of the columns introduced for their component terms.
</p>
<p>Although the details are complicated, model formulae in R will
normally generate the models that an expert statistician would expect,
provided that marginality is preserved.  Fitting, for example, a model
with an interaction but not the corresponding main effects will in
general lead to surprising results, and is for experts only.
</p>

<hr size="6">
<a name="Linear-models"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Contrasts" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Generic-functions-for-extracting-model-information" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Linear-models-1"></a>
<h2 class="section">11.2 Linear models</h2>
<a name="index-Linear-models"></a>

<p>The basic function for fitting ordinary multiple models is <code>lm()</code>,
and a streamlined version of the call is as follows:
<a name="index-lm"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; <var>fitted.model</var> &lt;- lm(<var>formula</var>, data = <var>data.frame</var>)
</pre></td></tr></table>

<p>For example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; fm2 &lt;- lm(y ~ x1 + x2, data = production)
</pre></td></tr></table>

<p>would fit a multiple regression model of <em>y</em> on <em>x1</em> and
<em>x2</em> (with implicit intercept term).
</p>
<p>The important (but technically optional) parameter <code>data =
production</code> specifies that any variables needed to construct the model
should come first from the <code>production</code> <em>data frame</em>.
<em>This is the case regardless of whether data frame
<code>production</code> has been attached on the search path or not</em>.
</p>
<hr size="6">
<a name="Generic-functions-for-extracting-model-information"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Linear-models" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Analysis-of-variance-and-model-comparison" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Generic-functions-for-extracting-model-information-1"></a>
<h2 class="section">11.3 Generic functions for extracting model information</h2>

<p>The value of <code>lm()</code> is a fitted model object; technically a list of
results of class <code>&quot;lm&quot;</code>.  Information about the fitted model can
then be displayed, extracted, plotted and so on by using generic
functions that orient themselves to objects of class <code>&quot;lm&quot;</code>.  These
include
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">add1    deviance   formula      predict  step
alias   drop1      kappa        print    summary
anova   effects    labels       proj     vcov
coef    family     plot         residuals
</pre></td></tr></table>

<p>A brief description of the most commonly used ones is given below.
</p>
<dl compact="compact">
<dd><a name="index-anova"></a>
</dd>
<dt> <code>anova(<var>object_1</var>, <var>object_2</var>)</code></dt>
<dd><p>Compare a submodel with an outer model and produce an analysis of
variance table.
</p>
<a name="index-coefficients"></a>
<a name="index-coef"></a>
</dd>
<dt> <code>coef(<var>object</var>)</code></dt>
<dd><p>Extract the regression coefficient (matrix).
</p>
<p>Long form: <code>coefficients(<var>object</var>)</code>.
</p>
<a name="index-deviance"></a>
</dd>
<dt> <code>deviance(<var>object</var>)</code></dt>
<dd><p>Residual sum of squares, weighted if appropriate.
</p>
<a name="index-formula"></a>
</dd>
<dt> <code>formula(<var>object</var>)</code></dt>
<dd><p>Extract the model formula.
</p>
<a name="index-plot"></a>
</dd>
<dt> <code>plot(<var>object</var>)</code></dt>
<dd><p>Produce four plots, showing residuals, fitted values and some
diagnostics.
</p>
<a name="index-predict"></a>
</dd>
<dt> <code>predict(<var>object</var>, newdata=<var>data.frame</var>)</code></dt>
<dd><p>The data frame supplied must have variables specified with the same
labels as the original.  The value is a vector or matrix of predicted
values corresponding to the determining variable values in
<var>data.frame</var>.
</p>

<a name="index-print"></a>
</dd>
<dt> <code>print(<var>object</var>)</code></dt>
<dd><p>Print a concise version of the object.  Most often used implicitly.
</p>
<a name="index-residuals"></a>
<a name="index-resid"></a>
</dd>
<dt> <code>residuals(<var>object</var>)</code></dt>
<dd><p>Extract the (matrix of) residuals, weighted as appropriate.
</p>
<p>Short form: <code>resid(<var>object</var>)</code>.
</p>
<a name="index-step"></a>
</dd>
<dt> <code>step(<var>object</var>)</code></dt>
<dd><p>Select a suitable model by adding or dropping terms and preserving
hierarchies.  The model with the smallest value of AIC (Akaike&rsquo;s An
Information Criterion) discovered in the stepwise search is returned.
</p>
<a name="index-summary-1"></a>
</dd>
<dt> <code>summary(<var>object</var>)</code></dt>
<dd><p>Print a comprehensive summary of the results of the regression analysis.
</p>
<a name="index-vcov"></a>
</dd>
<dt> <code>vcov(<var>object</var>)</code></dt>
<dd><p>Returns the variance-covariance matrix of the main parameters of a
fitted model object.
</p></dd>
</dl>

<hr size="6">
<a name="Analysis-of-variance-and-model-comparison"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Generic-functions-for-extracting-model-information" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ANOVA-tables" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Analysis-of-variance-and-model-comparison-1"></a>
<h2 class="section">11.4 Analysis of variance and model comparison</h2>
<a name="index-Analysis-of-variance"></a>

<p>The model fitting function <code>aov(<code>formula</code>,
data=<var>data.frame</var>)</code>
<a name="index-aov"></a>
operates at the simplest level in a very similar way to the function
<code>lm()</code>, and most of the generic functions listed in the table in
<a href="#Generic-functions-for-extracting-model-information">Generic functions for extracting model information</a> apply.
</p>
<p>It should be noted that in addition <code>aov()</code> allows an analysis of
models with multiple error strata such as split plot experiments, or
balanced incomplete block designs with recovery of inter-block
information.  The model formula
</p>
<table><tr><td>&nbsp;</td><td><pre class="example"><var>response</var> ~ <var>mean.formula</var> + Error(<var>strata.formula</var>)
</pre></td></tr></table>
<a name="index-Error"></a>

<p>specifies a multi-stratum experiment with error strata defined by the
<var>strata.formula</var>.  In the simplest case, <var>strata.formula</var> is
simply a factor, when it defines a two strata experiment, namely between
and within the levels of the factor.
</p>
<p>For example, with all determining variables factors, a model formula such
as that in:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; fm &lt;- aov(yield ~ v + n*p*k + Error(farms/blocks), data=farm.data)
</pre></td></tr></table>

<p>would typically be used to describe an experiment with mean model
<code>v + n*p*k</code> and three error strata, namely &ldquo;between farms&rdquo;,
&ldquo;within farms, between blocks&rdquo; and &ldquo;within blocks&rdquo;.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#ANOVA-tables">11.4.1 ANOVA tables</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                
</td></tr>
</table>

<hr size="6">
<a name="ANOVA-tables"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Analysis-of-variance-and-model-comparison" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Updating-fitted-models" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Analysis-of-variance-and-model-comparison" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="ANOVA-tables-1"></a>
<h3 class="subsection">11.4.1 ANOVA tables</h3>

<p>Note also that the analysis of variance table (or tables) are for a
sequence of fitted models.  The sums of squares shown are the decrease
in the residual sums of squares resulting from an inclusion of
<em>that term</em> in the model at <em>that place</em> in the sequence.
Hence only for orthogonal experiments will the order of inclusion be
inconsequential.
</p>
<p>For multistratum experiments the procedure is first to project the
response onto the error strata, again in sequence, and to fit the mean
model to each projection.  For further details, see Chambers &amp; Hastie
(1992).
</p>
<p>A more flexible alternative to the default full ANOVA table is to
compare two or more models directly using the <code>anova()</code> function.
<a name="index-anova-1"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; anova(<var>fitted.model.1</var>, <var>fitted.model.2</var>, &hellip;)
</pre></td></tr></table>

<p>The display is then an ANOVA table showing the differences between the
fitted models when fitted in sequence.  The fitted models being compared
would usually be an hierarchical sequence, of course.  This does not
give different information to the default, but rather makes it easier to
comprehend and control.
</p>
<hr size="6">
<a name="Updating-fitted-models"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#ANOVA-tables" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Generalized-linear-models" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Updating-fitted-models-1"></a>
<h2 class="section">11.5 Updating fitted models</h2>
<a name="index-Updating-fitted-models"></a>

<p>The <code>update()</code> function is largely a convenience function that
allows a model to be fitted that differs from one previously fitted
usually by just a few additional or removed terms.  Its form is
<a name="index-update"></a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; <var>new.model</var> &lt;- update(<var>old.model</var>, <var>new.formula</var>)
</pre></td></tr></table>

<p>In the <var>new.formula</var> the special name consisting of a period,
&lsquo;<samp><code>.</code></samp>&rsquo;,
<a name="index-_002e"></a>
only, can be used to stand for &ldquo;the corresponding part of the old model
formula&rdquo;.  For example,
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; fm05 &lt;- lm(y ~ x1 + x2 + x3 + x4 + x5, data = production)
&gt; fm6  &lt;- update(fm05, . ~ . + x6)
&gt; smf6 &lt;- update(fm6, sqrt(.) ~ .)
</pre></td></tr></table>

<p>would fit a five variate multiple regression with variables (presumably)
from the data frame <code>production</code>, fit an additional model including
a sixth regressor variable, and fit a variant on the model where the
response had a square root transform applied.
</p>
<p>Note especially that if the <code>data=</code> argument is specified on the
original call to the model fitting function, this information is passed on
through the fitted model object to <code>update()</code> and its allies.
</p>
<p>The name &lsquo;<samp>.</samp>&rsquo; can also be used in other contexts, but with slightly
different meaning.  For example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; fmfull &lt;- lm(y ~ . , data = production)
</pre></td></tr></table>

<p>would fit a model with response <code>y</code> and regressor variables
<em>all other variables in the data frame <code>production</code></em>.
</p>
<p>Other functions for exploring incremental sequences of models are
<code>add1()</code>, <code>drop1()</code> and <code>step()</code>.
<a name="index-add1"></a>
<a name="index-drop1"></a>
<a name="index-step-1"></a>
The names of these give a good clue to their purpose, but for full
details see the on-line help.
</p>
<hr size="6">
<a name="Generalized-linear-models"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Updating-fitted-models" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Families" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Generalized-linear-models-1"></a>
<h2 class="section">11.6 Generalized linear models</h2>
<a name="index-Generalized-linear-models"></a>

<p>Generalized linear modeling is a development of linear models to
accommodate both non-normal response distributions and transformations
to linearity in a clean and straightforward way.  A generalized linear
model may be described in terms of the following sequence of
assumptions:
</p>
<ul>
<li>
There is a response, <em>y</em>, of interest and stimulus variables
x_1, x_2, &hellip;,
whose values influence the distribution of the response.

</li><li>
The stimulus variables influence the distribution of <em>y</em> through
<em>a single linear function, only</em>.  This linear function is called
the <em>linear predictor</em>, and is usually written
<table><tr><td>&nbsp;</td><td><pre class="display">eta = beta_1 x_1 + beta_2 x_2 + &hellip; + beta_p x_p,
</pre></td></tr></table>
<p>hence x_i has no influence on the distribution of <em>y</em> if and only if
beta_i is zero.
</p>
</li><li>
The distribution of <em>y</em> is of the form
<table><tr><td>&nbsp;</td><td><pre class="display">f_Y(y; mu, phi)
  = exp((A/phi) * (y lambda(mu) - gamma(lambda(mu))) + tau(y, phi))
</pre></td></tr></table>
<p>where phi is a <em>scale parameter</em> (possibly known), and is constant
for all observations, <em>A</em> represents a prior weight, assumed known
but possibly varying with the observations, and $\mu$ is the mean of
<em>y</em>.
So it is assumed that the distribution of <em>y</em> is determined by its
mean and possibly a scale parameter as well.
</p>
</li><li>
The mean, mu, is a smooth invertible function of the linear predictor:
<table><tr><td>&nbsp;</td><td><pre class="display">mu = m(eta),    eta = m^{-1}(mu) = ell(mu)
</pre></td></tr></table>
<p>and this inverse function, ell(), is called the <em>link function</em>.
</p>
</li></ul>

<p>These assumptions are loose enough to encompass a wide class of models
useful in statistical practice, but tight enough to allow the
development of a unified methodology of estimation and inference, at
least approximately.  The reader is referred to any of the current
reference works on the subject for full details, such as McCullagh &amp;
Nelder (1989) or Dobson (1990).
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Families">11.6.1 Families</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    
</td></tr>
<tr><td align="left" valign="top"><a href="#The-glm_0028_0029-function">11.6.2 The <code>glm()</code> function</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          
</td></tr>
</table>

<hr size="6">
<a name="Families"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Generalized-linear-models" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-glm_0028_0029-function" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Generalized-linear-models" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Families-1"></a>
<h3 class="subsection">11.6.1 Families</h3>
<a name="index-Families"></a>

<p>The class of generalized linear models handled by facilities supplied in
R includes <em>gaussian</em>, <em>binomial</em>, <em>poisson</em>,
<em>inverse gaussian</em> and <em>gamma</em> response distributions and also
<em>quasi-likelihood</em> models where the response distribution is not
explicitly specified.  In the latter case the <em>variance function</em>
must be specified as a function of the mean, but in other cases this
function is implied by the response distribution.
</p>
<p>Each response distribution admits a variety of link functions to connect
the mean with the linear predictor.  Those automatically available are
shown in the following table:
</p>
<blockquote><table>
<thead><tr><th width="25%">Family name</th><th width="55%">Link functions</th></tr></thead>
<tr><td width="25%"><code>binomial</code></td><td width="55%"><code>logit</code>, <code>probit</code>, <code>log</code>, <code>cloglog</code></td></tr>
<tr><td width="25%"><code>gaussian</code></td><td width="55%"><code>identity</code>, <code>log</code>, <code>inverse</code></td></tr>
<tr><td width="25%"><code>Gamma</code></td><td width="55%"><code>identity</code>, <code>inverse</code>, <code>log</code></td></tr>
<tr><td width="25%"><code>inverse.gaussian</code></td><td width="55%"><code>1/mu^2</code>, <code>identity</code>, <code>inverse</code>, <code>log</code></td></tr>
<tr><td width="25%"><code>poisson</code></td><td width="55%"><code>identity</code>, <code>log</code>, <code>sqrt</code></td></tr>
<tr><td width="25%"><code>quasi</code></td><td width="55%"><code>logit</code>, <code>probit</code>, <code>cloglog</code>,
<code>identity</code>, <code>inverse</code>, <code>log</code>, <code>1/mu^2</code>, <code>sqrt</code></td></tr>
</table>
</blockquote>

<p>The combination of a response distribution, a link function and various
other pieces of information that are needed to carry out the modeling
exercise is called the <em>family</em> of the generalized linear model.
</p>
<hr size="6">
<a name="The-glm_0028_0029-function"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Families" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Nonlinear-least-squares-and-maximum-likelihood-models" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Generalized-linear-models" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-glm_0028_0029-function-1"></a>
<h3 class="subsection">11.6.2 The <code>glm()</code> function</h3>
<a name="index-glm"></a>

<p>Since the distribution of the response depends on the stimulus variables
through a single linear function <em>only</em>, the same mechanism as was
used for linear models can still be used to specify the linear part of a
generalized model.  The family has to be specified in a different way.
</p>
<p>The R function to fit a generalized linear model is <code>glm()</code>
which uses the form
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; <var>fitted.model</var> &lt;- glm(<var>formula</var>, family=<var>family.generator</var>, data=<var>data.frame</var>)
</pre></td></tr></table>

<p>The only new feature is the <var>family.generator</var>, which is the
instrument by which the family is described.  It is the name of a
function that generates a list of functions and expressions that
together define and control the model and estimation process.  Although
this may seem a little complicated at first sight, its use is quite
simple.
</p>
<p>The names of the standard, supplied family generators are given under
&ldquo;Family Name&rdquo; in the table in <a href="#Families">Families</a>.  Where there is a choice
of links, the name of the link may also be supplied with the family
name, in parentheses as a parameter.  In the case of the <code>quasi</code>
family, the variance function may also be specified in this way.
</p>
<p>Some examples make the process clear.
</p>
<a name="The-gaussian-family"></a>
<h4 class="subsubheading">The <code>gaussian</code> family</h4>

<p>A call such as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; fm &lt;- glm(y ~ x1 + x2, family = gaussian, data = sales)
</pre></td></tr></table>

<p>achieves the same result as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; fm &lt;- lm(y ~ x1+x2, data=sales)
</pre></td></tr></table>

<p>but much less efficiently.  Note how the gaussian family is not
automatically provided with a choice of links, so no parameter is
allowed.  If a problem requires a gaussian family with a nonstandard
link, this can usually be achieved through the <code>quasi</code> family, as
we shall see later.
</p>
<a name="The-binomial-family"></a>
<h4 class="subsubheading">The <code>binomial</code> family</h4>

<p>Consider a small, artificial example, from Silvey (1970).
</p>
<p>On the Aegean island of Kalythos the male inhabitants suffer from a
congenital eye disease, the effects of which become more marked with
increasing age.  Samples of islander males of various ages were tested
for blindness and the results recorded.  The data is shown below:
</p>
<table>
<tr><td>Age:</td><td>20</td><td>35</td><td>45</td><td>55</td><td>70</td></tr>
<tr><td>No. tested:</td><td>50</td><td>50</td><td>50</td><td>50</td><td>50</td></tr>
<tr><td>No. blind:</td><td>6</td><td>17</td><td>26</td><td>37</td><td>44</td></tr>
</table>

<p>The problem we consider is to fit both logistic and probit models to
this data, and to estimate for each model the LD50, that is the age at
which the chance of blindness for a male inhabitant is 50%.
</p>
<p>If <em>y</em> is the number of blind at age <em>x</em> and <em>n</em> the
number tested, both models have the form
y ~ B(n, F(beta_0 + beta_1 x))
where for the probit case,
F(z) = Phi(z)is the standard normal distribution function, and in the logit case
(the default),
F(z) = e^z/(1+e^z).
In both cases the LD50 is
LD50 = - beta_0/beta_1
that is, the point at which the argument of the distribution function is
zero.
</p>
<p>The first step is to set the data up as a data frame
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; kalythos &lt;- data.frame(x = c(20,35,45,55,70), n = rep(50,5),
                         y = c(6,17,26,37,44))
</pre></td></tr></table>

<p>To fit a binomial model using <code>glm()</code> there are three possibilities
for the response:
</p>
<ul>
<li>
If the response is a <em>vector</em> it is assumed to hold <em>binary</em>
data, and so must be a <em>0/1</em> vector.

</li><li>
If the response is a <em>two-column matrix</em> it is assumed that the
first column holds the number of successes for the trial and the second
holds the number of failures.

</li><li>
If the response is a <em>factor</em>, its first level is taken as failure
(0) and all other levels as &lsquo;success&rsquo; (1).
</li></ul>

<p>Here we need the second of these conventions, so we add a matrix to our
data frame:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; kalythos$Ymat &lt;- cbind(kalythos$y, kalythos$n - kalythos$y)
</pre></td></tr></table>

<p>To fit the models we use
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; fmp &lt;- glm(Ymat ~ x, family = binomial(link=probit), data = kalythos)
&gt; fml &lt;- glm(Ymat ~ x, family = binomial, data = kalythos)
</pre></td></tr></table>

<p>Since the logit link is the default the parameter may be omitted on the
second call.  To see the results of each fit we could use
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; summary(fmp)
&gt; summary(fml)
</pre></td></tr></table>

<p>Both models fit (all too) well.  To find the LD50 estimate we can use a
simple function:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; ld50 &lt;- function(b) -b[1]/b[2]
&gt; ldp &lt;- ld50(coef(fmp)); ldl &lt;- ld50(coef(fml)); c(ldp, ldl)
</pre></td></tr></table>

<p>The actual estimates from this data are 43.663 years and 43.601 years
respectively.
</p>
<a name="Poisson-models"></a>
<h4 class="subsubheading">Poisson models</h4>

<p>With the Poisson family the default link is the <code>log</code>, and in
practice the major use of this family is to fit surrogate Poisson
log-linear models to frequency data, whose actual distribution is often
multinomial.  This is a large and important subject we will not discuss
further here.  It even forms a major part of the use of non-gaussian
generalized models overall.
</p>
<p>Occasionally genuinely Poisson data arises in practice and in the past
it was often analyzed as gaussian data after either a log or a
square-root transformation.  As a graceful alternative to the latter, a
Poisson generalized linear model may be fitted as in the following
example:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; fmod &lt;- glm(y ~ A + B + x, family = poisson(link=sqrt),
              data = worm.counts)
</pre></td></tr></table>

<a name="Quasi_002dlikelihood-models"></a>
<h4 class="subsubheading">Quasi-likelihood models</h4>

<p>For all families the variance of the response will depend on the mean
and will have the scale parameter as a multiplier.  The form of
dependence of the variance on the mean is a characteristic of the
response distribution; for example for the poisson distribution
Var(y) = mu.
</p>
<p>For quasi-likelihood estimation and inference the precise response
distribution is not specified, but rather only a link function and the
form of the variance function as it depends on the mean.  Since
quasi-likelihood estimation uses formally identical techniques to those
for the gaussian distribution, this family provides a way of fitting
gaussian models with non-standard link functions or variance functions,
incidentally.
</p>
<p>For example, consider fitting the non-linear regression
y = theta_1 z_1 / (z_2 - theta_2) + e
which may be written alternatively as
y = 1 / (beta_1 x_1 + beta_2 x_2) + e
where
x_1 = z_2/z_1, x_2 = -1/z_1, beta_1 = 1/theta_1, and beta_2 =
theta_2/theta_1.
Supposing a suitable data frame to be set up we could fit this
non-linear regression as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; nlfit &lt;- glm(y ~ x1 + x2 - 1,
               family = quasi(link=inverse, variance=constant),
               data = biochem)
</pre></td></tr></table>

<p>The reader is referred to the manual and the help document for further
information, as needed.
</p>
<hr size="6">
<a name="Nonlinear-least-squares-and-maximum-likelihood-models"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-glm_0028_0029-function" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Least-squares" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Nonlinear-least-squares-and-maximum-likelihood-models-1"></a>
<h2 class="section">11.7 Nonlinear least squares and maximum likelihood models</h2>
<a name="index-Nonlinear-least-squares"></a>

<p>Certain forms of nonlinear model can be fitted by Generalized Linear
Models (<code>glm()</code>).  But in the majority of cases we have to approach
the nonlinear curve fitting problem as one of nonlinear optimization.
R&rsquo;s nonlinear optimization routines are <code>optim()</code>, <code>nlm()</code>
and (from R 2.2.0) <code>nlminb()</code>,
<a name="index-nlm"></a>
<a name="index-optim"></a>
<a name="index-nlminb"></a>
which provide the functionality (and more) of <small>S-PLUS</small>&rsquo;s <code>ms()</code> and
<code>nlminb()</code>.  We seek the parameter values that minimize some index
of lack-of-fit, and they do this by trying out various parameter values
iteratively.  Unlike linear regression for example, there is no
guarantee that the procedure will converge on satisfactory estimates.
All the methods require initial guesses about what parameter values to
try, and convergence may depend critically upon the quality of the
starting values.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Least-squares">11.7.1 Least squares</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               
</td></tr>
<tr><td align="left" valign="top"><a href="#Maximum-likelihood">11.7.2 Maximum likelihood</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          
</td></tr>
</table>

<hr size="6">
<a name="Least-squares"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Nonlinear-least-squares-and-maximum-likelihood-models" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Maximum-likelihood" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Nonlinear-least-squares-and-maximum-likelihood-models" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Least-squares-1"></a>
<h3 class="subsection">11.7.1 Least squares</h3>

<p>One way to fit a nonlinear model is by minimizing the sum of the squared
errors (SSE) or residuals.  This method makes sense if the observed
errors could have plausibly arisen from a normal distribution.
</p>
<p>Here is an example from Bates &amp; Watts (1988), page 51.  The data are:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; x &lt;- c(0.02, 0.02, 0.06, 0.06, 0.11, 0.11, 0.22, 0.22, 0.56, 0.56,
         1.10, 1.10)
&gt; y &lt;- c(76, 47, 97, 107, 123, 139, 159, 152, 191, 201, 207, 200)
</pre></td></tr></table>

<p>The fit criterion to be minimized is:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; fn &lt;- function(p) sum((y - (p[1] * x)/(p[2] + x))^2)
</pre></td></tr></table>

<p>In order to do the fit we need initial estimates of the parameters.  One
way to find sensible starting values is to plot the data, guess some
parameter values, and superimpose the model curve using those values.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; plot(x, y)
&gt; xfit &lt;- seq(.02, 1.1, .05)
&gt; yfit &lt;- 200 * xfit/(0.1 + xfit)
&gt; lines(spline(xfit, yfit))
</pre></td></tr></table>

<p>We could do better, but these starting values of 200 and 0.1 seem
adequate.  Now do the fit:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; out &lt;- nlm(fn, p = c(200, 0.1), hessian = TRUE)
</pre></td></tr></table>
<a name="index-nlm-1"></a>

<p>After the fitting, <code>out$minimum</code> is the SSE, and
<code>out$estimate</code> are the least squares estimates of the parameters.
To obtain the approximate standard errors (SE) of the estimates we do:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; sqrt(diag(2*out$minimum/(length(y) - 2) * solve(out$hessian)))
</pre></td></tr></table>

<p>The 2 in the line above represents the number of parameters.  A 95%
confidence interval would be the parameter estimate +/- 1.96
SE.  We can superimpose the least squares fit on a new plot:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; plot(x, y)
&gt; xfit &lt;- seq(.02, 1.1, .05)
&gt; yfit &lt;- 212.68384222 * xfit/(0.06412146 + xfit)
&gt; lines(spline(xfit, yfit))
</pre></td></tr></table>

<p>The standard package <strong>stats</strong> provides much more extensive facilities
for fitting non-linear models by least squares.  The model we have just
fitted is the Michaelis-Menten model, so we can use
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; df &lt;- data.frame(x=x, y=y)
&gt; fit &lt;- nls(y ~ SSmicmen(x, Vm, K), df)
&gt; fit
Nonlinear regression model
  model:  y ~ SSmicmen(x, Vm, K)
   data:  df
          Vm            K
212.68370711   0.06412123
 residual sum-of-squares:  1195.449
&gt; summary(fit)

Formula: y ~ SSmicmen(x, Vm, K)

Parameters:
    Estimate Std. Error t value Pr(&gt;|t|)
Vm 2.127e+02  6.947e+00  30.615 3.24e-11
K  6.412e-02  8.281e-03   7.743 1.57e-05

Residual standard error: 10.93 on 10 degrees of freedom

Correlation of Parameter Estimates:
      Vm
K 0.7651
</pre></td></tr></table>

<hr size="6">
<a name="Maximum-likelihood"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Least-squares" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Some-non_002dstandard-models" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Nonlinear-least-squares-and-maximum-likelihood-models" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Maximum-likelihood-1"></a>
<h3 class="subsection">11.7.2 Maximum likelihood</h3>
<a name="index-Maximum-likelihood"></a>

<p>Maximum likelihood is a method of nonlinear model fitting that applies
even if the errors are not normal.  The method finds the parameter values
which maximize the log likelihood, or equivalently which minimize the
negative log-likelihood.  Here is an example from Dobson (1990), pp.
108&ndash;111.  This example fits a logistic model to dose-response data,
which clearly could also be fit by <code>glm()</code>.  The data are:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; x &lt;- c(1.6907, 1.7242, 1.7552, 1.7842, 1.8113,
         1.8369, 1.8610, 1.8839)
&gt; y &lt;- c( 6, 13, 18, 28, 52, 53, 61, 60)
&gt; n &lt;- c(59, 60, 62, 56, 63, 59, 62, 60)
</pre></td></tr></table>

<p>The negative log-likelihood to minimize is:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; fn &lt;- function(p)
   sum( - (y*(p[1]+p[2]*x) - n*log(1+exp(p[1]+p[2]*x))
           + log(choose(n, y)) ))
</pre></td></tr></table>

<p>We pick sensible starting values and do the fit:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; out &lt;- nlm(fn, p = c(-50,20), hessian = TRUE)
</pre></td></tr></table>
<a name="index-nlm-2"></a>

<p>After the fitting, <code>out$minimum</code> is the negative log-likelihood,
and <code>out$estimate</code> are the maximum likelihood estimates of the
parameters.  To obtain the approximate SEs of the estimates we do:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; sqrt(diag(solve(out$hessian)))
</pre></td></tr></table>

<p>A 95% confidence interval would be the parameter estimate +/-1.96 SE.
</p>
<hr size="6">
<a name="Some-non_002dstandard-models"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Maximum-likelihood" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Some-non_002dstandard-models-1"></a>
<h2 class="section">11.8 Some non-standard models</h2>

<p>We conclude this chapter with just a brief mention of some of the other
facilities available in R for special regression and data analysis
problems.
</p>
<ul>
<li>
<a name="index-Mixed-models"></a>
<strong>Mixed models.</strong>  The recommended <a href="http://CRAN.R-project.org/package=nlme"><strong>nlme</strong></a> package provides
functions <code>lme()</code> and <code>nlme()</code>
<a name="index-lme"></a>
<a name="index-nlme"></a>
for linear and non-linear mixed-effects models, that is linear and
non-linear regressions in which some of the coefficients correspond to
random effects.  These functions make heavy use of formulae to specify
the models.

</li><li>
<a name="index-Local-approximating-regressions"></a>
<strong>Local approximating regressions.</strong>  The <code>loess()</code>
<a name="index-loess"></a>
function fits a nonparametric regression by using a locally weighted
regression.  Such regressions are useful for highlighting a trend in
messy data or for data reduction to give some insight into a large data
set.

<p>Function <code>loess</code> is in the standard package <strong>stats</strong>, together
with code for projection pursuit regression.
<a name="index-loess-1"></a>
</p>
</li><li>
<a name="index-Robust-regression"></a>
<strong>Robust regression.</strong> There are several functions available for
fitting regression models in a way resistant to the influence of extreme
outliers in the data.  Function <code>lqs</code>
<a name="index-lqs"></a>
in the recommended package <a href="http://CRAN.R-project.org/package=MASS"><strong>MASS</strong></a> provides state-of-art algorithms
for highly-resistant fits.  Less resistant but statistically more
efficient methods are available in packages, for example function
<code>rlm</code>
<a name="index-rlm"></a>
in package <a href="http://CRAN.R-project.org/package=MASS"><strong>MASS</strong></a>.

</li><li>
<a name="index-Additive-models"></a>
<strong>Additive models.</strong> This technique aims to construct a regression
function from smooth additive functions of the determining variables,
usually one for each determining variable.  Functions <code>avas</code> and
<code>ace</code>
<a name="index-avas"></a>
<a name="index-ace"></a>
in package <a href="http://CRAN.R-project.org/package=acepack"><strong>acepack</strong></a> and functions <code>bruto</code> and <code>mars</code>
<a name="index-bruto"></a>
<a name="index-mars"></a>
in package <a href="http://CRAN.R-project.org/package=mda"><strong>mda</strong></a> provide some examples of these techniques in
user-contributed packages to R.  An extension is <strong>Generalized
Additive Models</strong>, implemented in user-contributed packages <a href="http://CRAN.R-project.org/package=gam"><strong>gam</strong></a> and
<a href="http://CRAN.R-project.org/package=mgcv"><strong>mgcv</strong></a>.

</li><li>
<a name="index-Tree_002dbased-models"></a>
<strong>Tree-based models.</strong> Rather than seek an explicit global linear
model for prediction or interpretation, tree-based models seek to
bifurcate the data, recursively, at critical points of the determining
variables in order to partition the data ultimately into groups that are
as homogeneous as possible within, and as heterogeneous as possible
between.  The results often lead to insights that other data analysis
methods tend not to yield.

<p>Models are again specified in the ordinary linear model form.  The model
fitting function is <code>tree()</code>,
<a name="index-tree"></a>
but many other generic functions such as <code>plot()</code> and <code>text()</code>
are well adapted to displaying the results of a tree-based model fit in
a graphical way.
</p>
<p>Tree models are available in R <em>via</em> the user-contributed
packages <a href="http://CRAN.R-project.org/package=rpart"><strong>rpart</strong></a> and <a href="http://CRAN.R-project.org/package=tree"><strong>tree</strong></a>.
</p>
</li></ul>

<hr size="6">
<a name="Graphics"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Some-non_002dstandard-models" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#High_002dlevel-plotting-commands" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Statistical-models-in-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Graphical-procedures"></a>
<h1 class="chapter">12. Graphical procedures</h1>

<p>Graphical facilities are an important and extremely versatile component
of the R environment.  It is possible to use the facilities to
display a wide variety of statistical graphs and also to build entirely
new types of graph.
</p>
<p>The graphics facilities can be used in both interactive and batch modes, but in
most cases, interactive use is more productive.  Interactive use is also
easy because at startup time R initiates a graphics <em>device
driver</em> which opens a special <em>graphics window</em> for the display of
interactive graphics.  Although this is done automatically, it is useful
to know that the command used is <code>X11()</code> under UNIX,
<code>windows()</code> under Windows and <code>quartz()</code> under Mac OS X.
</p>
<p>Once the device driver is running, R plotting commands can be used to
produce a variety of graphical displays and to create entirely new kinds
of display.
</p>
<p>Plotting commands are divided into three basic groups:
</p>
<ul>
<li>
<strong>High-level</strong> plotting functions create a new plot on the graphics
device, possibly with axes, labels, titles and so on.
</li><li>
<strong>Low-level</strong> plotting functions add more information to an
existing plot, such as extra points, lines and labels.
</li><li>
<strong>Interactive</strong> graphics functions allow you interactively add
information to, or extract information from, an existing plot, using a
pointing device such as a mouse.
</li></ul>

<p>In addition, R maintains a list of <em>graphical parameters</em> which
can be manipulated to customize your plots.
</p>
<p>This manual only describes what are known as &lsquo;base&rsquo; graphics.  A
separate graphics sub-system in package <strong>grid</strong> coexists with base &ndash;
it is more powerful but harder to use.  There is a recommended package
<a href="http://CRAN.R-project.org/package=lattice"><strong>lattice</strong></a> which builds on <strong>grid</strong> and provides ways to produce
multi-panel plots akin to those in the <em>Trellis</em> system in S.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#High_002dlevel-plotting-commands">12.1 High-level plotting commands</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Low_002dlevel-plotting-commands">12.2 Low-level plotting commands</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Interacting-with-graphics">12.3 Interacting with graphics</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   
</td></tr>
<tr><td align="left" valign="top"><a href="#Using-graphics-parameters">12.4 Using graphics parameters</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   
</td></tr>
<tr><td align="left" valign="top"><a href="#Graphics-parameters">12.5 Graphics parameters list</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         
</td></tr>
<tr><td align="left" valign="top"><a href="#Device-drivers">12.6 Device drivers</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              
</td></tr>
<tr><td align="left" valign="top"><a href="#Dynamic-graphics">12.7 Dynamic graphics</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            
</td></tr>
</table>

<hr size="6">
<a name="High_002dlevel-plotting-commands"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Graphics" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-plot_0028_0029-function" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="High_002dlevel-plotting-commands-1"></a>
<h2 class="section">12.1 High-level plotting commands</h2>

<p>High-level plotting functions are designed to generate a complete plot
of the data passed as arguments to the function.  Where appropriate,
axes, labels and titles are automatically generated (unless you request
otherwise.) High-level plotting commands always start a new plot,
erasing the current plot if necessary.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#The-plot_0028_0029-function">12.1.1 The <code>plot()</code> function</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         
</td></tr>
<tr><td align="left" valign="top"><a href="#Displaying-multivariate-data">12.1.2 Displaying multivariate data</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Display-graphics">12.1.3 Display graphics</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            
</td></tr>
<tr><td align="left" valign="top"><a href="#Arguments-to-high_002dlevel-plotting-functions">12.1.4 Arguments to high-level plotting functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
</table>

<hr size="6">
<a name="The-plot_0028_0029-function"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#High_002dlevel-plotting-commands" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Displaying-multivariate-data" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#High_002dlevel-plotting-commands" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-plot_0028_0029-function-1"></a>
<h3 class="subsection">12.1.1 The <code>plot()</code> function</h3>
<a name="index-plot-1"></a>

<p>One of the most frequently used plotting functions in R is the
<code>plot()</code> function.  This is a <em>generic</em> function: the type of
plot produced is dependent on the type or <em>class</em> of the first
argument.
</p>
<dl compact="compact">
<dt> <code>plot(<var>x</var>, <var>y</var>)</code></dt>
<dt> <code>plot(<var>xy</var>)</code></dt>
<dd><p>If <var>x</var> and <var>y</var> are vectors, <code>plot(<var>x</var>, <var>y</var>)</code>
produces a scatterplot of <var>y</var> against <var>x</var>.  The same effect can
be produced by supplying one argument (second form) as either a list
containing two elements <var>x</var> and <var>y</var> or a two-column matrix.
</p>
</dd>
<dt> <code>plot(<var>x</var>)</code></dt>
<dd><p>If <var>x</var> is a time series, this produces a time-series plot. If
<var>x</var> is a numeric vector, it produces a plot of the values in the
vector against their index in the vector.  If <var>x</var> is a complex
vector, it produces a plot of imaginary versus real parts of the vector
elements.
</p>
</dd>
<dt> <code>plot(<var>f</var>)</code></dt>
<dt> <code>plot(<var>f</var>, <var>y</var>)</code></dt>
<dd><p><var>f</var> is a factor object, <var>y</var> is a numeric vector.  The first form
generates a bar plot of <var>f</var>; the second form produces boxplots of
<var>y</var> for each level of <var>f</var>.
</p>
</dd>
<dt> <code>plot(<var>df</var>)</code></dt>
<dt> <code>plot(~ <var>expr</var>)</code></dt>
<dt> <code>plot(<var>y</var> ~ <var>expr</var>)</code></dt>
<dd><p><var>df</var> is a data frame, <var>y</var> is any object, <var>expr</var> is a list
of object names separated by &lsquo;<code>+</code>&rsquo; (e.g., <code>a + b + c</code>).  The
first two forms produce distributional plots of the variables in a data
frame (first form) or of a number of named objects (second form).  The
third form plots <var>y</var> against every object named in <var>expr</var>.
</p></dd>
</dl>

<hr size="6">
<a name="Displaying-multivariate-data"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-plot_0028_0029-function" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Display-graphics" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#High_002dlevel-plotting-commands" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Displaying-multivariate-data-1"></a>
<h3 class="subsection">12.1.2 Displaying multivariate data</h3>

<p>R provides two very useful functions for representing multivariate
data.  If <code>X</code> is a numeric matrix or data frame, the command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; pairs(X)
</pre></td></tr></table>
<a name="index-pairs"></a>

<p>produces a pairwise scatterplot matrix of the variables defined by the
columns of <code>X</code>, that is, every column of <code>X</code> is plotted
against every other column of <code>X</code> and the resulting <em>n(n-1)</em>
plots are arranged in a matrix with plot scales constant over the rows
and columns of the matrix.
</p>
<p>When three or four variables are involved a <em>coplot</em> may be more
enlightening.  If <code>a</code> and <code>b</code> are numeric vectors and <code>c</code>
is a numeric vector or factor object (all of the same length), then
the command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; coplot(a ~ b | c)
</pre></td></tr></table>
<a name="index-coplot"></a>

<p>produces a number of scatterplots of <code>a</code> against <code>b</code> for given
values of <code>c</code>.  If <code>c</code> is a factor, this simply means that
<code>a</code> is plotted against <code>b</code> for every level of <code>c</code>.  When
<code>c</code> is numeric, it is divided into a number of <em>conditioning
intervals</em> and for each interval <code>a</code> is plotted against <code>b</code>
for values of <code>c</code> within the interval.  The number and position of
intervals can be controlled with <code>given.values=</code> argument to
<code>coplot()</code>&mdash;the function <code>co.intervals()</code> is useful for
selecting intervals.  You can also use two <em>given</em> variables with a
command like
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; coplot(a ~ b | c + d)
</pre></td></tr></table>

<p>which produces scatterplots of <code>a</code> against <code>b</code> for every joint
conditioning interval of <code>c</code> and <code>d</code>.
</p>
<p>The <code>coplot()</code> and <code>pairs()</code> function both take an argument
<code>panel=</code> which can be used to customize the type of plot which
appears in each panel.  The default is <code>points()</code> to produce a
scatterplot but by supplying some other low-level graphics function of
two vectors <code>x</code> and <code>y</code> as the value of <code>panel=</code> you can
produce any type of plot you wish.  An example panel function useful for
coplots is <code>panel.smooth()</code>.
</p>
<hr size="6">
<a name="Display-graphics"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Displaying-multivariate-data" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Arguments-to-high_002dlevel-plotting-functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#High_002dlevel-plotting-commands" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Display-graphics-1"></a>
<h3 class="subsection">12.1.3 Display graphics</h3>

<p>Other high-level graphics functions produce different types of plots.
Some examples are:
</p>
<dl compact="compact">
<dt> <code>qqnorm(x)</code></dt>
<dt> <code>qqline(x)</code></dt>
<dt> <code>qqplot(x, y)</code></dt>
<dd><a name="index-qqnorm-1"></a>
<a name="index-qqline-1"></a>
<a name="index-qqplot"></a>
<p>Distribution-comparison plots.  The first form plots the numeric vector
<code>x</code> against the expected Normal order scores (a normal scores plot)
and the second adds a straight line to such a plot by drawing a line
through the distribution and data quartiles.  The third form plots the
quantiles of <code>x</code> against those of <code>y</code> to compare their
respective distributions.
</p>
</dd>
<dt> <code>hist(x)</code></dt>
<dt> <code>hist(x, nclass=<var>n</var>)</code></dt>
<dt> <code>hist(x, breaks=<var>b</var>, &hellip;)</code></dt>
<dd><a name="index-hist-1"></a>
<p>Produces a histogram of the numeric vector <code>x</code>.  A sensible number
of classes is usually chosen, but a recommendation can be given with the
<code>nclass=</code> argument.  Alternatively, the breakpoints can be
specified exactly with the <code>breaks=</code> argument.  If the
<code>probability=TRUE</code> argument is given, the bars represent relative
frequencies divided by bin width instead of counts.
</p>
</dd>
<dt> <code>dotchart(x, &hellip;)</code></dt>
<dd><a name="index-dotchart"></a>
<p>Constructs a dotchart of the data in <code>x</code>.  In a dotchart the
<em>y</em>-axis gives a labelling of the data in <code>x</code> and the
<em>x</em>-axis gives its value.  For example it allows easy visual
selection of all data entries with values lying in specified ranges.
</p>
</dd>
<dt> <code>image(x, y, z, &hellip;)</code></dt>
<dt> <code>contour(x, y, z, &hellip;)</code></dt>
<dt> <code>persp(x, y, z, &hellip;)</code></dt>
<dd><a name="index-image"></a>
<a name="index-contour"></a>
<a name="index-persp"></a>
<p>Plots of three variables.  The <code>image</code> plot draws a grid of rectangles
using different colours to represent the value of <code>z</code>, the <code>contour</code>
plot draws contour lines to represent the value of <code>z</code>, and the
<code>persp</code> plot draws a 3D surface.
</p></dd>
</dl>

<hr size="6">
<a name="Arguments-to-high_002dlevel-plotting-functions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Display-graphics" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Low_002dlevel-plotting-commands" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#High_002dlevel-plotting-commands" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Arguments-to-high_002dlevel-plotting-functions-1"></a>
<h3 class="subsection">12.1.4 Arguments to high-level plotting functions</h3>

<p>There are a number of arguments which may be passed to high-level
graphics functions, as follows:
</p>
<dl compact="compact">
<dt> <code>add=TRUE</code></dt>
<dd><p>Forces the function to act as a low-level graphics function,
superimposing the plot on the current plot (some functions only).
</p>
</dd>
<dt> <code>axes=FALSE</code></dt>
<dd><p>Suppresses generation of axes&mdash;useful for adding your own custom axes
with the <code>axis()</code> function.  The default, <code>axes=TRUE</code>, means
include axes.
</p>
</dd>
<dt> <code>log=&quot;x&quot;</code></dt>
<dt> <code>log=&quot;y&quot;</code></dt>
<dt> <code>log=&quot;xy&quot;</code></dt>
<dd><p>Causes the <em>x</em>, <em>y</em> or both axes to be logarithmic.  This will
work for many, but not all, types of plot.
</p>
</dd>
<dt> <code>type=</code></dt>
<dd><p>The <code>type=</code> argument controls the type of plot produced, as
follows:
</p>
<dl compact="compact">
<dt> <code>type=&quot;p&quot;</code></dt>
<dd><p>Plot individual points (the default)
</p></dd>
<dt> <code>type=&quot;l&quot;</code></dt>
<dd><p>Plot lines
</p></dd>
<dt> <code>type=&quot;b&quot;</code></dt>
<dd><p>Plot points connected by lines (<em>both</em>)
</p></dd>
<dt> <code>type=&quot;o&quot;</code></dt>
<dd><p>Plot points overlaid by lines
</p></dd>
<dt> <code>type=&quot;h&quot;</code></dt>
<dd><p>Plot vertical lines from points to the zero axis (<em>high-density</em>)
</p></dd>
<dt> <code>type=&quot;s&quot;</code></dt>
<dt> <code>type=&quot;S&quot;</code></dt>
<dd><p>Step-function plots.  In the first form, the top of the vertical defines
the point; in the second, the bottom.
</p></dd>
<dt> <code>type=&quot;n&quot;</code></dt>
<dd><p>No plotting at all.  However axes are still drawn (by default) and the
coordinate system is set up according to the data.  Ideal for creating
plots with subsequent low-level graphics functions.
</p></dd>
</dl>

</dd>
<dt> <code>xlab=<var>string</var></code></dt>
<dt> <code>ylab=<var>string</var></code></dt>
<dd><p>Axis labels for the <em>x</em> and <em>y</em> axes.  Use these arguments to
change the default labels, usually the names of the objects used in the
call to the high-level plotting function.
</p>
</dd>
<dt> <code>main=<var>string</var></code></dt>
<dd><p>Figure title, placed at the top of the plot in a large font.
</p>
</dd>
<dt> <code>sub=<var>string</var></code></dt>
<dd><p>Sub-title, placed just below the <em>x</em>-axis in a smaller font.
</p></dd>
</dl>

<hr size="6">
<a name="Low_002dlevel-plotting-commands"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Arguments-to-high_002dlevel-plotting-functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Mathematical-annotation" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Low_002dlevel-plotting-commands-1"></a>
<h2 class="section">12.2 Low-level plotting commands</h2>

<p>Sometimes the high-level plotting functions don&rsquo;t produce exactly the
kind of plot you desire.  In this case, low-level plotting commands can
be used to add extra information (such as points, lines or text) to the
current plot.
</p>
<p>Some of the more useful low-level plotting functions are:
</p>
<dl compact="compact">
<dt> <code>points(x, y)</code></dt>
<dt> <code>lines(x, y)</code></dt>
<dd><a name="index-points"></a>
<a name="index-lines"></a>
<p>Adds points or connected lines to the current plot.  <code>plot()</code>&rsquo;s
<code>type=</code> argument can also be passed to these functions (and
defaults to <code>&quot;p&quot;</code> for <code>points()</code> and <code>&quot;l&quot;</code> for
<code>lines()</code>.)
</p>
</dd>
<dt> <code>text(x, y, labels, &hellip;)</code></dt>
<dd><a name="index-text"></a>
<p>Add text to a plot at points given by <code>x, y</code>.  Normally
<code>labels</code> is an integer or character vector in which case
<code>labels[i]</code> is plotted at point <code>(x[i], y[i])</code>.  The default
is <code>1:length(x)</code>.
</p>
<p><strong>Note</strong>: This function is often used in the sequence
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; plot(x, y, type=&quot;n&quot;); text(x, y, names)
</pre></td></tr></table>

<p>The graphics parameter <code>type=&quot;n&quot;</code> suppresses the points but sets up
the axes, and the <code>text()</code> function supplies special characters, as
specified by the character vector <code>names</code> for the points.
</p>
</dd>
<dt> <code>abline(a, b)</code></dt>
<dt> <code>abline(h=<var>y</var>)</code></dt>
<dt> <code>abline(v=<var>x</var>)</code></dt>
<dt> <code>abline(<var>lm.obj</var>)</code></dt>
<dd><a name="index-abline"></a>
<p>Adds a line of slope <code>b</code> and intercept <code>a</code> to the current
plot.  <code>h=<var>y</var></code> may be used to specify <em>y</em>-coordinates for
the heights of horizontal lines to go across a plot, and
<code>v=<var>x</var></code> similarly for the <em>x</em>-coordinates for vertical
lines.  Also <var>lm.obj</var> may be list with a <code>coefficients</code>
component of length 2 (such as the result of model-fitting functions,)
which are taken as an intercept and slope, in that order.
</p>
</dd>
<dt> <code>polygon(x, y, &hellip;)</code></dt>
<dd><a name="index-polygon"></a>
<p>Draws a polygon defined by the ordered vertices in (<code>x</code>, <code>y</code>)
and (optionally) shade it in with hatch lines, or fill it if the
graphics device allows the filling of figures.
</p>
</dd>
<dt> <code>legend(x, y, legend, &hellip;)</code></dt>
<dd><a name="index-legend"></a>
<p>Adds a legend to the current plot at the specified position.  Plotting
characters, line styles, colors etc., are identified with the labels in
the character vector <code>legend</code>.  At least one other argument <var>v</var>
(a vector the same length as <code>legend</code>) with the corresponding
values of the plotting unit must also be given, as follows:
</p>
<dl compact="compact">
<dt> <code>legend( , fill=<var>v</var>)</code></dt>
<dd><p>Colors for filled boxes
</p></dd>
<dt> <code>legend( , col=<var>v</var>)</code></dt>
<dd><p>Colors in which points or lines will be drawn
</p></dd>
<dt> <code>legend( , lty=<var>v</var>)</code></dt>
<dd><p>Line styles
</p></dd>
<dt> <code>legend( , lwd=<var>v</var>)</code></dt>
<dd><p>Line widths
</p></dd>
<dt> <code>legend( , pch=<var>v</var>)</code></dt>
<dd><p>Plotting characters (character vector)
</p></dd>
</dl>

</dd>
<dt> <code>title(main, sub)</code></dt>
<dd><a name="index-title"></a>
<p>Adds a title <code>main</code> to the top of the current plot in a large font
and (optionally) a sub-title <code>sub</code> at the bottom in a smaller font.
</p>
</dd>
<dt> <code>axis(side, &hellip;)</code></dt>
<dd><a name="index-axis"></a>
<p>Adds an axis to the current plot on the side given by the first argument
(1 to 4, counting clockwise from the bottom.)  Other arguments control
the positioning of the axis within or beside the plot, and tick
positions and labels.  Useful for adding custom axes after calling
<code>plot()</code> with the <code>axes=FALSE</code> argument.
</p></dd>
</dl>

<p>Low-level plotting functions usually require some positioning
information (e.g., <em>x</em> and <em>y</em> coordinates) to determine where
to place the new plot elements.  Coordinates are given in terms of
<em>user coordinates</em> which are defined by the previous high-level
graphics command and are chosen based on the supplied data.
</p>
<p>Where <code>x</code> and <code>y</code> arguments are required, it is also
sufficient to supply a single argument being a list with elements named
<code>x</code> and <code>y</code>.  Similarly a matrix with two columns is also
valid input.  In this way functions such as <code>locator()</code> (see below)
may be used to specify positions on a plot interactively.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Mathematical-annotation">12.2.1 Mathematical annotation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     
</td></tr>
<tr><td align="left" valign="top"><a href="#Hershey-vector-fonts">12.2.2 Hershey vector fonts</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        
</td></tr>
</table>

<hr size="6">
<a name="Mathematical-annotation"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Low_002dlevel-plotting-commands" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Hershey-vector-fonts" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Low_002dlevel-plotting-commands" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Mathematical-annotation-1"></a>
<h3 class="subsection">12.2.1 Mathematical annotation</h3>

<p>In some cases, it is useful to add mathematical symbols and formulae to a
plot.  This can be achieved in R by specifying an <em>expression</em> rather
than a character string in any one of <code>text</code>, <code>mtext</code>, <code>axis</code>,
or <code>title</code>.   For example, the following code draws the formula for
the Binomial probability function:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; text(x, y, expression(paste(bgroup(&quot;(&quot;, atop(n, x), &quot;)&quot;), p^x, q^{n-x})))
</pre></td></tr></table>

<p>More information, including a full listing of the features available can
obtained from within R using the commands:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; help(plotmath)
&gt; example(plotmath)
&gt; demo(plotmath)
</pre></td></tr></table>

<hr size="6">
<a name="Hershey-vector-fonts"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Mathematical-annotation" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Interacting-with-graphics" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Low_002dlevel-plotting-commands" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Hershey-vector-fonts-1"></a>
<h3 class="subsection">12.2.2 Hershey vector fonts</h3>

<p>It is possible to specify Hershey vector fonts for rendering text when using
the <code>text</code> and <code>contour</code> functions.  There are three reasons for
using the Hershey fonts:
</p><ul>
<li>
Hershey fonts can produce better
output, especially on a computer screen, for rotated and/or small text.
</li><li>
Hershey fonts
provide certain symbols that may not be available
in the standard fonts.  In particular, there are zodiac signs, cartographic
symbols and astronomical symbols.
</li><li>
Hershey fonts provide cyrillic and japanese (Kana and Kanji) characters.
</li></ul>

<p>More information, including tables of Hershey characters can be obtained from
within R using the commands:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; help(Hershey)
&gt; demo(Hershey)
&gt; help(Japanese)
&gt; demo(Japanese)
</pre></td></tr></table>

<hr size="6">
<a name="Interacting-with-graphics"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Hershey-vector-fonts" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Using-graphics-parameters" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Interacting-with-graphics-1"></a>
<h2 class="section">12.3 Interacting with graphics</h2>

<p>R also provides functions which allow users to extract or add
information to a plot using a mouse.  The simplest of these is the
<code>locator()</code> function:
</p>
<dl compact="compact">
<dt> <code>locator(n, type)</code></dt>
<dd><a name="index-locator"></a>
<p>Waits for the user to select locations on the current plot using the
left mouse button.  This continues until <code>n</code> (default 512) points
have been selected, or another mouse button is pressed.  The
<code>type</code> argument allows for plotting at the selected points and has
the same effect as for high-level graphics commands; the default is no
plotting.  <code>locator()</code> returns the locations of the points selected
as a list with two components <code>x</code> and <code>y</code>.
</p></dd>
</dl>

<p><code>locator()</code> is usually called with no arguments.  It is
particularly useful for interactively selecting positions for graphic
elements such as legends or labels when it is difficult to calculate in
advance where the graphic should be placed.  For example, to place some
informative text near an outlying point, the command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; text(locator(1), &quot;Outlier&quot;, adj=0)
</pre></td></tr></table>

<p>may be useful.  (<code>locator()</code> will be ignored if the current device,
such as <code>postscript</code> does not support interactive pointing.)
</p>
<dl compact="compact">
<dt> <code>identify(x, y, labels)</code></dt>
<dd><a name="index-identify"></a>
<p>Allow the user to highlight any of the points defined by <code>x</code> and
<code>y</code> (using the left mouse button) by plotting the corresponding
component of <code>labels</code> nearby (or the index number of the point if
<code>labels</code> is absent).  Returns the indices of the selected points
when another button is pressed.
</p></dd>
</dl>

<p>Sometimes we want to identify particular <em>points</em> on a plot, rather
than their positions.  For example, we may wish the user to select some
observation of interest from a graphical display and then manipulate
that observation in some way.  Given a number of <em>(x, y)</em>
coordinates in two numeric vectors <code>x</code> and <code>y</code>, we could use
the <code>identify()</code> function as follows:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; plot(x, y)
&gt; identify(x, y)
</pre></td></tr></table>

<p>The <code>identify()</code> functions performs no plotting itself, but simply
allows the user to move the mouse pointer and click the left mouse
button near a point.  If there is a point near the mouse pointer it will
be marked with its index number (that is, its position in the
<code>x</code>/<code>y</code> vectors) plotted nearby.  Alternatively, you could use
some informative string (such as a case name) as a highlight by using
the <code>labels</code> argument to <code>identify()</code>, or disable marking
altogether with the <code>plot = FALSE</code> argument.  When the process is
terminated (see above), <code>identify()</code> returns the indices of the
selected points; you can use these indices to extract the selected
points from the original vectors <code>x</code> and <code>y</code>.
</p>
<hr size="6">
<a name="Using-graphics-parameters"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Interacting-with-graphics" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-par_0028_0029-function" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Using-graphics-parameters-1"></a>
<h2 class="section">12.4 Using graphics parameters</h2>

<p>When creating graphics, particularly for presentation or publication
purposes, R&rsquo;s defaults do not always produce exactly that which is
required.  You can, however, customize almost every aspect of the
display using <em>graphics parameters</em>.  R maintains a list of a
large number of graphics parameters which control things such as line
style, colors, figure arrangement and text justification among many
others.  Every graphics parameter has a name (such as &lsquo;<code>col</code>&rsquo;,
which controls colors,) and a value (a color number, for example.)
</p>
<p>A separate list of graphics parameters is maintained for each active
device, and each device has a default set of parameters when
initialized.  Graphics parameters can be set in two ways: either
permanently, affecting all graphics functions which access the current
device; or temporarily, affecting only a single graphics function call.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#The-par_0028_0029-function">12.4.1 Permanent changes: The <code>par()</code> function</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          
</td></tr>
<tr><td align="left" valign="top"><a href="#Arguments-to-graphics-functions">12.4.2 Temporary changes: Arguments to graphics functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
</table>

<hr size="6">
<a name="The-par_0028_0029-function"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Using-graphics-parameters" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Arguments-to-graphics-functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Using-graphics-parameters" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Permanent-changes_003a-The-par_0028_0029-function"></a>
<h3 class="subsection">12.4.1 Permanent changes: The <code>par()</code> function</h3>
<a name="index-par"></a>
<a name="index-Graphics-parameters"></a>

<p>The <code>par()</code> function is used to access and modify the list of
graphics parameters for the current graphics device.
</p>
<dl compact="compact">
<dt> <code>par()</code></dt>
<dd><p>Without arguments, returns a list of all graphics parameters and their
values for the current device.
</p></dd>
<dt> <code>par(c(&quot;col&quot;, &quot;lty&quot;))</code></dt>
<dd><p>With a character vector argument, returns only the named graphics
parameters (again, as a list.)
</p></dd>
<dt> <code>par(col=4, lty=2)</code></dt>
<dd><p>With named arguments (or a single list argument), sets the values of
the named graphics parameters, and returns the original values of the
parameters as a list.
</p></dd>
</dl>

<p>Setting graphics parameters with the <code>par()</code> function changes the
value of the parameters <em>permanently</em>, in the sense that all future
calls to graphics functions (on the current device) will be affected by
the new value.  You can think of setting graphics parameters in this way
as setting &ldquo;default&rdquo; values for the parameters, which will be used by
all graphics functions unless an alternative value is given.
</p>
<p>Note that calls to <code>par()</code> <em>always</em> affect the global values
of graphics parameters, even when <code>par()</code> is called from within a
function.  This is often undesirable behavior&mdash;usually we want to set
some graphics parameters, do some plotting, and then restore the
original values so as not to affect the user&rsquo;s R session.  You can
restore the initial values by saving the result of <code>par()</code> when
making changes, and restoring the initial values when plotting is
complete.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; oldpar &lt;- par(col=4, lty=2)
  <span class="roman">&hellip; plotting commands &hellip;</span>
&gt; par(oldpar)
</pre></td></tr></table>

<p>To save and restore <em>all</em> settable<a name="DOCF24" href="#FOOT24">(24)</a> graphical parameters use
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; oldpar &lt;- par(no.readonly=TRUE)
  <span class="roman">&hellip; plotting commands &hellip;</span>
&gt; par(oldpar)
</pre></td></tr></table>


<hr size="6">
<a name="Arguments-to-graphics-functions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-par_0028_0029-function" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics-parameters" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Using-graphics-parameters" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Temporary-changes_003a-Arguments-to-graphics-functions"></a>
<h3 class="subsection">12.4.2 Temporary changes: Arguments to graphics functions</h3>

<p>Graphics parameters may also be passed to (almost) any graphics function
as named arguments.  This has the same effect as passing the arguments
to the <code>par()</code> function, except that the changes only last for the
duration of the function call.  For example:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; plot(x, y, pch=&quot;+&quot;)
</pre></td></tr></table>

<p>produces a scatterplot using a plus sign as the plotting character,
without changing the default plotting character for future plots.
</p>
<p>Unfortunately, this is not implemented entirely consistently and it is
sometimes necessary to set and reset graphics parameters using
<code>par()</code>.
</p>

<hr size="6">
<a name="Graphics-parameters"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Arguments-to-graphics-functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Graphical-elements" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Graphics-parameters-list"></a>
<h2 class="section">12.5 Graphics parameters list</h2>

<p>The following sections detail many of the commonly-used graphical
parameters.  The R help documentation for the <code>par()</code> function
provides a more concise summary; this is provided as a somewhat more
detailed alternative.
</p>
<p>Graphics parameters will be presented in the following form:
</p>
<dl compact="compact">
<dt> <code><var>name</var>=<var>value</var></code></dt>
<dd><p>A description of the parameter&rsquo;s effect.  <var>name</var> is the name of the
parameter, that is, the argument name to use in calls to <code>par()</code> or
a graphics function.  <var>value</var> is a typical value you might use when
setting the parameter.
</p></dd>
</dl>

<p>Note that <code>axes</code> is <strong>not</strong> a graphics parameter but an
argument to a few <code>plot</code> methods: see <code>xaxt</code> and <code>yaxt</code>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Graphical-elements">12.5.1 Graphical elements</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          
</td></tr>
<tr><td align="left" valign="top"><a href="#Axes-and-tick-marks">12.5.2 Axes and tick marks</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         
</td></tr>
<tr><td align="left" valign="top"><a href="#Figure-margins">12.5.3 Figure margins</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              
</td></tr>
<tr><td align="left" valign="top"><a href="#Multiple-figure-environment">12.5.4 Multiple figure environment</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
</table>

<hr size="6">
<a name="Graphical-elements"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Graphics-parameters" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Axes-and-tick-marks" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics-parameters" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Graphical-elements-1"></a>
<h3 class="subsection">12.5.1 Graphical elements</h3>

<p>R plots are made up of points, lines, text and polygons (filled
regions.) Graphical parameters exist which control how these
<em>graphical elements</em> are drawn, as follows:
</p>
<dl compact="compact">
<dt> <code>pch=&quot;+&quot;</code></dt>
<dd><p>Character to be used for plotting points.  The default varies with
graphics drivers, but it is usually
a circle.
Plotted points tend to appear slightly above or below the appropriate
position unless you use <code>&quot;.&quot;</code> as the plotting character, which
produces centered points.
</p>
</dd>
<dt> <code>pch=4</code></dt>
<dd><p>When <code>pch</code> is given as an integer between 0 and 25 inclusive, a
specialized plotting symbol is produced.  To see what the symbols are,
use the command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; legend(locator(1), as.character(0:25), pch = 0:25)
</pre></td></tr></table>

<p>Those from 21 to 25 may appear to duplicate earlier symbols, but can be
coloured in different ways: see the help on <code>points</code> and its
examples.
</p>
<p>In addition, <code>pch</code> can be a character or a number in the range
<code>32:255</code> representing a character in the current font.
</p>
</dd>
<dt> <code>lty=2</code></dt>
<dd><p>Line types.  Alternative line styles are not supported on all graphics
devices (and vary on those that do) but line type 1 is always a solid
line, line type 0 is always invisible, and line types 2 and onwards are
dotted or dashed lines, or some combination of both.
</p>
</dd>
<dt> <code>lwd=2</code></dt>
<dd><p>Line widths.  Desired width of lines, in multiples of the &ldquo;standard&rdquo;
line width.  Affects axis lines as well as lines drawn with
<code>lines()</code>, etc.  Not all devices support this, and some have
restrictions on the widths that can be used.
</p>
</dd>
<dt> <code>col=2</code></dt>
<dd><p>Colors to be used for points, lines, text, filled regions and images.
A number from the current palette (see <code>?palette</code>) or a named colour.
</p>
</dd>
<dt> <code>col.axis</code></dt>
<dt> <code>col.lab</code></dt>
<dt> <code>col.main</code></dt>
<dt> <code>col.sub</code></dt>
<dd><p>The color to be used for axis annotation, <em>x</em> and <em>y</em> labels,
main and sub-titles, respectively.
</p>
</dd>
<dt> <code>font=2</code></dt>
<dd><p>An integer which specifies which font to use for text.  If possible,
device drivers arrange so that <code>1</code> corresponds to plain text,
<code>2</code> to bold face, <code>3</code> to italic, <code>4</code> to bold italic
and <code>5</code> to a symbol font (which include Greek letters).
</p>
</dd>
<dt> <code>font.axis</code></dt>
<dt> <code>font.lab</code></dt>
<dt> <code>font.main</code></dt>
<dt> <code>font.sub</code></dt>
<dd><p>The font to be used for axis annotation, <em>x</em> and <em>y</em> labels,
main and sub-titles, respectively.
</p>
</dd>
<dt> <code>adj=-0.1</code></dt>
<dd><p>Justification of text relative to the plotting position.  <code>0</code> means
left justify, <code>1</code> means right justify and <code>0.5</code> means to
center horizontally about the plotting position.  The actual value is
the proportion of text that appears to the left of the plotting
position, so a value of <code>-0.1</code> leaves a gap of 10% of the text width
between the text and the plotting position.
</p>
</dd>
<dt> <code>cex=1.5</code></dt>
<dd><p>Character expansion.  The value is the desired size of text characters
(including plotting characters) relative to the default text size.
</p>
</dd>
<dt> <code>cex.axis</code></dt>
<dt> <code>cex.lab</code></dt>
<dt> <code>cex.main</code></dt>
<dt> <code>cex.sub</code></dt>
<dd><p>The character expansion to be used for axis annotation, <em>x</em> and
<em>y</em> labels, main and sub-titles, respectively.
</p></dd>
</dl>

<hr size="6">
<a name="Axes-and-tick-marks"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Graphical-elements" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Figure-margins" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics-parameters" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Axes-and-tick-marks-1"></a>
<h3 class="subsection">12.5.2 Axes and tick marks</h3>

<p>Many of R&rsquo;s high-level plots have axes, and you can construct axes
yourself with the low-level <code>axis()</code> graphics function.  Axes have
three main components: the <em>axis line</em> (line style controlled by the
<code>lty</code> graphics parameter), the <em>tick marks</em> (which mark off unit
divisions along the axis line) and the <em>tick labels</em> (which mark the
units.) These components can be customized with the following graphics
parameters.
</p>
<dl compact="compact">
<dt> <code>lab=c(5, 7, 12)</code></dt>
<dd><p>The first two numbers are the desired number of tick intervals on the
<em>x</em> and <em>y</em> axes respectively.  The third number is the
desired length of axis labels, in characters (including the decimal
point.)  Choosing a too-small value for this parameter may result in all
tick labels being rounded to the same number!
</p>
</dd>
<dt> <code>las=1</code></dt>
<dd><p>Orientation of axis labels.  <code>0</code> means always parallel to axis,
<code>1</code> means always horizontal, and <code>2</code> means always
perpendicular to the axis.
</p>
</dd>
<dt> <code>mgp=c(3, 1, 0)</code></dt>
<dd><p>Positions of axis components.  The first component is the distance from
the axis label to the axis position, in text lines.  The second
component is the distance to the tick labels, and the final component is
the distance from the axis position to the axis line (usually zero).
Positive numbers measure outside the plot region, negative numbers
inside.
</p>
</dd>
<dt> <code>tck=0.01</code></dt>
<dd><p>Length of tick marks, as a fraction of the size of the plotting region.
When <code>tck</code> is small (less than 0.5) the tick marks on the <em>x</em>
and <em>y</em> axes are forced to be the same size.  A value of 1 gives
grid lines.  Negative values give tick marks outside the plotting
region.  Use <code>tck=0.01</code> and <code>mgp=c(1,-1.5,0)</code> for internal
tick marks.
</p>
</dd>
<dt> <code>xaxs=&quot;r&quot;</code></dt>
<dt> <code>yaxs=&quot;i&quot;</code></dt>
<dd><p>Axis styles for the <em>x</em> and <em>y</em> axes, respectively.   With
styles <code>&quot;i&quot;</code> (internal) and <code>&quot;r&quot;</code> (the default) tick marks
always fall within the range of the data, however style <code>&quot;r&quot;</code>
leaves a small amount of space at the edges.  (S has other styles
not implemented in R.)
</p>
</dd>
</dl>

<hr size="6">
<a name="Figure-margins"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Axes-and-tick-marks" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Multiple-figure-environment" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics-parameters" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Figure-margins-1"></a>
<h3 class="subsection">12.5.3 Figure margins</h3>


<p>A single plot in R is known as a <code>figure</code> and comprises a
<em>plot region</em> surrounded by margins (possibly containing axis
labels, titles, etc.) and (usually) bounded by the axes themselves.
</p>

<p>Graphics parameters controlling figure layout include:
</p>
<dl compact="compact">
<dt> <code>mai=c(1, 0.5, 0.5, 0)</code></dt>
<dd><p>Widths of the bottom, left, top and right margins, respectively,
measured in inches.
</p>
</dd>
<dt> <code>mar=c(4, 2, 2, 1)</code></dt>
<dd><p>Similar to <code>mai</code>, except the measurement unit is text lines.
</p></dd>
</dl>

<p><code>mar</code> and <code>mai</code> are equivalent in the sense that setting one
changes the value of the other.  The default values chosen for this
parameter are often too large; the right-hand margin is rarely needed,
and neither is the top margin if no title is being used.  The bottom and
left margins must be large enough to accommodate the axis and tick
labels.  Furthermore, the default is chosen without regard to the size
of the device surface: for example, using the <code>postscript()</code> driver
with the <code>height=4</code> argument will result in a plot which is about
50% margin unless <code>mar</code> or <code>mai</code> are set explicitly.  When
multiple figures are in use (see below) the margins are reduced, however
this may not be enough when many figures share the same page.
</p>
<hr size="6">
<a name="Multiple-figure-environment"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Figure-margins" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Device-drivers" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics-parameters" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Multiple-figure-environment-1"></a>
<h3 class="subsection">12.5.4 Multiple figure environment</h3>

<p>R allows you to create an <em>n</em> by <em>m</em> array of figures on a
single page.  Each figure has its own margins, and the array of figures
is optionally surrounded by an <em>outer margin</em>, as shown in the
following figure.
</p>

<p>The graphical parameters relating to multiple figures are as follows:
</p>
<dl compact="compact">
<dt> <code>mfcol=c(3, 2)</code></dt>
<dt> <code>mfrow=c(2, 4)</code></dt>
<dd><p>Set the size of a multiple figure array.  The first value is the number of
rows; the second is the number of columns.  The only difference between
these two parameters is that setting <code>mfcol</code> causes figures to be
filled by column; <code>mfrow</code> fills by rows.
</p>
<p>The layout in the Figure could have been created by setting
<code>mfrow=c(3,2)</code>; the figure shows the page after four plots have
been drawn.
</p>
<p>Setting either of these can reduce the base size of symbols and text
(controlled by <code>par(&quot;cex&quot;)</code> and the pointsize of the device).  In a
layout with exactly two rows and columns the base size is reduced by a
factor of 0.83: if there are three or more of either rows or columns,
the reduction factor is 0.66.
</p>
</dd>
<dt> <code>mfg=c(2, 2, 3, 2)</code></dt>
<dd><p>Position of the current figure in a multiple figure environment.  The first
two numbers are the row and column of the current figure; the last two
are the number of rows and columns in the multiple figure array.  Set
this parameter to jump between figures in the array.  You can even use
different values for the last two numbers than the <em>true</em> values
for unequally-sized figures on the same page.
</p>
</dd>
<dt> <code>fig=c(4, 9, 1, 4)/10</code></dt>
<dd><p>Position of the current figure on the page.  Values are the positions of
the left, right, bottom and top edges respectively, as a percentage of
the page measured from the bottom left corner.  The example value would
be for a figure in the bottom right of the page.  Set this parameter for
arbitrary positioning of figures within a page.  If you want to add a
figure to a current page, use <code>new=TRUE</code> as well (unlike S).
</p>
</dd>
<dt> <code>oma=c(2, 0, 3, 0)</code></dt>
<dt> <code>omi=c(0, 0, 0.8, 0)</code></dt>
<dd><p>Size of outer margins.  Like <code>mar</code> and <code>mai</code>, the first
measures in text lines and the second in inches, starting with the
bottom margin and working clockwise.
</p>
</dd>
</dl>

<p>Outer margins are particularly useful for page-wise titles, etc.  Text
can be added to the outer margins with the <code>mtext()</code> function with
argument <code>outer=TRUE</code>.  There are no outer margins by default,
however, so you must create them explicitly using <code>oma</code> or
<code>omi</code>.
</p>
<p>More complicated arrangements of multiple figures can be produced by the
<code>split.screen()</code> and <code>layout()</code> functions, as well as by the
<strong>grid</strong> and <a href="http://CRAN.R-project.org/package=lattice"><strong>lattice</strong></a> packages.
</p>
<hr size="6">
<a name="Device-drivers"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Multiple-figure-environment" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#PostScript-diagrams-for-typeset-documents" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Device-drivers-1"></a>
<h2 class="section">12.6 Device drivers</h2>
<a name="index-Graphics-device-drivers"></a>

<p>R can generate graphics (of varying levels of quality) on almost any
type of display or printing device.  Before this can begin, however,
R needs to be informed what type of device it is dealing with.  This
is done by starting a <em>device driver</em>.  The purpose of a device
driver is to convert graphical instructions from R (&ldquo;draw a line,&rdquo;
for example) into a form that the particular device can understand.
</p>
<p>Device drivers are started by calling a device driver function.  There
is one such function for every device driver: type <code>help(Devices)</code>
for a list of them all.  For example, issuing the command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; postscript()
</pre></td></tr></table>

<p>causes all future graphics output to be sent to the printer in
PostScript format.  Some commonly-used device drivers are:
</p>
<dl compact="compact">
<dt> <code>X11()</code></dt>
<dd><a name="index-X11"></a>
<p>For use with the X11 window system on Unix-alikes
</p></dd>
<dt> <code>windows()</code></dt>
<dd><a name="index-windows"></a>
<p>For use on Windows
</p></dd>
<dt> <code>quartz()</code></dt>
<dd><a name="index-quartz"></a>
<p>For use on Mac OS X
</p></dd>
<dt> <code>postscript()</code></dt>
<dd><a name="index-postscript"></a>
<p>For printing on PostScript printers, or creating PostScript graphics
files.
</p></dd>
<dt> <code>pdf()</code></dt>
<dd><a name="index-pdf"></a>
<p>Produces a PDF file, which can also be included into PDF files.
</p></dd>
<dt> <code>png()</code></dt>
<dd><a name="index-png"></a>
<p>Produces a bitmap PNG file. (Not always available: see its help page.)
</p></dd>
<dt> <code>jpeg()</code></dt>
<dd><a name="index-jpeg"></a>
<p>Produces a bitmap JPEG file, best used for <code>image</code> plots.
(Not always available: see its help page.)
</p></dd>
</dl>

<p>When you have finished with a device, be sure to terminate the device
driver by issuing the command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; dev.off()
</pre></td></tr></table>

<p>This ensures that the device finishes cleanly; for example in the case
of hardcopy devices this ensures that every page is completed and has
been sent to the printer.  (This will happen automatically at the normal
end of a session.)
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#PostScript-diagrams-for-typeset-documents">12.6.1 PostScript diagrams for typeset documents</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Multiple-graphics-devices">12.6.2 Multiple graphics devices</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   
</td></tr>
</table>

<hr size="6">
<a name="PostScript-diagrams-for-typeset-documents"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Device-drivers" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Multiple-graphics-devices" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Device-drivers" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="PostScript-diagrams-for-typeset-documents-1"></a>
<h3 class="subsection">12.6.1 PostScript diagrams for typeset documents</h3>

<p>By passing the <code>file</code> argument to the <code>postscript()</code> device
driver function, you may store the graphics in PostScript format in a
file of your choice.  The plot will be in landscape orientation unless
the <code>horizontal=FALSE</code> argument is given, and you can control the
size of the graphic with the <code>width</code> and <code>height</code> arguments
(the plot will be scaled as appropriate to fit these dimensions.) For
example, the command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; postscript(&quot;file.ps&quot;, horizontal=FALSE, height=5, pointsize=10)
</pre></td></tr></table>

<p>will produce a file containing PostScript code for a figure five inches
high, perhaps for inclusion in a document.  It is important to note that
if the file named in the command already exists, it will be overwritten.
This is the case even if the file was only created earlier in the same
R session.
</p>
<p>Many usages of PostScript output will be to incorporate the figure in
another document.  This works best when <em>encapsulated</em> PostScript
is produced: R always produces conformant output, but only marks the
output as such when the <code>onefile=FALSE</code> argument is supplied.  This
unusual notation stems from S-compatibility: it really means that
the output will be a single page (which is part of the EPSF
specification).  Thus to produce a plot for inclusion use something like
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; postscript(&quot;plot1.eps&quot;, horizontal=FALSE, onefile=FALSE,
             height=8, width=6, pointsize=10)
</pre></td></tr></table>


<hr size="6">
<a name="Multiple-graphics-devices"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#PostScript-diagrams-for-typeset-documents" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Dynamic-graphics" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Device-drivers" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Multiple-graphics-devices-1"></a>
<h3 class="subsection">12.6.2 Multiple graphics devices</h3>

<p>In advanced use of R it is often useful to have several graphics
devices in use at the same time.  Of course only one graphics device can
accept graphics commands at any one time, and this is known as the
<em>current device</em>.  When multiple devices are open, they form a
numbered sequence with names giving the kind of device at any position.
</p>
<p>The main commands used for operating with multiple devices, and their
meanings are as follows:
</p>
<dl compact="compact">
<dt> <code>X11()</code></dt>
<dd><p>[UNIX]
</p></dd>
<dt> <code>windows()</code></dt>
<dt> <code>win.printer()</code></dt>
<dt> <code>win.metafile()</code></dt>
<dd><p>[Windows]
</p></dd>
<dt> <code>quartz()</code></dt>
<dd><p>[Mac OS X]
</p></dd>
<dt> <code>postscript()</code></dt>
<dt> <code>pdf()</code></dt>
<dt> <code>png()</code></dt>
<dt> <code>jpeg()</code></dt>
<dt> <code>tiff()</code></dt>
<dt> <code>bitmap()</code></dt>
<dt> <code>&hellip;</code></dt>
<dd><p>Each new call to a device driver function opens a new graphics device,
thus extending by one the device list.  This device becomes the current
device, to which graphics output will be sent.
</p>
</dd>
<dt> <code>dev.list()</code></dt>
<dd><a name="index-dev_002elist"></a>
<p>Returns the number and name of all active devices.  The device at
position 1 on the list is always the <em>null device</em> which does not
accept graphics commands at all.
</p>
</dd>
<dt> <code>dev.next()</code></dt>
<dt> <code>dev.prev()</code></dt>
<dd><a name="index-dev_002enext"></a>
<a name="index-dev_002eprev"></a>
<p>Returns the number and name of the graphics device next to, or previous
to the current device, respectively.
</p>
</dd>
<dt> <code>dev.set(which=<var>k</var>)</code></dt>
<dd><a name="index-dev_002eset"></a>
<p>Can be used to change the current graphics device to the one at position
<var>k</var> of the device list.  Returns the number and label of the device.
</p>
</dd>
<dt> <code>dev.off(<var>k</var>)</code></dt>
<dd><a name="index-dev_002eoff"></a>
<p>Terminate the graphics device at point <var>k</var> of the device list.  For
some devices, such as <code>postscript</code> devices, this will either print
the file immediately or correctly complete the file for later printing,
depending on how the device was initiated.
</p>
</dd>
<dt> <code>dev.copy(device, &hellip;, which=<var>k</var>)</code></dt>
<dt> <code>dev.print(device, &hellip;, which=<var>k</var>)</code></dt>
<dd><p>Make a copy of the device <var>k</var>.  Here <code>device</code> is a device
function, such as <code>postscript</code>, with extra arguments, if needed,
specified by &lsquo;<samp>&hellip;</samp>&rsquo;.  <code>dev.print</code> is similar, but the
copied device is immediately closed, so that end actions, such as
printing hardcopies, are immediately performed.
</p>
</dd>
<dt> <code>graphics.off()</code></dt>
<dd><p>Terminate all graphics devices on the list, except the null device.
</p></dd>
</dl>

<hr size="6">
<a name="Dynamic-graphics"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Multiple-graphics-devices" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Graphics" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Dynamic-graphics-1"></a>
<h2 class="section">12.7 Dynamic graphics</h2>
<a name="index-Dynamic-graphics"></a>

<p>R does not have builtin capabilities for dynamic or
interactive graphics, e.g.&nbsp;rotating point clouds or to &ldquo;brushing&rdquo;
(interactively highlighting) points. However, extensive dynamic graphics
facilities are available in the system GGobi by Swayne, Cook and Buja
available from
</p>
<blockquote><p><a href="http://www.ggobi.org/">http://www.ggobi.org/</a>
</p></blockquote>

<p>and these can be accessed from R via the package <a href="http://CRAN.R-project.org/package=rggobi"><strong>rggobi</strong></a>, described at
<a href="http://www.ggobi.org/rggobi">http://www.ggobi.org/rggobi</a>.
</p>
<p>Also, package <a href="http://CRAN.R-project.org/package=rgl"><strong>rgl</strong></a> provides ways to interact with 3D plots, for example
of surfaces.
</p>
<hr size="6">
<a name="Packages"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Dynamic-graphics" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Standard-packages" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Graphics" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#A-sample-session" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Packages-1"></a>
<h1 class="chapter">13. Packages</h1>
<a name="index-Packages-1"></a>

<p>All R functions and datasets are stored in <em>packages</em>.  Only
when a package is loaded are its contents available.  This is done both
for efficiency (the full list would take more memory and would take
longer to search than a subset), and to aid package developers, who are
protected from name clashes with other code.  The process of developing
packages is described in <a href="R-exts.html#Creating-R-packages">(R-exts)Creating R packages</a> section &lsquo;Creating R packages&rsquo; in <cite>Writing R Extensions</cite>.  Here, we will describe them
from a user&rsquo;s point of view.
</p>
<p>To see which packages are installed at your site, issue the command
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; library()
</pre></td></tr></table>

<p>with no arguments.  To load a particular package (e.g., the <a href="http://CRAN.R-project.org/package=boot"><strong>boot</strong></a>
package containing functions from Davison &amp; Hinkley (1997)), use a
command like
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; library(boot)
</pre></td></tr></table>

<p>Users connected to the Internet can use the <code>install.packages()</code>
and <code>update.packages()</code> functions (available through the
<code>Packages</code> menu in the Windows and RAqua GUIs, see <a href="R-admin.html#Installing-packages">(R-admin)Installing packages</a> section &lsquo;Installing packages&rsquo; in <cite>R Installation and Administration</cite>) to install and
update packages.
</p>
<p>To see which packages are currently loaded, use
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; search()
</pre></td></tr></table>

<p>to display the search list.  Some packages may be loaded but not
available on the search list (see section <a href="#Namespaces">Namespaces</a>): these will be
included in the list given by
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; loadedNamespaces()
</pre></td></tr></table>


<p>To see a list of all available help topics in an installed package,
use
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">&gt; help.start()
</pre></td></tr></table>

<p>to start the <acronym>HTML</acronym> help system, and then navigate to the package
listing in the <code>Reference</code> section.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Standard-packages">13.1 Standard packages</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           
</td></tr>
<tr><td align="left" valign="top"><a href="#Contributed-packages-and-CRAN">13.2 Contributed packages and <acronym>CRAN</acronym></a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Namespaces">13.3 Namespaces</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                  
</td></tr>
</table>

<hr size="6">
<a name="Standard-packages"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Packages" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Contributed-packages-and-CRAN" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Packages" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#A-sample-session" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Standard-packages-1"></a>
<h2 class="section">13.1 Standard packages</h2>

<p>The standard (or <em>base</em>) packages are considered part of the R
source code.  They contain the basic functions that allow R to work,
and the datasets and standard statistical and graphical functions that
are described in this manual.  They should be automatically available in
any R installation.  See <a href="R-FAQ.html#Which-add_002don-packages-exist-for-R_003f">(R-FAQ)Which add-on packages exist for R?</a> section &lsquo;R packages&rsquo; in <cite>R FAQ</cite>, for a complete list.
</p>
<hr size="6">
<a name="Contributed-packages-and-CRAN"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Standard-packages" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Namespaces" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Packages" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#A-sample-session" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Contributed-packages-and-CRAN-1"></a>
<h2 class="section">13.2 Contributed packages and <acronym>CRAN</acronym></h2>
<a name="index-CRAN"></a>

<p>There are thousands of contributed packages for R, written by many
different authors.  Some of these packages implement specialized
statistical methods, others give access to data or hardware, and others
are designed to complement textbooks.  Some (the <em>recommended</em>
packages) are distributed with every binary distribution of R.  Most
are available for download from <acronym>CRAN</acronym>
(<a href="http://CRAN.R-project.org/">http://CRAN.R-project.org/</a> and its mirrors) and other
repositories such as Bioconductor (<a href="http://www.bioconductor.org/">http://www.bioconductor.org/</a>)
and Omegahat (<a href="http://www.omegahat.org/">http://www.omegahat.org/</a>).  The <em>R FAQ</em>
contains a list of CRAN packages current at the time of release, but the
collection of available packages changes very frequently.
</p>
<hr size="6">
<a name="Namespaces"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Contributed-packages-and-CRAN" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#A-sample-session" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Packages" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Packages" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#A-sample-session" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Namespaces-1"></a>
<h2 class="section">13.3 Namespaces</h2>
<a name="index-Namespace"></a>
<a name="index-_003a_003a"></a>
<a name="index-_003a_003a_003a"></a>

<p>Packages can have <em>namespaces</em>, and currently all of the base and
recommended packages do except the <code>datasets</code> package.  Namespaces
do three things: they allow the package writer to hide functions and
data that are meant only for internal use, they prevent functions from
breaking when a user (or other package writer) picks a name that clashes
with one in the package, and they provide a way to refer to an object
within a particular package.
</p>
<p>For example, <code>t()</code> is the transpose function in R, but users
might define their own function named <code>t</code>.  Namespaces prevent
the user&rsquo;s definition from taking precedence, and breaking every
function that tries to transpose a matrix.
</p>
<p>There are two operators that work with namespaces.  The double-colon
operator <code>::</code> selects definitions from a particular namespace.
In the example above, the transpose function will always be available
as <code>base::t</code>, because it is defined in the <code>base</code> package.
Only functions that are exported from the package can be retrieved in
this way.
</p>
<p>The triple-colon operator <code>:::</code> may be seen in a few places in R
code: it acts like the double-colon operator but also allows access to
hidden objects.  Users are more likely to use the <code>getAnywhere()</code>
function, which searches multiple packages.
</p>
<p>Packages are often inter-dependent, and loading one may cause others to
be automatically loaded.  The colon operators described above will also
cause automatic loading of the associated package.  When packages with
namespaces are loaded automatically they are not added to the search
list.
</p>

<hr size="6">
<a name="A-sample-session"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Namespaces" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Invoking-R" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Packages" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Invoking-R" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="A-sample-session-1"></a>
<h1 class="appendix">A. A sample session</h1>

<p>The following session is intended to introduce to you some features of
the R environment by using them.  Many features of the system will be
unfamiliar and puzzling at first, but this puzzlement will soon
disappear.
</p>
<dl compact="compact">
<dt><code></code></dt>
<dd><p>Start R appropriately for your platform (see section <a href="#Invoking-R">Invoking R</a>).
</p>
<p>The R program begins, with a banner.
</p>
<p>(Within R code, the prompt on the left hand side will not be shown to
avoid confusion.)
</p>
</dd>
<dt> <code>help.start()</code></dt>
<dd><p>Start the <acronym>HTML</acronym> interface to on-line help (using a web browser
available at your machine).  You should briefly explore the features of
this facility with the mouse.
</p>
<p>Iconify the help window and move on to the next part.
</p>
</dd>
<dt> <code>x &lt;- rnorm(50)</code></dt>
<dt> <code>y &lt;- rnorm(x)</code></dt>
<dd><p>Generate two pseudo-random normal vectors of <em>x</em>- and
<em>y</em>-coordinates.
</p>
</dd>
<dt> <code>plot(x, y)</code></dt>
<dd><p>Plot the points in the plane.  A graphics window will appear automatically.
</p>
</dd>
<dt> <code>ls()</code></dt>
<dd><p>See which R objects are now in the R workspace.
</p>
</dd>
<dt> <code>rm(x, y)</code></dt>
<dd><p>Remove objects no longer needed. (Clean up).
</p>
</dd>
<dt> <code>x &lt;- 1:20</code></dt>
<dd><p>Make <em>x = (1, 2, &hellip;, 20)</em>.
</p>
</dd>
<dt> <code>w &lt;- 1 + sqrt(x)/2</code></dt>
<dd><p>A &lsquo;weight&rsquo; vector of standard deviations.
</p>
</dd>
<dt> <code>dummy &lt;- data.frame(x=x, y= x + rnorm(x)*w)</code></dt>
<dt> <code>dummy</code></dt>
<dd><p>Make a <em>data frame</em> of two columns, <em>x</em> and <em>y</em>, and look
at it.
</p>
</dd>
<dt> <code>fm &lt;- lm(y ~ x, data=dummy)</code></dt>
<dt> <code>summary(fm)</code></dt>
<dd><p>Fit a simple linear regression and look at the
analysis.  With <code>y</code> to the left of the tilde,
we are modelling <em>y</em> dependent on <em>x</em>.
</p>
</dd>
<dt> <code>fm1 &lt;- lm(y ~ x, data=dummy, weight=1/w^2)</code></dt>
<dt> <code>summary(fm1)</code></dt>
<dd><p>Since we know the standard deviations, we can do a weighted regression.
</p>
</dd>
<dt> <code>attach(dummy)</code></dt>
<dd><p>Make the columns in the data frame visible as variables.
</p>
</dd>
<dt> <code>lrf &lt;- lowess(x, y)</code></dt>
<dd><p>Make a nonparametric local regression function.
</p>
</dd>
<dt> <code>plot(x, y)</code></dt>
<dd><p>Standard point plot.
</p>
</dd>
<dt> <code>lines(x, lrf$y)</code></dt>
<dd><p>Add in the local regression.
</p>
</dd>
<dt> <code>abline(0, 1, lty=3)</code></dt>
<dd><p>The true regression line: (intercept 0, slope 1).
</p>
</dd>
<dt> <code>abline(coef(fm))</code></dt>
<dd><p>Unweighted regression line.
</p>
</dd>
<dt> <code>abline(coef(fm1), col = &quot;red&quot;)</code></dt>
<dd><p>Weighted regression line.
</p>
</dd>
<dt> <code>detach()</code></dt>
<dd><p>Remove data frame from the search path.
</p>
</dd>
<dt> <code>plot(fitted(fm), resid(fm),</code></dt>
<dt> <code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xlab=&quot;Fitted values&quot;,</code></dt>
<dt> <code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ylab=&quot;Residuals&quot;,</code></dt>
<dt> <code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main=&quot;Residuals vs Fitted&quot;)</code></dt>
<dd><p>A standard regression diagnostic plot to check for heteroscedasticity.
Can you see it?
</p>
</dd>
<dt> <code>qqnorm(resid(fm), main=&quot;Residuals Rankit Plot&quot;)</code></dt>
<dd><p>A normal scores plot to check for skewness, kurtosis and outliers.  (Not
very useful here.)
</p>
</dd>
<dt> <code>rm(fm, fm1, lrf, x, dummy)</code></dt>
<dd><p>Clean up again.
</p></dd>
</dl>

<p>The next section will look at data from the classical experiment of
Michelson to measure the speed of light.  This dataset is available in
the <code>morley</code> object, but we will read it to illustrate the
<code>read.table</code> function.
</p>
<dl compact="compact">
<dt> <code>filepath &lt;- system.file(&quot;data&quot;, &quot;morley.tab&quot; , package=&quot;datasets&quot;)</code></dt>
<dt> <code>filepath</code></dt>
<dd><p>Get the path to the data file.
</p>
</dd>
<dt> <code>file.show(filepath)</code></dt>
<dd><p>Optional.  Look at the file.
</p>
</dd>
<dt> <code>mm &lt;- read.table(filepath)</code></dt>
<dt> <code>mm</code></dt>
<dd><p>Read in the Michelson data as a data frame, and look at it.
There are five experiments (column <code>Expt</code>) and each has 20 runs
(column <code>Run</code>) and <code>sl</code> is the recorded speed of light,
suitably coded.
</p>
</dd>
<dt> <code>mm$Expt &lt;- factor(mm$Expt)</code></dt>
<dt> <code>mm$Run &lt;- factor(mm$Run)</code></dt>
<dd><p>Change <code>Expt</code> and <code>Run</code> into factors.
</p>
</dd>
<dt> <code>attach(mm)</code></dt>
<dd><p>Make the data frame visible at position 3 (the default).
</p>
</dd>
<dt> <code>plot(Expt, Speed, main=&quot;Speed of Light Data&quot;, xlab=&quot;Experiment No.&quot;)</code></dt>
<dd><p>Compare the five experiments with simple boxplots.
</p>
</dd>
<dt> <code>fm &lt;- aov(Speed ~ Run + Expt, data=mm)</code></dt>
<dt> <code>summary(fm)</code></dt>
<dd><p>Analyze as a randomized block, with &lsquo;runs&rsquo; and &lsquo;experiments&rsquo; as factors.
</p>
</dd>
<dt> <code>fm0 &lt;- update(fm, . ~ . - Run)</code></dt>
<dt> <code>anova(fm0, fm)</code></dt>
<dd><p>Fit the sub-model omitting &lsquo;runs&rsquo;, and compare using a formal analysis
of variance.
</p>
</dd>
<dt> <code>detach()</code></dt>
<dt> <code>rm(fm, fm0)</code></dt>
<dd><p>Clean up before moving on.
</p>
</dd>
</dl>

<p>We now look at some more graphical features: contour and image plots.
</p>
<dl compact="compact">
<dt> <code>x &lt;- seq(-pi, pi, len=50)</code></dt>
<dt> <code>y &lt;- x</code></dt>
<dd><p><em>x</em> is a vector of 50 equally spaced values in
the interval [-pi\, pi].
<em>y</em> is the same.
</p>
</dd>
<dt> <code>f &lt;- outer(x, y, function(x, y) cos(y)/(1 + x^2))</code></dt>
<dd><p><em>f</em> is a square matrix, with rows and columns indexed by <em>x</em>
and <em>y</em> respectively, of values of the function
cos(y)/(1 + x^2).
</p>
</dd>
<dt> <code>oldpar &lt;- par(no.readonly = TRUE)</code></dt>
<dt> <code>par(pty=&quot;s&quot;)</code></dt>
<dd><p>Save the plotting parameters and set the plotting region to &ldquo;square&rdquo;.
</p>
</dd>
<dt> <code>contour(x, y, f)</code></dt>
<dt> <code>contour(x, y, f, nlevels=15, add=TRUE)</code></dt>
<dd><p>Make a contour map of <em>f</em>; add in more lines for more detail.
</p>
</dd>
<dt> <code>fa &lt;- (f-t(f))/2</code></dt>
<dd><p><code>fa</code> is the &ldquo;asymmetric part&rdquo; of <em>f</em>.  (<code>t()</code> is
transpose).
</p>
</dd>
<dt> <code>contour(x, y, fa, nlevels=15)</code></dt>
<dd><p>Make a contour plot, &hellip;
</p>
</dd>
<dt> <code>par(oldpar)</code></dt>
<dd><p>&hellip; and restore the old graphics parameters.
</p>
</dd>
<dt> <code>image(x, y, f)</code></dt>
<dt> <code>image(x, y, fa)</code></dt>
<dd><p>Make some high density image plots, (of which you can get
hardcopies if you wish), &hellip;
</p>
</dd>
<dt> <code>objects(); rm(x, y, f, fa)</code></dt>
<dd><p>&hellip; and clean up before moving on.
</p></dd>
</dl>

<p>R can do complex arithmetic, also.
</p>
<dl compact="compact">
<dt> <code>th &lt;- seq(-pi, pi, len=100)</code></dt>
<dt> <code>z &lt;- exp(1i*th)</code></dt>
<dd><p><code>1i</code> is used for the complex number <em>i</em>.
</p>
</dd>
<dt> <code>par(pty=&quot;s&quot;)</code></dt>
<dt> <code>plot(z, type=&quot;l&quot;)</code></dt>
<dd><p>Plotting complex arguments means plot imaginary versus real parts.  This
should be a circle.
</p>
</dd>
<dt> <code>w &lt;- rnorm(100) + rnorm(100)*1i</code></dt>
<dd><p>Suppose we want to sample points within the unit circle.  One method
would be to take complex numbers with standard normal real and imaginary
parts &hellip;
</p>
</dd>
<dt> <code>w &lt;- ifelse(Mod(w) &gt; 1, 1/w, w)</code></dt>
<dd><p>&hellip; and to map any outside the circle onto their reciprocal.
</p>
</dd>
<dt> <code>plot(w, xlim=c(-1,1), ylim=c(-1,1), pch=&quot;+&quot;,xlab=&quot;x&quot;, ylab=&quot;y&quot;)</code></dt>
<dt> <code>lines(z)</code></dt>
<dt><code></code></dt>
<dd><p>All points are inside the unit circle, but the distribution is not
uniform.
</p>
</dd>
<dt> <code>w &lt;- sqrt(runif(100))*exp(2*pi*runif(100)*1i)</code></dt>
<dt> <code>plot(w, xlim=c(-1,1), ylim=c(-1,1), pch=&quot;+&quot;, xlab=&quot;x&quot;, ylab=&quot;y&quot;)</code></dt>
<dt> <code>lines(z)</code></dt>
<dt><code></code></dt>
<dd><p>The second method uses the uniform distribution.  The points should now
look more evenly spaced over the disc.
</p>
</dd>
<dt> <code>rm(th, w, z)</code></dt>
<dd><p>Clean up again.
</p>
</dd>
<dt> <code>q()</code></dt>
<dd><p>Quit the R program.  You will be asked if you want to save the R
workspace, and for an exploratory session like this, you probably do not
want to save it.
</p></dd>
</dl>

<hr size="6">
<a name="Invoking-R"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#A-sample-session" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Invoking-R-from-the-command-line" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#A-sample-session" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#The-command_002dline-editor" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Invoking-R-1"></a>
<h1 class="appendix">B. Invoking R</h1>

<p>Users of R on Windows or Mac OS X should read the OS-specific section
first, but command-line use is also supported.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Invoking-R-from-the-command-line">B.1 Invoking R from the command line</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  
</td></tr>
<tr><td align="left" valign="top"><a href="#Invoking-R-under-Windows">B.2 Invoking R under Windows</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">    
</td></tr>
<tr><td align="left" valign="top"><a href="#Invoking-R-under-Mac-OS-X">B.3 Invoking R under Mac OS X</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   
</td></tr>
<tr><td align="left" valign="top"><a href="#Scripting-with-R">B.4 Scripting with R</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            
</td></tr>
</table>

<hr size="6">
<a name="Invoking-R-from-the-command-line"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Invoking-R" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Invoking-R-under-Windows" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Invoking-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Invoking-R" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#The-command_002dline-editor" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Invoking-R-from-the-command-line-1"></a>
<h2 class="appendixsec">B.1 Invoking R from the command line</h2>

<p>When working at a command line on UNIX or Windows, the command &lsquo;<samp>R</samp>&rsquo;
can be used both for starting the main R program in the form
</p>
<table><tr><td>&nbsp;</td><td><pre class="display"><code>R</code> [<var>options</var>] [<code>&lt;</code><var>infile</var>] [<code>&gt;</code><var>outfile</var>],
</pre></td></tr></table>

<p>or, via the <code>R CMD</code> interface, as a wrapper to various R tools
(e.g., for processing files in R documentation format or manipulating
add-on packages) which are not intended to be called &ldquo;directly&rdquo;.
</p>
<p>At the Windows command-line, <code>Rterm.exe</code> is preferred to
<code>R</code>.
</p>
<p>You need to ensure that either the environment variable <code>TMPDIR</code> is
unset or it points to a valid place to create temporary files and
directories.
</p>
<p>Most options control what happens at the beginning and at the end of an
R session.  The startup mechanism is as follows (see also the on-line
help for topic &lsquo;<samp>Startup</samp>&rsquo; for more information, and the section below
for some Windows-specific details).
</p>
<ul>
<li>
Unless &lsquo;<samp>--no-environ</samp>&rsquo; was given, R searches for user and site
files to process for setting environment variables.  The name of the
site file is the one pointed to by the environment variable
<code>R_ENVIRON</code>; if this is unset, &lsquo;<tt><var>R_HOME</var>/etc/Renviron.site</tt>&rsquo;
is used (if it exists).  The user file is the one pointed to by the
environment variable <code>R_ENVIRON_USER</code> if this is set; otherwise,
files &lsquo;<tt>.Renviron</tt>&rsquo; in the current or in the user&rsquo;s home directory
(in that order) are searched for.  These files should contain lines of
the form &lsquo;<samp><var>name</var>=<var>value</var></samp>&rsquo;.  (See <code>help(&quot;Startup&quot;)</code> for
a precise description.)  Variables you might want to set include
<code>R_PAPERSIZE</code> (the default paper size), <code>R_PRINTCMD</code> (the
default print command) and <code>R_LIBS</code> (specifies the list of R
library trees searched for add-on packages).

</li><li>
Then R searches for the site-wide startup profile unless the command
line option &lsquo;<samp>--no-site-file</samp>&rsquo; was given.  The name of this file is
taken from the value of the <code>R_PROFILE</code> environment variable.  If
that variable is unset, the default
&lsquo;<tt><var>R_HOME</var>/etc/Rprofile.site</tt>&rsquo; is used if this exists.

</li><li>
Then, unless &lsquo;<samp>--no-init-file</samp>&rsquo; was given, R searches for a user
profile and sources it.  The name of this file is taken from the
environment variable <code>R_PROFILE_USER</code>; if unset, a file called
&lsquo;<tt>.Rprofile</tt>&rsquo; in the current directory or in the user&rsquo;s home
directory (in that order) is searched for.

</li><li>
It also loads a saved workspace from file &lsquo;<tt>.RData</tt>&rsquo; in the current
directory if there is one (unless &lsquo;<samp>--no-restore</samp>&rsquo; or
&lsquo;<samp>--no-restore-data</samp>&rsquo; was specified).

</li><li>
Finally, if a function <code>.First()</code> exists, it is executed.  This
function (as well as <code>.Last()</code> which is executed at the end of the
R session) can be defined in the appropriate startup profiles, or
reside in &lsquo;<tt>.RData</tt>&rsquo;.
</li></ul>

<p>In addition, there are options for controlling the memory available to
the R process (see the on-line help for topic &lsquo;<samp>Memory</samp>&rsquo; for more
information).  Users will not normally need to use these unless they
are trying to limit the amount of memory used by R.
</p>
<p>R accepts the following command-line options.
</p>
<dl compact="compact">
<dt> &lsquo;<samp>--help</samp>&rsquo;</dt>
<dt> &lsquo;<samp>-h</samp>&rsquo;</dt>
<dd><p>Print short help message to standard output and exit successfully.
</p>
</dd>
<dt> &lsquo;<samp>--version</samp>&rsquo;</dt>
<dd><p>Print version information to standard output and exit successfully.
</p>
</dd>
<dt> &lsquo;<samp>--encoding=<var>enc</var></samp>&rsquo;</dt>
<dd><p>Specify the encoding to be assumed for input from the console or
<code>stdin</code>.  This needs to be an encoding known to <code>iconv</code>: see
its help page.  (<code>--encoding <var>enc</var></code> is also accepted.)
</p>
</dd>
<dt> &lsquo;<samp>RHOME</samp>&rsquo;</dt>
<dd><p>Print the path to the R &ldquo;home directory&rdquo; to standard output and
exit successfully.  Apart from the front-end shell script and the man
page, R installation puts everything (executables, packages, etc.)
into this directory.
</p>
</dd>
<dt> &lsquo;<samp>--save</samp>&rsquo;</dt>
<dt> &lsquo;<samp>--no-save</samp>&rsquo;</dt>
<dd><p>Control whether data sets should be saved or not at the end of the R
session.  If neither is given in an interactive session, the user is
asked for the desired behavior when ending the session with <kbd>q()</kbd>;
in non-interactive use one of these must be specified or implied by some
other option (see below).
</p>
</dd>
<dt> &lsquo;<samp>--no-environ</samp>&rsquo;</dt>
<dd><p>Do not read any user file to set environment variables.
</p>
</dd>
<dt> &lsquo;<samp>--no-site-file</samp>&rsquo;</dt>
<dd><p>Do not read the site-wide profile at startup.
</p>
</dd>
<dt> &lsquo;<samp>--no-init-file</samp>&rsquo;</dt>
<dd><p>Do not read the user&rsquo;s profile at startup.
</p>
</dd>
<dt> &lsquo;<samp>--restore</samp>&rsquo;</dt>
<dt> &lsquo;<samp>--no-restore</samp>&rsquo;</dt>
<dt> &lsquo;<samp>--no-restore-data</samp>&rsquo;</dt>
<dd><p>Control whether saved images (file &lsquo;<tt>.RData</tt>&rsquo; in the directory where
R was started) should be restored at startup or not.  The default is
to restore. (&lsquo;<samp>--no-restore</samp>&rsquo; implies all the specific
&lsquo;<samp>--no-restore-*</samp>&rsquo; options.)
</p>
</dd>
<dt> &lsquo;<samp>--no-restore-history</samp>&rsquo;</dt>
<dd><p>Control whether the history file (normally file &lsquo;<tt>.Rhistory</tt>&rsquo; in the
directory where R was started, but can be set by the environment
variable <code>R_HISTFILE</code>) should be restored at startup or not.  The
default is to restore.
</p>
</dd>
<dt> &lsquo;<samp>--no-Rconsole</samp>&rsquo;</dt>
<dd><p>(Windows only) Prevent loading the &lsquo;<tt>Rconsole</tt>&rsquo; file at startup.
</p>
</dd>
<dt> &lsquo;<samp>--vanilla</samp>&rsquo;</dt>
<dd><p>Combine &lsquo;<samp>--no-save</samp>&rsquo;, &lsquo;<samp>--no-environ</samp>&rsquo;,
&lsquo;<samp>--no-site-file</samp>&rsquo;, &lsquo;<samp>--no-init-file</samp>&rsquo; and
&lsquo;<samp>--no-restore</samp>&rsquo;.  Under Windows, this also includes
&lsquo;<samp>--no-Rconsole</samp>&rsquo;.
</p>
</dd>
<dt> &lsquo;<samp>-f <var>file</var></samp>&rsquo;</dt>
<dt> &lsquo;<samp>--file=<var>file</var></samp>&rsquo;</dt>
<dd><p>(not <code>Rgui.exe</code>) Take input from <var>file</var>: &lsquo;<samp>-</samp>&rsquo; means
<code>stdin</code>.  Implies &lsquo;<samp>--no-save</samp>&rsquo; unless &lsquo;<samp>--save</samp>&rsquo; has
been set.  On a Unix-alike, shell metacharacters should be avoided in
<var>file</var> (but as from R 2.14.0 spaces are allowed).
</p>
</dd>
<dt> &lsquo;<samp>-e <var>expression</var></samp>&rsquo;</dt>
<dd><p>(not <code>Rgui.exe</code>) Use <var>expression</var> as an input line.  One or
more &lsquo;<samp>-e</samp>&rsquo; options can be used, but not together with &lsquo;<samp>-f</samp>&rsquo;
or &lsquo;<samp>--file</samp>&rsquo;.  Implies &lsquo;<samp>--no-save</samp>&rsquo; unless &lsquo;<samp>--save</samp>&rsquo;
has been set.  (There is a limit of 10,000 bytes on the total length of
expressions used in this way.  Expressions containing spaces or shell
metacharacters will need to be quoted.)
</p>
</dd>
<dt> &lsquo;<samp>--no-readline</samp>&rsquo;</dt>
<dd><p>(UNIX only) Turn off command-line editing via <strong>readline</strong>.  This
is useful when running R from within Emacs using the <acronym>ESS</acronym>
(&ldquo;Emacs Speaks Statistics&rdquo;) package.  See section <a href="#The-command_002dline-editor">The command-line editor</a>,
for more information.  Command-line editing is enabled by default
interactive use (see &lsquo;<samp>--interactive</samp>&rsquo;).  This option also affects
tilde-expansion: see the help for <code>path.expand</code>.
</p>
</dd>
<dt> &lsquo;<samp>--min-vsize=<var>N</var></samp>&rsquo;</dt>
<dt> &lsquo;<samp>--min-nsize=<var>N</var></samp>&rsquo;</dt>
<dd><p>For expert use only: set the initial trigger sizes for garbage
collection of vector heap (in bytes) and <em>cons cells</em> (number)
respectively.  Suffix &lsquo;<samp>M</samp>&rsquo; specifies megabytes or millions of cells
respectively.  The defaults are 6Mb and 350k respectively.
</p>
</dd>
<dt> &lsquo;<samp>--max-ppsize=<var>N</var></samp>&rsquo;</dt>
<dd><p>Specify the maximum size of the pointer protection stack as <var>N</var>
locations.  This defaults to 10000, but can be increased to allow
large and complicated calculations to be done.  Currently the maximum
value accepted is 100000.
</p>
</dd>
<dt> &lsquo;<samp>--max-mem-size=<var>N</var></samp>&rsquo;</dt>
<dd><p>(Windows only) Specify a limit for the amount of memory to be used both
for R objects and working areas.  This is set by default to the
smaller of the amount of physical RAM in the machine and for 32-bit
R, 1.5Gb<a name="DOCF25" href="#FOOT25">(25)</a>, and must be between 32Mb and the
maximum allowed on that version of Windows.
</p>
</dd>
<dt> &lsquo;<samp>--quiet</samp>&rsquo;</dt>
<dt> &lsquo;<samp>--silent</samp>&rsquo;</dt>
<dt> &lsquo;<samp>-q</samp>&rsquo;</dt>
<dd><p>Do not print out the initial copyright and welcome messages.
</p>
</dd>
<dt> &lsquo;<samp>--slave</samp>&rsquo;</dt>
<dd><p>Make R run as quietly as possible.  This option is intended to
support programs which use R to compute results for them.  It implies
&lsquo;<samp>--quiet</samp>&rsquo; and &lsquo;<samp>--no-save</samp>&rsquo;.
</p>
</dd>
<dt> &lsquo;<samp>--interactive</samp>&rsquo;</dt>
<dd><p>(UNIX only) Assert that R really is being run interactively even if
input has been redirected: use if input is from a FIFO or pipe and fed
from an interactive program.  (The default is to deduce that R is
being run interactively if and only if &lsquo;<tt>stdin</tt>&rsquo; is connected to a
terminal or <code>pty</code>.)  Using &lsquo;<samp>-e</samp>&rsquo;, &lsquo;<samp>-f</samp>&rsquo; or
&lsquo;<samp>--file</samp>&rsquo; asserts non-interactive use even if
&lsquo;<samp>--interactive</samp>&rsquo; is given.
</p>
</dd>
<dt> &lsquo;<samp>--ess</samp>&rsquo;</dt>
<dd><p>(Windows only) Set <code>Rterm</code> up for use by <code>R-inferior-mode</code> in
<acronym>ESS</acronym>, including asserting interactive use without the
command-line editor.
</p>
</dd>
<dt> &lsquo;<samp>--verbose</samp>&rsquo;</dt>
<dd><p>Print more information about progress, and in particular set R&rsquo;s
option <code>verbose</code> to <code>TRUE</code>.  R code uses this option to
control the printing of diagnostic messages.
</p>
</dd>
<dt> &lsquo;<samp>--debugger=<var>name</var></samp>&rsquo;</dt>
<dt> &lsquo;<samp>-d <var>name</var></samp>&rsquo;</dt>
<dd><p>(UNIX only) Run R through debugger <var>name</var>.  For most debuggers
(the exceptions are <code>valgrind</code> and recent versions of
<code>gdb</code>), further command line options are disregarded, and should
instead be given when starting the R executable from inside the
debugger.
</p>
</dd>
<dt> &lsquo;<samp>--gui=<var>type</var></samp>&rsquo;</dt>
<dt> &lsquo;<samp>-g <var>type</var></samp>&rsquo;</dt>
<dd><p>(UNIX only) Use <var>type</var> as graphical user interface (note that this
also includes interactive graphics).  Currently, possible values for
<var>type</var> are &lsquo;<samp>X11</samp>&rsquo; (the default) and, provided that &lsquo;<samp>Tcl/Tk</samp>&rsquo;
support is available, &lsquo;<samp>Tk</samp>&rsquo;. (For back-compatibility, &lsquo;<samp>x11</samp>&rsquo; and
&lsquo;<samp>tk</samp>&rsquo; are accepted.)
</p>
</dd>
<dt> &lsquo;<samp>--arch=<var>name</var></samp>&rsquo;</dt>
<dd><p>(UNIX only) Run the specified sub-architecture.  Most commonly used on
Mac OS X, where the possible values are &lsquo;<samp>i386</samp>&rsquo;, &lsquo;<samp>x86_64</samp>&rsquo; and
&lsquo;<samp>ppc</samp>&rsquo;.
</p>
</dd>
<dt> &lsquo;<samp>--args</samp>&rsquo;</dt>
<dd><p>This flag does nothing except cause the rest of the command line to be
skipped: this can be useful to retrieve values from it with
<code>commandArgs(TRUE)</code>.
</p></dd>
</dl>

<p>Note that input and output can be redirected in the usual way (using
&lsquo;<samp>&lt;</samp>&rsquo; and &lsquo;<samp>&gt;</samp>&rsquo;), but the line length limit of 4095 bytes still
applies.  Warning and error messages are sent to the error channel
(<code>stderr</code>).
</p>
<p>The command <code>R CMD</code> allows the invocation of various tools which
are useful in conjunction with R, but not intended to be called
&ldquo;directly&rdquo;.  The general form is
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">R CMD <var>command</var> <var>args</var>
</pre></td></tr></table>

<p>where <var>command</var> is the name of the tool and <var>args</var> the arguments
passed on to it.
</p>
<p>Currently, the following tools are available.
</p>
<dl compact="compact">
<dt> <code>BATCH</code></dt>
<dd><p>Run R in batch mode.  Runs <code>R --restore --save</code> with possibly
further options (see <code>?BATCH</code>).
</p></dd>
<dt> <code>COMPILE</code></dt>
<dd><p>(UNIX only) Compile C, C++, Fortran &hellip; files for use with R.
</p></dd>
<dt> <code>SHLIB</code></dt>
<dd><p>Build shared library for dynamic loading.
</p></dd>
<dt> <code>INSTALL</code></dt>
<dd><p>Install add-on packages.
</p></dd>
<dt> <code>REMOVE</code></dt>
<dd><p>Remove add-on packages.
</p></dd>
<dt> <code>build</code></dt>
<dd><p>Build (that is, package) add-on packages.
</p></dd>
<dt> <code>check</code></dt>
<dd><p>Check add-on packages.
</p></dd>
<dt> <code>LINK</code></dt>
<dd><p>(UNIX only) Front-end for creating executable programs.
</p></dd>
<dt> <code>Rprof</code></dt>
<dd><p>Post-process R profiling files.
</p></dd>
<dt> <code>Rdconv</code></dt>
<dt> <code>Rd2txt</code></dt>
<dd><p>Convert Rd format to various other formats, including <acronym>HTML</acronym>, LaTeX,
plain text, and extracting the examples.  <code>Rd2txt</code> can be used as
shorthand for <code>Rd2conv -t txt</code>.
</p></dd>
<dt> <code>Rd2pdf</code></dt>
<dd><p>Convert Rd format to PDF.
</p></dd>
<dt> <code>Stangle</code></dt>
<dd><p>Extract S/R code from Sweave documentation
</p></dd>
<dt> <code>Sweave</code></dt>
<dd><p>Process Sweave documentation
</p></dd>
<dt> <code>Rdiff</code></dt>
<dd><p>Diff R output ignoring headers etc
</p></dd>
<dt> <code>config</code></dt>
<dd><p>Obtain configuration information
</p></dd>
<dt> <code>javareconf</code></dt>
<dd><p>(Unix only) Update the Java configuration variables
</p></dd>
<dt> <code>rtags</code></dt>
<dd><p>(Unix only) Create Emacs-style tag files from C, R, and Rd files
</p></dd>
<dt> <code>open</code></dt>
<dd><p>(Windows only) Open a file via Windows&rsquo; file associations
</p></dd>
<dt> <code>texify</code></dt>
<dd><p>(Windows only) Process (La)TeX files with R&rsquo;s style files
</p></dd>
</dl>

<p>Use
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">R CMD <var>command</var> --help
</pre></td></tr></table>

<p>to obtain usage information for each of the tools accessible via the
<code>R CMD</code> interface.
</p>
<p>In addition, you can use<a name="DOCF26" href="#FOOT26">(26)</a>  options
&lsquo;<samp>--arch=</samp>&rsquo;, &lsquo;<samp>--no-environ</samp>&rsquo;, &lsquo;<samp>--no-init-file</samp>&rsquo;,
&lsquo;<samp>--no-site-file</samp>&rsquo; and &lsquo;<samp>--vanilla</samp>&rsquo; between <code>R</code> and
<code>CMD</code>: these affect any R processes run by the tools.  (Here
&lsquo;<samp>--vanilla</samp>&rsquo; is equivalent to &lsquo;<samp>--no-environ --no-site-file
--no-init-file</samp>&rsquo;.)  However, note that <code>R CMD</code> does not of itself
use any R startup files (in particular, neither user nor site
&lsquo;<tt>Renviron</tt>&rsquo; files), and all of the R processes run by these tools
(except <code>BATCH</code>) use &lsquo;<samp>--no-restore</samp>&rsquo;.  Most use
&lsquo;<samp>--vanilla</samp>&rsquo; and so invoke no R startup files: the current
exceptions are <code>INSTALL</code>, <code>REMOVE</code>, <code>Sweave</code> and
<code>SHLIB</code> (which uses &lsquo;<samp>--no-site-file --no-init-file</samp>&rsquo;).
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">R CMD <var>cmd</var> <var>args</var>
</pre></td></tr></table>

<p>for any other executable <code><var>cmd</var></code> on the path or given by an
absolute filepath: this is useful to have the same environment as R
or the specific commands run under, for example to run <code>ldd</code> or
<code>pdflatex</code>.  Under Windows <var>cmd</var> can be an executable or a
batch file, or if it has extension <code>.sh</code> or <code>.pl</code> the
appropriate interpreter (if available) is called to run it.
</p>

<hr size="6">
<a name="Invoking-R-under-Windows"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Invoking-R-from-the-command-line" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Invoking-R-under-Mac-OS-X" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Invoking-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Invoking-R" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#The-command_002dline-editor" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Invoking-R-under-Windows-1"></a>
<h2 class="appendixsec">B.2 Invoking R under Windows</h2>

<p>There are two ways to run R under Windows.  Within a terminal window
(e.g.&nbsp;<code>cmd.exe</code> or a more capable shell), the methods described in
the previous section may be used, invoking by <code>R.exe</code> or more
directly by <code>Rterm.exe</code>.  For interactive use, there is a
console-based GUI (<code>Rgui.exe</code>).
</p>
<p>The startup procedure under Windows is very similar to that under
UNIX, but references to the &lsquo;home directory&rsquo; need to be clarified, as
this is not always defined on Windows.  If the environment variable
<code>R_USER</code> is defined, that gives the home directory.  Next, if the
environment variable <code>HOME</code> is defined, that gives the home
directory.  After those two user-controllable settings, R tries to
find system defined home directories.  It first tries to use the
Windows &quot;personal&quot; directory (typically <code>C:\Documents and
Settings\username\My Documents</code> in Windows XP).  If that fails, and
environment variables <code>HOMEDRIVE</code> and <code>HOMEPATH</code> are defined
(and they normally are) these define the home directory.  Failing all
those, the home directory is taken to be the starting directory.
</p>
<p>You need to ensure that either the environment variables <code>TMPDIR</code>,
<code>TMP</code> and <code>TEMP</code> are either unset or one of them points to a
valid place to create temporary files and directories.
</p>
<p>Environment variables can be supplied as &lsquo;<samp><var>name</var>=<var>value</var></samp>&rsquo;
pairs on the command line.
</p>
<p>If there is an argument ending &lsquo;<tt>.RData</tt>&rsquo; (in any case) it is
interpreted as the path to the workspace to be restored: it implies
&lsquo;<samp>--restore</samp>&rsquo; and sets the working directory to the parent of the
named file.  (This mechanism is used for drag-and-drop and file
association with <code>RGui.exe</code>, but also works for <code>Rterm.exe</code>.
If the named file does not exist it sets the working directory
if the parent directory exists.)
</p>
<p>The following additional command-line options are available when
invoking <code>RGui.exe</code>.
</p>
<dl compact="compact">
<dt> &lsquo;<samp>--mdi</samp>&rsquo;</dt>
<dt> &lsquo;<samp>--sdi</samp>&rsquo;</dt>
<dt> &lsquo;<samp>--no-mdi</samp>&rsquo;</dt>
<dd><p>Control whether <code>Rgui</code> will operate as an MDI program 
(with multiple child windows within one main window) or an SDI application
(with multiple top-level windows for the console, graphics and pager).  The 
command-line setting overrides the setting in the user&rsquo;s &lsquo;<tt>Rconsole</tt>&rsquo; file.
</p>
</dd>
<dt> &lsquo;<samp>--debug</samp>&rsquo;</dt>
<dd><p>Enable the &ldquo;Break to debugger&rdquo; menu item in <code>Rgui</code>, and trigger
a break to the debugger during command line processing.
</p></dd>
</dl>

<p>Under Windows with <code>R CMD</code> you may also specify your own
&lsquo;<tt>.bat</tt>&rsquo;, &lsquo;<tt>.exe</tt>&rsquo;, &lsquo;<tt>.sh</tt>&rsquo; or &lsquo;<tt>.pl</tt>&rsquo; file.  It will be run
under the appropriate interpreter (Perl for &lsquo;<tt>.pl</tt>&rsquo;) with several
environment variables set appropriately, including <code>R_HOME</code>,
<code>R_OSTYPE</code>, <code>PATH</code>, <code>BSTINPUTS</code> and <code>TEXINPUTS</code>.  For
example, if you already have &lsquo;<tt>latex.exe</tt>&rsquo; on your path, then
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">R CMD latex.exe mydoc
</pre></td></tr></table>
<p>will run LaTeX on &lsquo;<tt>mydoc.tex</tt>&rsquo;, with the path to R&rsquo;s
&lsquo;<tt>share/texmf</tt>&rsquo; macros appended to <code>TEXINPUTS</code>.  (Unfortunately,
this does not help with the MiKTeX build of LaTeX, but
<code>R CMD texify mydoc</code> will work in that case.)
</p>
<hr size="6">
<a name="Invoking-R-under-Mac-OS-X"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Invoking-R-under-Windows" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Scripting-with-R" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Invoking-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Invoking-R" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#The-command_002dline-editor" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Invoking-R-under-Mac-OS-X-1"></a>
<h2 class="appendixsec">B.3 Invoking R under Mac OS X</h2>

<p>There are two ways to run R under Mac OS X.  Within a <code>Terminal.app</code>
window by invoking <code>R</code>, the methods described in the first
subsection apply.  There is also console-based GUI (<code>R.app</code>) that by
default is installed in the <code>Applications</code> folder on your
system.  It is a standard double-clickable Mac OS X application.
</p>
<p>The startup procedure under Mac OS X is very similar to that under UNIX.
The &lsquo;home directory&rsquo; is the one inside the R.framework, but the startup
and current working directory are set as the user&rsquo;s home directory
unless a different startup directory is given in the Preferences window
accessible from within the GUI.
</p>
<hr size="6">
<a name="Scripting-with-R"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Invoking-R-under-Mac-OS-X" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-command_002dline-editor" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Invoking-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Invoking-R" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#The-command_002dline-editor" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Scripting-with-R-1"></a>
<h2 class="appendixsec">B.4 Scripting with R</h2>

<p>If you just want to run a file &lsquo;<tt>foo.R</tt>&rsquo; of R commands, the
recommended way is to use <code>R CMD BATCH foo.R</code>.  If you want to
run this in the background or as a batch job use OS-specific facilities
to do so: for example in most shells on Unix-alike OSes <code>R CMD
BATCH foo.R &amp;</code> runs a background job.
</p>
<p>You can pass parameters to scripts via additional arguments on the
command line: for example (where the exact quoting needed will depend on
the shell in use)
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">R CMD BATCH &quot;--args arg1 arg2&quot; foo.R &amp;
</pre></td></tr></table>

<p>will pass arguments to a script which can be retrieved as a character
vector by
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">args &lt;- commandArgs(TRUE)
</pre></td></tr></table>

<p>This is made simpler by the alternative front-end <code>Rscript</code>,
which can be invoked by
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">Rscript foo.R arg1 arg2
</pre></td></tr></table>

<p>and this can also be used to write executable script files like (at
least on Unix-alikes, and in some Windows shells)
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">#! /path/to/Rscript
args &lt;- commandArgs(TRUE)
...
q(status=&lt;exit status code&gt;)
</pre></td></tr></table>

<p>If this is entered into a text file &lsquo;<tt>runfoo</tt>&rsquo; and this is made
executable (by <code>chmod 755 runfoo</code>), it can be invoked for
different arguments by
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">runfoo arg1 arg2
</pre></td></tr></table>

<p>For further options see <code>help(&quot;Rscript&quot;)</code>.  This writes R
output to &lsquo;<tt>stdout</tt>&rsquo; and &lsquo;<tt>stderr</tt>&rsquo;, and this can be redirected in
the usual way for the shell running the command.
</p>
<p>If you do not wish to hardcode the path to <code>Rscript</code> but have it
in your path (which is normally the case for an installed R except on
Windows, but e.g. Mac OS X users may need to add &lsquo;<tt>/usr/local/bin</tt>&rsquo;
to their path), use
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">#! /usr/bin/env Rscript
...
</pre></td></tr></table>

<p>At least in Bourne and bash shells, the <code>#!</code> mechanism does
<strong>not</strong> allow extra arguments like 
<code>#! /usr/bin/env Rscript --vanilla</code>.
</p>
<p>One thing to consider is what <code>stdin()</code> refers to.  It is
commonplace to write R scripts with segments like
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">chem &lt;- scan(n=24)
2.90 3.10 3.40 3.40 3.70 3.70 2.80 2.50 2.40 2.40 2.70 2.20
5.28 3.37 3.03 3.03 28.95 3.77 3.40 2.20 3.50 3.60 3.70 3.70
</pre></td></tr></table>

<p>and <code>stdin()</code> refers to the script file to allow such traditional
usage.  If you want to refer to the process&rsquo;s &lsquo;<tt>stdin</tt>&rsquo;, use
<code>&quot;stdin&quot;</code> as a <code>file</code> connection, e.g. <code>scan(&quot;stdin&quot;, ...)</code>.
</p>
<p>Another way to write executable script files (suggested by Fran&ccedil;ois
Pinard) is to use a <em>here document</em> like
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">#!/bin/sh
[environment variables can be set here]
R --slave [other options] &lt;&lt;EOF

   R program goes here...

EOF
</pre></td></tr></table>

<p>but here <code>stdin()</code> refers to the program source and
<code>&quot;stdin&quot;</code> will not be usable.
</p>
<p>Very short scripts can be passed to <code>Rscript</code> on the
command-line via the &lsquo;<samp>-e</samp>&rsquo; flag.
</p>
<p>Note that on a Unix-alike the input filename (such as &lsquo;<tt>foo.R</tt>&rsquo;)
should not contain spaces nor shell metacharacters.
</p>

<hr size="6">
<a name="The-command_002dline-editor"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Scripting-with-R" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Preliminaries" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Invoking-R" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-command_002dline-editor-1"></a>
<h1 class="appendix">C. The command-line editor</h1>

<hr size="6">
<a name="Preliminaries"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-command_002dline-editor" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Editing-actions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-command_002dline-editor" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-command_002dline-editor" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="appendixsection">C.1 Preliminaries</h2>

<p>When the <acronym>GNU</acronym> <strong>readline</strong> library is available at the
time R is configured for compilation under UNIX, an inbuilt command
line editor allowing recall, editing and re-submission of prior commands
is used.  Note that other versions of <strong>readline</strong> exist and may be
used by the inbuilt command line editor: this used to happen on Mac OS X.
</p>
<p>It can be disabled (useful for usage with <acronym>ESS</acronym> <a name="DOCF27" href="#FOOT27">(27)</a>) using the startup option
&lsquo;<samp>--no-readline</samp>&rsquo;.
</p>
<p>Windows versions of R have somewhat simpler command-line editing: see
&lsquo;<samp>Console</samp>&rsquo; under the &lsquo;<samp>Help</samp>&rsquo; menu of the <acronym>GUI</acronym>, and the
file &lsquo;<tt>README.Rterm</tt>&rsquo; for command-line editing under
<code>Rterm.exe</code>.
</p>
<p>When using R with <strong>readline</strong> capabilities, the functions
described below are available, as well as others (probably) documented
in <code>man readline</code> or <code>info readline</code> on your system.
</p>
<p>Many of these use either Control or Meta characters.  Control
characters, such as <kbd>Control-m</kbd>, are obtained by holding the
&lt;CTRL&gt; down while you press the &lt;m&gt; key, and are written as
<kbd>C-m</kbd> below.  Meta characters, such as <kbd>Meta-b</kbd>, are typed by
holding down &lt;META&gt;<a name="DOCF28" href="#FOOT28">(28)</a> and pressing &lt;b&gt;, and written as <kbd>M-b</kbd>
in the following.  If your terminal does not have a &lt;META&gt; key
enabled, you can still type Meta characters using two-character
sequences starting with <kbd>ESC</kbd>.  Thus, to enter <kbd>M-b</kbd>, you could
type &lt;ESC&gt;&lt;b&gt;.  The <kbd>ESC</kbd> character sequences are also
allowed on terminals with real Meta keys.  Note that case is significant
for Meta characters.
</p>
<hr size="6">
<a name="Editing-actions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Preliminaries" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Command_002dline-editor-summary" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-command_002dline-editor" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-command_002dline-editor" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="appendixsection">C.2 Editing actions</h2>

<p>The R program keeps a history of the command lines you type,
including the erroneous lines, and commands in your history may be
recalled, changed if necessary, and re-submitted as new commands.  In
Emacs-style command-line editing any straight typing you do while in
this editing phase causes the characters to be inserted in the command
you are editing, displacing any characters to the right of the cursor.
In <em>vi</em> mode character insertion mode is started by <kbd>M-i</kbd> or
<kbd>M-a</kbd>, characters are typed and insertion mode is finished by typing
a further &lt;ESC&gt;.  (The default is Emacs-style, and only that is
described here: for <em>vi</em> mode see the <strong>readline</strong>
documentation.)
</p>
<p>Pressing the &lt;RET&gt; command at any time causes the command to be
re-submitted.
</p>
<p>Other editing actions are summarized in the following table.
</p>
<hr size="6">
<a name="Command_002dline-editor-summary"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Editing-actions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-command_002dline-editor" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-command_002dline-editor" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="appendixsection">C.3 Command-line editor summary</h2>

<a name="Command-recall-and-vertical-motion"></a>
<h3 class="subheading">Command recall and vertical motion</h3>

<dl compact="compact">
<dt> <kbd>C-p</kbd></dt>
<dd><p>Go to the previous command (backwards in the history).
</p></dd>
<dt> <kbd>C-n</kbd></dt>
<dd><p>Go to the next command (forwards in the history).
</p></dd>
<dt> <kbd>C-r <var>text</var></kbd></dt>
<dd><p>Find the last command with the <var>text</var> string in it.
</p></dd>
</dl>

<p>On most terminals, you can also use the up and down arrow keys instead
of <kbd>C-p</kbd> and <kbd>C-n</kbd>, respectively.
</p>
<a name="Horizontal-motion-of-the-cursor"></a>
<h3 class="subheading">Horizontal motion of the cursor</h3>

<dl compact="compact">
<dt> <kbd>C-a</kbd></dt>
<dd><p>Go to the beginning of the command.
</p></dd>
<dt> <kbd>C-e</kbd></dt>
<dd><p>Go to the end of the line.
</p></dd>
<dt> <kbd>M-b</kbd></dt>
<dd><p>Go back one word.
</p></dd>
<dt> <kbd>M-f</kbd></dt>
<dd><p>Go forward one word.
</p></dd>
<dt> <kbd>C-b</kbd></dt>
<dd><p>Go back one character.
</p></dd>
<dt> <kbd>C-f</kbd></dt>
<dd><p>Go forward one character.
</p></dd>
</dl>

<p>On most terminals, you can also use the left and right arrow keys
instead of <kbd>C-b</kbd> and <kbd>C-f</kbd>, respectively.
</p>
<a name="Editing-and-re_002dsubmission"></a>
<h3 class="subheading">Editing and re-submission</h3>

<dl compact="compact">
<dt> <kbd><var>text</var></kbd></dt>
<dd><p>Insert <var>text</var> at the cursor.
</p></dd>
<dt> <kbd>C-f <var>text</var></kbd></dt>
<dd><p>Append <var>text</var> after the cursor.
</p></dd>
<dt> <kbd>&lt;DEL&gt;</kbd></dt>
<dd><p>Delete the previous character (left of the cursor).
</p></dd>
<dt> <kbd>C-d</kbd></dt>
<dd><p>Delete the character under the cursor.
</p></dd>
<dt> <kbd>M-d</kbd></dt>
<dd><p>Delete the rest of the word under the cursor, and &ldquo;save&rdquo; it.
</p></dd>
<dt> <kbd>C-k</kbd></dt>
<dd><p>Delete from cursor to end of command, and &ldquo;save&rdquo; it.
</p></dd>
<dt> <kbd>C-y</kbd></dt>
<dd><p>Insert (yank) the last &ldquo;saved&rdquo; text here.
</p></dd>
<dt> <kbd>C-t</kbd></dt>
<dd><p>Transpose the character under the cursor with the next.
</p></dd>
<dt> <kbd>M-l</kbd></dt>
<dd><p>Change the rest of the word to lower case.
</p></dd>
<dt> <kbd>M-c</kbd></dt>
<dd><p>Change the rest of the word to upper case.
</p></dd>
<dt> <kbd>&lt;RET&gt;</kbd></dt>
<dd><p>Re-submit the command to R.
</p></dd>
</dl>

<p>The final &lt;RET&gt; terminates the command line editing sequence.
</p>
<p>The <strong>readline</strong> key bindings can be customized in the usual way
<em>via</em> a &lsquo;<tt>~/.inputrc</tt>&rsquo; file.  As from R 2.12.0, these
customizations can be conditioned on application <code>R</code>, that is
by including a section like
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">$if R
  &quot;\C-xd&quot;: &quot;q('no')\n&quot;
$endif
</pre></td></tr></table>

<hr size="6">
<a name="Function-and-variable-index"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Command_002dline-editor-summary" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-index" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#The-command_002dline-editor" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Function-and-variable-index-1"></a>
<h1 class="appendix">D. Function and variable index</h1>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a href="#Function-and-variable-index-1_vr_symbol-1" class="summary-letter"><b>!</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-2" class="summary-letter"><b>%</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-3" class="summary-letter"><b>&amp;</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-4" class="summary-letter"><b>*</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-5" class="summary-letter"><b>+</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-6" class="summary-letter"><b>-</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-7" class="summary-letter"><b>.</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-8" class="summary-letter"><b>/</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-9" class="summary-letter"><b>:</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-10" class="summary-letter"><b>&lt;</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-11" class="summary-letter"><b>=</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-12" class="summary-letter"><b>&gt;</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-13" class="summary-letter"><b>?</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-14" class="summary-letter"><b>^</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-15" class="summary-letter"><b>|</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-16" class="summary-letter"><b>~</b></a>
 &nbsp; 
<br>
<a href="#Function-and-variable-index-1_vr_letter-A" class="summary-letter"><b>A</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-B" class="summary-letter"><b>B</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-C" class="summary-letter"><b>C</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-D" class="summary-letter"><b>D</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-E" class="summary-letter"><b>E</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-F" class="summary-letter"><b>F</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-G" class="summary-letter"><b>G</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-H" class="summary-letter"><b>H</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-I" class="summary-letter"><b>I</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-J" class="summary-letter"><b>J</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-K" class="summary-letter"><b>K</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-L" class="summary-letter"><b>L</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-M" class="summary-letter"><b>M</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-N" class="summary-letter"><b>N</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-O" class="summary-letter"><b>O</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-P" class="summary-letter"><b>P</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-Q" class="summary-letter"><b>Q</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-R" class="summary-letter"><b>R</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-S" class="summary-letter"><b>S</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-T" class="summary-letter"><b>T</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-U" class="summary-letter"><b>U</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-V" class="summary-letter"><b>V</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-W" class="summary-letter"><b>W</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-X" class="summary-letter"><b>X</b></a>
 &nbsp; 
</td></tr></table>
<table border="0" class="index-vr">
<tr><td></td><th align="left">Index Entry</th><th align="left"> Section</th></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-1">!</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0021"><code>!</code></a></td><td valign="top"><a href="#Logical-vectors">2.4 Logical vectors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0021_003d"><code>!=</code></a></td><td valign="top"><a href="#Logical-vectors">2.4 Logical vectors</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-2">%</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0025_002a_0025"><code>%*%</code></a></td><td valign="top"><a href="#Multiplication">5.7.1 Matrix multiplication</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0025o_0025"><code>%o%</code></a></td><td valign="top"><a href="#The-outer-product-of-two-arrays">5.5 The outer product of two arrays</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-3">&amp;</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0026"><code>&amp;</code></a></td><td valign="top"><a href="#Logical-vectors">2.4 Logical vectors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0026_0026"><code>&amp;&amp;</code></a></td><td valign="top"><a href="#Conditional-execution">9.2.1 Conditional execution: <code>if</code> statements</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-4">*</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002a"><code>*</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-5">+</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002b"><code>+</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-6">-</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d"><code>-</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-7">.</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002e"><code>.</code></a></td><td valign="top"><a href="#Updating-fitted-models">11.5 Updating fitted models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002eFirst"><code>.First</code></a></td><td valign="top"><a href="#Customizing-the-environment">10.8 Customizing the environment</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002eLast"><code>.Last</code></a></td><td valign="top"><a href="#Customizing-the-environment">10.8 Customizing the environment</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-8">/</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002f"><code>/</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-9">:</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_003a"><code>:</code></a></td><td valign="top"><a href="#Generating-regular-sequences">2.3 Generating regular sequences</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_003a_003a"><code>::</code></a></td><td valign="top"><a href="#Namespaces">13.3 Namespaces</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_003a_003a_003a"><code>:::</code></a></td><td valign="top"><a href="#Namespaces">13.3 Namespaces</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-10">&lt;</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_003c"><code>&lt;</code></a></td><td valign="top"><a href="#Logical-vectors">2.4 Logical vectors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_003c_003c_002d"><code>&lt;&lt;-</code></a></td><td valign="top"><a href="#Scope">10.7 Scope</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_003c_003d"><code>&lt;=</code></a></td><td valign="top"><a href="#Logical-vectors">2.4 Logical vectors</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-11">=</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_003d_003d"><code>==</code></a></td><td valign="top"><a href="#Logical-vectors">2.4 Logical vectors</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-12">&gt;</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_003e"><code>&gt;</code></a></td><td valign="top"><a href="#Logical-vectors">2.4 Logical vectors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_003e_003d"><code>&gt;=</code></a></td><td valign="top"><a href="#Logical-vectors">2.4 Logical vectors</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-13">?</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_003f"><code>?</code></a></td><td valign="top"><a href="#Getting-help">1.7 Getting help with functions and features</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_003f_003f"><code>??</code></a></td><td valign="top"><a href="#Getting-help">1.7 Getting help with functions and features</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-14">^</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_005e"><code>^</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-15">|</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_007c"><code>|</code></a></td><td valign="top"><a href="#Logical-vectors">2.4 Logical vectors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_007c_007c"><code>||</code></a></td><td valign="top"><a href="#Conditional-execution">9.2.1 Conditional execution: <code>if</code> statements</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_symbol-16">~</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_007e"><code>~</code></a></td><td valign="top"><a href="#Examples">Examples</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-abline"><code>abline</code></a></td><td valign="top"><a href="#Low_002dlevel-plotting-commands">12.2 Low-level plotting commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ace"><code>ace</code></a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-add1"><code>add1</code></a></td><td valign="top"><a href="#Updating-fitted-models">11.5 Updating fitted models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-anova"><code>anova</code></a></td><td valign="top"><a href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-anova-1"><code>anova</code></a></td><td valign="top"><a href="#ANOVA-tables">11.4.1 ANOVA tables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-aov"><code>aov</code></a></td><td valign="top"><a href="#Analysis-of-variance-and-model-comparison">11.4 Analysis of variance and model comparison</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-aperm"><code>aperm</code></a></td><td valign="top"><a href="#Generalized-transpose-of-an-array">5.6 Generalized transpose of an array</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-array"><code>array</code></a></td><td valign="top"><a href="#The-array_0028_0029-function">5.4 The <code>array()</code> function</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-as_002edata_002eframe"><code>as.data.frame</code></a></td><td valign="top"><a href="#Making-data-frames">6.3.1 Making data frames</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-as_002evector"><code>as.vector</code></a></td><td valign="top"><a href="#The-concatenation-function-c_0028_0029-with-arrays">5.9 The concatenation function, <code>c()</code>, with arrays</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-attach"><code>attach</code></a></td><td valign="top"><a href="#attach_0028_0029-and-detach_0028_0029">6.3.2 <code>attach() and <code>detach()</code></code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-attr"><code>attr</code></a></td><td valign="top"><a href="#Getting-and-setting-attributes">3.3 Getting and setting attributes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-attr-1"><code>attr</code></a></td><td valign="top"><a href="#Getting-and-setting-attributes">3.3 Getting and setting attributes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-attributes"><code>attributes</code></a></td><td valign="top"><a href="#Getting-and-setting-attributes">3.3 Getting and setting attributes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-attributes-1"><code>attributes</code></a></td><td valign="top"><a href="#Getting-and-setting-attributes">3.3 Getting and setting attributes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-avas"><code>avas</code></a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-axis"><code>axis</code></a></td><td valign="top"><a href="#Low_002dlevel-plotting-commands">12.2 Low-level plotting commands</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-B">B</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-boxplot"><code>boxplot</code></a></td><td valign="top"><a href="#One_002d-and-two_002dsample-tests">8.3 One- and two-sample tests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-break"><code>break</code></a></td><td valign="top"><a href="#Repetitive-execution">9.2.2 Repetitive execution: <code>for</code> loops, <code>repeat</code> and <code>while</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-bruto"><code>bruto</code></a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-c"><code>c</code></a></td><td valign="top"><a href="#Vectors-and-assignment">2.1 Vectors and assignment</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-C"><code>C</code></a></td><td valign="top"><a href="#Contrasts">11.1.1 Contrasts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-c-1"><code>c</code></a></td><td valign="top"><a href="#Character-vectors">2.6 Character vectors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-c-2"><code>c</code></a></td><td valign="top"><a href="#The-concatenation-function-c_0028_0029-with-arrays">5.9 The concatenation function, <code>c()</code>, with arrays</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-c-3"><code>c</code></a></td><td valign="top"><a href="#Concatenating-lists">6.2.1 Concatenating lists</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cbind"><code>cbind</code></a></td><td valign="top"><a href="#Forming-partitioned-matrices">5.8 Forming partitioned matrices, <code>cbind()</code> and <code>rbind()</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-coef"><code>coef</code></a></td><td valign="top"><a href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-coefficients"><code>coefficients</code></a></td><td valign="top"><a href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-contour"><code>contour</code></a></td><td valign="top"><a href="#Display-graphics">12.1.3 Display graphics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-contrasts"><code>contrasts</code></a></td><td valign="top"><a href="#Contrasts">11.1.1 Contrasts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-coplot"><code>coplot</code></a></td><td valign="top"><a href="#Displaying-multivariate-data">12.1.2 Displaying multivariate data</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cos"><code>cos</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-crossprod"><code>crossprod</code></a></td><td valign="top"><a href="#Index-matrices">5.3 Index matrices</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-crossprod-1"><code>crossprod</code></a></td><td valign="top"><a href="#Multiplication">5.7.1 Matrix multiplication</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cut"><code>cut</code></a></td><td valign="top"><a href="#Frequency-tables-from-factors">5.10 Frequency tables from factors</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-D">D</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-data"><code>data</code></a></td><td valign="top"><a href="#Accessing-builtin-datasets">7.3 Accessing builtin datasets</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-data_002eframe"><code>data.frame</code></a></td><td valign="top"><a href="#Making-data-frames">6.3.1 Making data frames</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-density"><code>density</code></a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-det"><code>det</code></a></td><td valign="top"><a href="#Singular-value-decomposition-and-determinants">5.7.4 Singular value decomposition and determinants</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-detach"><code>detach</code></a></td><td valign="top"><a href="#attach_0028_0029-and-detach_0028_0029">6.3.2 <code>attach() and <code>detach()</code></code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-determinant"><code>determinant</code></a></td><td valign="top"><a href="#Singular-value-decomposition-and-determinants">5.7.4 Singular value decomposition and determinants</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dev_002elist"><code>dev.list</code></a></td><td valign="top"><a href="#Multiple-graphics-devices">12.6.2 Multiple graphics devices</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dev_002enext"><code>dev.next</code></a></td><td valign="top"><a href="#Multiple-graphics-devices">12.6.2 Multiple graphics devices</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dev_002eoff"><code>dev.off</code></a></td><td valign="top"><a href="#Multiple-graphics-devices">12.6.2 Multiple graphics devices</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dev_002eprev"><code>dev.prev</code></a></td><td valign="top"><a href="#Multiple-graphics-devices">12.6.2 Multiple graphics devices</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dev_002eset"><code>dev.set</code></a></td><td valign="top"><a href="#Multiple-graphics-devices">12.6.2 Multiple graphics devices</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-deviance"><code>deviance</code></a></td><td valign="top"><a href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-diag"><code>diag</code></a></td><td valign="top"><a href="#Multiplication">5.7.1 Matrix multiplication</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dim"><code>dim</code></a></td><td valign="top"><a href="#Arrays">5.1 Arrays</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotchart"><code>dotchart</code></a></td><td valign="top"><a href="#Display-graphics">12.1.3 Display graphics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-drop1"><code>drop1</code></a></td><td valign="top"><a href="#Updating-fitted-models">11.5 Updating fitted models</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-E">E</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-ecdf"><code>ecdf</code></a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-edit"><code>edit</code></a></td><td valign="top"><a href="#Editing-data">7.4 Editing data</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-eigen"><code>eigen</code></a></td><td valign="top"><a href="#Eigenvalues-and-eigenvectors">5.7.3 Eigenvalues and eigenvectors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-else"><code>else</code></a></td><td valign="top"><a href="#Conditional-execution">9.2.1 Conditional execution: <code>if</code> statements</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Error"><code>Error</code></a></td><td valign="top"><a href="#Analysis-of-variance-and-model-comparison">11.4 Analysis of variance and model comparison</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-example"><code>example</code></a></td><td valign="top"><a href="#Getting-help">1.7 Getting help with functions and features</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-exp"><code>exp</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-F"><code>F</code></a></td><td valign="top"><a href="#Logical-vectors">2.4 Logical vectors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-factor"><code>factor</code></a></td><td valign="top"><a href="#A-specific-example">4.1 A specific example</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-FALSE"><code>FALSE</code></a></td><td valign="top"><a href="#Logical-vectors">2.4 Logical vectors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-fivenum"><code>fivenum</code></a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-for"><code>for</code></a></td><td valign="top"><a href="#Repetitive-execution">9.2.2 Repetitive execution: <code>for</code> loops, <code>repeat</code> and <code>while</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-formula"><code>formula</code></a></td><td valign="top"><a href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-function"><code>function</code></a></td><td valign="top"><a href="#Writing-your-own-functions">10. Writing your own functions</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-G">G</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-getAnywhere"><code>getAnywhere</code></a></td><td valign="top"><a href="#Object-orientation">10.9 Classes, generic functions and object orientation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-getS3method"><code>getS3method</code></a></td><td valign="top"><a href="#Object-orientation">10.9 Classes, generic functions and object orientation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-glm"><code>glm</code></a></td><td valign="top"><a href="#The-glm_0028_0029-function">11.6.2 The <code>glm()</code> function</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-H">H</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-help"><code>help</code></a></td><td valign="top"><a href="#Getting-help">1.7 Getting help with functions and features</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-help-1"><code>help</code></a></td><td valign="top"><a href="#Getting-help">1.7 Getting help with functions and features</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-help_002esearch"><code>help.search</code></a></td><td valign="top"><a href="#Getting-help">1.7 Getting help with functions and features</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-help_002estart"><code>help.start</code></a></td><td valign="top"><a href="#Getting-help">1.7 Getting help with functions and features</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-hist"><code>hist</code></a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-hist-1"><code>hist</code></a></td><td valign="top"><a href="#Display-graphics">12.1.3 Display graphics</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-I">I</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-identify"><code>identify</code></a></td><td valign="top"><a href="#Interacting-with-graphics">12.3 Interacting with graphics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-if"><code>if</code></a></td><td valign="top"><a href="#Conditional-execution">9.2.1 Conditional execution: <code>if</code> statements</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-if-1"><code>if</code></a></td><td valign="top"><a href="#Conditional-execution">9.2.1 Conditional execution: <code>if</code> statements</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ifelse"><code>ifelse</code></a></td><td valign="top"><a href="#Conditional-execution">9.2.1 Conditional execution: <code>if</code> statements</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-image"><code>image</code></a></td><td valign="top"><a href="#Display-graphics">12.1.3 Display graphics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-is_002ena"><code>is.na</code></a></td><td valign="top"><a href="#Missing-values">2.5 Missing values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-is_002enan"><code>is.nan</code></a></td><td valign="top"><a href="#Missing-values">2.5 Missing values</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-J">J</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-jpeg"><code>jpeg</code></a></td><td valign="top"><a href="#Device-drivers">12.6 Device drivers</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-K">K</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-ks_002etest"><code>ks.test</code></a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-L">L</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-legend"><code>legend</code></a></td><td valign="top"><a href="#Low_002dlevel-plotting-commands">12.2 Low-level plotting commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-length"><code>length</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-length-1"><code>length</code></a></td><td valign="top"><a href="#The-intrinsic-attributes-mode-and-length">3.1 Intrinsic attributes: mode and length</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-levels"><code>levels</code></a></td><td valign="top"><a href="#A-specific-example">4.1 A specific example</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-lines"><code>lines</code></a></td><td valign="top"><a href="#Low_002dlevel-plotting-commands">12.2 Low-level plotting commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-list"><code>list</code></a></td><td valign="top"><a href="#Lists">6.1 Lists</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-lm"><code>lm</code></a></td><td valign="top"><a href="#Linear-models">11.2 Linear models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-lme"><code>lme</code></a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-locator"><code>locator</code></a></td><td valign="top"><a href="#Interacting-with-graphics">12.3 Interacting with graphics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-loess"><code>loess</code></a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-loess-1"><code>loess</code></a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-log"><code>log</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-lqs"><code>lqs</code></a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-lsfit"><code>lsfit</code></a></td><td valign="top"><a href="#Least-squares-fitting-and-the-QR-decomposition">5.7.5 Least squares fitting and the QR decomposition</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-mars"><code>mars</code></a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-max"><code>max</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mean"><code>mean</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-methods"><code>methods</code></a></td><td valign="top"><a href="#Object-orientation">10.9 Classes, generic functions and object orientation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-min"><code>min</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mode"><code>mode</code></a></td><td valign="top"><a href="#The-intrinsic-attributes-mode-and-length">3.1 Intrinsic attributes: mode and length</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-N">N</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-NA"><code>NA</code></a></td><td valign="top"><a href="#Missing-values">2.5 Missing values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-NaN"><code>NaN</code></a></td><td valign="top"><a href="#Missing-values">2.5 Missing values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ncol"><code>ncol</code></a></td><td valign="top"><a href="#Matrix-facilities">5.7 Matrix facilities</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-next"><code>next</code></a></td><td valign="top"><a href="#Repetitive-execution">9.2.2 Repetitive execution: <code>for</code> loops, <code>repeat</code> and <code>while</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-nlm"><code>nlm</code></a></td><td valign="top"><a href="#Nonlinear-least-squares-and-maximum-likelihood-models">11.7 Nonlinear least squares and maximum likelihood models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-nlm-1"><code>nlm</code></a></td><td valign="top"><a href="#Least-squares">11.7.1 Least squares</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-nlm-2"><code>nlm</code></a></td><td valign="top"><a href="#Maximum-likelihood">11.7.2 Maximum likelihood</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-nlme"><code>nlme</code></a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-nlminb"><code>nlminb</code></a></td><td valign="top"><a href="#Nonlinear-least-squares-and-maximum-likelihood-models">11.7 Nonlinear least squares and maximum likelihood models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-nrow"><code>nrow</code></a></td><td valign="top"><a href="#Matrix-facilities">5.7 Matrix facilities</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-O">O</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-optim"><code>optim</code></a></td><td valign="top"><a href="#Nonlinear-least-squares-and-maximum-likelihood-models">11.7 Nonlinear least squares and maximum likelihood models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-order"><code>order</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ordered"><code>ordered</code></a></td><td valign="top"><a href="#Ordered-factors">4.3 Ordered factors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ordered-1"><code>ordered</code></a></td><td valign="top"><a href="#Ordered-factors">4.3 Ordered factors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-outer"><code>outer</code></a></td><td valign="top"><a href="#The-outer-product-of-two-arrays">5.5 The outer product of two arrays</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-P">P</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-pairs"><code>pairs</code></a></td><td valign="top"><a href="#Displaying-multivariate-data">12.1.2 Displaying multivariate data</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-par"><code>par</code></a></td><td valign="top"><a href="#The-par_0028_0029-function">12.4.1 Permanent changes: The <code>par()</code> function</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-paste"><code>paste</code></a></td><td valign="top"><a href="#Character-vectors">2.6 Character vectors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pdf"><code>pdf</code></a></td><td valign="top"><a href="#Device-drivers">12.6 Device drivers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-persp"><code>persp</code></a></td><td valign="top"><a href="#Display-graphics">12.1.3 Display graphics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-plot"><code>plot</code></a></td><td valign="top"><a href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-plot-1"><code>plot</code></a></td><td valign="top"><a href="#The-plot_0028_0029-function">12.1.1 The <code>plot()</code> function</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pmax"><code>pmax</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pmin"><code>pmin</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-png"><code>png</code></a></td><td valign="top"><a href="#Device-drivers">12.6 Device drivers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-points"><code>points</code></a></td><td valign="top"><a href="#Low_002dlevel-plotting-commands">12.2 Low-level plotting commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-polygon"><code>polygon</code></a></td><td valign="top"><a href="#Low_002dlevel-plotting-commands">12.2 Low-level plotting commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-postscript"><code>postscript</code></a></td><td valign="top"><a href="#Device-drivers">12.6 Device drivers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-predict"><code>predict</code></a></td><td valign="top"><a href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-print"><code>print</code></a></td><td valign="top"><a href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-prod"><code>prod</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-Q">Q</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-qqline"><code>qqline</code></a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-qqline-1"><code>qqline</code></a></td><td valign="top"><a href="#Display-graphics">12.1.3 Display graphics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-qqnorm"><code>qqnorm</code></a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-qqnorm-1"><code>qqnorm</code></a></td><td valign="top"><a href="#Display-graphics">12.1.3 Display graphics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-qqplot"><code>qqplot</code></a></td><td valign="top"><a href="#Display-graphics">12.1.3 Display graphics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-qr"><code>qr</code></a></td><td valign="top"><a href="#Least-squares-fitting-and-the-QR-decomposition">5.7.5 Least squares fitting and the QR decomposition</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-quartz"><code>quartz</code></a></td><td valign="top"><a href="#Device-drivers">12.6 Device drivers</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-range"><code>range</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-rbind"><code>rbind</code></a></td><td valign="top"><a href="#Forming-partitioned-matrices">5.8 Forming partitioned matrices, <code>cbind()</code> and <code>rbind()</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-read_002etable"><code>read.table</code></a></td><td valign="top"><a href="#The-read_002etable_0028_0029-function">7.1 The <code>read.table()</code> function</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-rep"><code>rep</code></a></td><td valign="top"><a href="#Generating-regular-sequences">2.3 Generating regular sequences</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-repeat"><code>repeat</code></a></td><td valign="top"><a href="#Repetitive-execution">9.2.2 Repetitive execution: <code>for</code> loops, <code>repeat</code> and <code>while</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-resid"><code>resid</code></a></td><td valign="top"><a href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-residuals"><code>residuals</code></a></td><td valign="top"><a href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-rlm"><code>rlm</code></a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-rm"><code>rm</code></a></td><td valign="top"><a href="#Data-permanency-and-removing-objects">1.11 Data permanency and removing objects</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-scan"><code>scan</code></a></td><td valign="top"><a href="#The-scan_0028_0029-function">7.2 The <code>scan()</code> function</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sd"><code>sd</code></a></td><td valign="top"><a href="#The-function-tapply_0028_0029-and-ragged-arrays">4.2 The function <code>tapply()</code> and ragged arrays</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-search"><code>search</code></a></td><td valign="top"><a href="#Managing-the-search-path">6.3.5 Managing the search path</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-seq"><code>seq</code></a></td><td valign="top"><a href="#Generating-regular-sequences">2.3 Generating regular sequences</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-shapiro_002etest"><code>shapiro.test</code></a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sin"><code>sin</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sink"><code>sink</code></a></td><td valign="top"><a href="#Executing-commands-from-or-diverting-output-to-a-file">1.10 Executing commands from or diverting output to a file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-solve"><code>solve</code></a></td><td valign="top"><a href="#Linear-equations-and-inversion">5.7.2 Linear equations and inversion</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sort"><code>sort</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-source"><code>source</code></a></td><td valign="top"><a href="#Executing-commands-from-or-diverting-output-to-a-file">1.10 Executing commands from or diverting output to a file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-split"><code>split</code></a></td><td valign="top"><a href="#Repetitive-execution">9.2.2 Repetitive execution: <code>for</code> loops, <code>repeat</code> and <code>while</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sqrt"><code>sqrt</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stem"><code>stem</code></a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-step"><code>step</code></a></td><td valign="top"><a href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-step-1"><code>step</code></a></td><td valign="top"><a href="#Updating-fitted-models">11.5 Updating fitted models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sum"><code>sum</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-summary"><code>summary</code></a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-summary-1"><code>summary</code></a></td><td valign="top"><a href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-svd"><code>svd</code></a></td><td valign="top"><a href="#Singular-value-decomposition-and-determinants">5.7.4 Singular value decomposition and determinants</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-T"><code>T</code></a></td><td valign="top"><a href="#Logical-vectors">2.4 Logical vectors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-t"><code>t</code></a></td><td valign="top"><a href="#Generalized-transpose-of-an-array">5.6 Generalized transpose of an array</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-t_002etest"><code>t.test</code></a></td><td valign="top"><a href="#One_002d-and-two_002dsample-tests">8.3 One- and two-sample tests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-table"><code>table</code></a></td><td valign="top"><a href="#Index-matrices">5.3 Index matrices</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-table-1"><code>table</code></a></td><td valign="top"><a href="#Frequency-tables-from-factors">5.10 Frequency tables from factors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tan"><code>tan</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tapply"><code>tapply</code></a></td><td valign="top"><a href="#The-function-tapply_0028_0029-and-ragged-arrays">4.2 The function <code>tapply()</code> and ragged arrays</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-text"><code>text</code></a></td><td valign="top"><a href="#Low_002dlevel-plotting-commands">12.2 Low-level plotting commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-title"><code>title</code></a></td><td valign="top"><a href="#Low_002dlevel-plotting-commands">12.2 Low-level plotting commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tree"><code>tree</code></a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TRUE"><code>TRUE</code></a></td><td valign="top"><a href="#Logical-vectors">2.4 Logical vectors</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-U">U</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-unclass"><code>unclass</code></a></td><td valign="top"><a href="#The-class-of-an-object">3.4 The class of an object</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-update"><code>update</code></a></td><td valign="top"><a href="#Updating-fitted-models">11.5 Updating fitted models</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-V">V</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-var"><code>var</code></a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-var-1"><code>var</code></a></td><td valign="top"><a href="#The-function-tapply_0028_0029-and-ragged-arrays">4.2 The function <code>tapply()</code> and ragged arrays</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-var_002etest"><code>var.test</code></a></td><td valign="top"><a href="#One_002d-and-two_002dsample-tests">8.3 One- and two-sample tests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-vcov"><code>vcov</code></a></td><td valign="top"><a href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-vector"><code>vector</code></a></td><td valign="top"><a href="#Vectors-and-assignment">2.1 Vectors and assignment</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-W">W</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-while"><code>while</code></a></td><td valign="top"><a href="#Repetitive-execution">9.2.2 Repetitive execution: <code>for</code> loops, <code>repeat</code> and <code>while</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-wilcox_002etest"><code>wilcox.test</code></a></td><td valign="top"><a href="#One_002d-and-two_002dsample-tests">8.3 One- and two-sample tests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-windows"><code>windows</code></a></td><td valign="top"><a href="#Device-drivers">12.6 Device drivers</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-variable-index-1_vr_letter-X">X</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-X11"><code>X11</code></a></td><td valign="top"><a href="#Device-drivers">12.6 Device drivers</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a href="#Function-and-variable-index-1_vr_symbol-1" class="summary-letter"><b>!</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-2" class="summary-letter"><b>%</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-3" class="summary-letter"><b>&amp;</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-4" class="summary-letter"><b>*</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-5" class="summary-letter"><b>+</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-6" class="summary-letter"><b>-</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-7" class="summary-letter"><b>.</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-8" class="summary-letter"><b>/</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-9" class="summary-letter"><b>:</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-10" class="summary-letter"><b>&lt;</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-11" class="summary-letter"><b>=</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-12" class="summary-letter"><b>&gt;</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-13" class="summary-letter"><b>?</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-14" class="summary-letter"><b>^</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-15" class="summary-letter"><b>|</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_symbol-16" class="summary-letter"><b>~</b></a>
 &nbsp; 
<br>
<a href="#Function-and-variable-index-1_vr_letter-A" class="summary-letter"><b>A</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-B" class="summary-letter"><b>B</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-C" class="summary-letter"><b>C</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-D" class="summary-letter"><b>D</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-E" class="summary-letter"><b>E</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-F" class="summary-letter"><b>F</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-G" class="summary-letter"><b>G</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-H" class="summary-letter"><b>H</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-I" class="summary-letter"><b>I</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-J" class="summary-letter"><b>J</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-K" class="summary-letter"><b>K</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-L" class="summary-letter"><b>L</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-M" class="summary-letter"><b>M</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-N" class="summary-letter"><b>N</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-O" class="summary-letter"><b>O</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-P" class="summary-letter"><b>P</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-Q" class="summary-letter"><b>Q</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-R" class="summary-letter"><b>R</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-S" class="summary-letter"><b>S</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-T" class="summary-letter"><b>T</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-U" class="summary-letter"><b>U</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-V" class="summary-letter"><b>V</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-W" class="summary-letter"><b>W</b></a>
 &nbsp; 
<a href="#Function-and-variable-index-1_vr_letter-X" class="summary-letter"><b>X</b></a>
 &nbsp; 
</td></tr></table>

<hr size="6">
<a name="Concept-index"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#References" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#References" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Concept-index-1"></a>
<h1 class="appendix">E. Concept index</h1>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a href="#Concept-index-1_cp_letter-A" class="summary-letter"><b>A</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-B" class="summary-letter"><b>B</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-C" class="summary-letter"><b>C</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-D" class="summary-letter"><b>D</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-E" class="summary-letter"><b>E</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-F" class="summary-letter"><b>F</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-G" class="summary-letter"><b>G</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-I" class="summary-letter"><b>I</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-K" class="summary-letter"><b>K</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-L" class="summary-letter"><b>L</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-M" class="summary-letter"><b>M</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-N" class="summary-letter"><b>N</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-O" class="summary-letter"><b>O</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-P" class="summary-letter"><b>P</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-Q" class="summary-letter"><b>Q</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-R" class="summary-letter"><b>R</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-S" class="summary-letter"><b>S</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-T" class="summary-letter"><b>T</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-U" class="summary-letter"><b>U</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-V" class="summary-letter"><b>V</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-W" class="summary-letter"><b>W</b></a>
 &nbsp; 
</td></tr></table>
<table border="0" class="index-cp">
<tr><td></td><th align="left">Index Entry</th><th align="left"> Section</th></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Accessing-builtin-datasets">Accessing builtin datasets</a></td><td valign="top"><a href="#Accessing-builtin-datasets">7.3 Accessing builtin datasets</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Additive-models">Additive models</a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Analysis-of-variance">Analysis of variance</a></td><td valign="top"><a href="#Analysis-of-variance-and-model-comparison">11.4 Analysis of variance and model comparison</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Arithmetic-functions-and-operators">Arithmetic functions and operators</a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Arrays">Arrays</a></td><td valign="top"><a href="#Arrays">5.1 Arrays</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Assignment">Assignment</a></td><td valign="top"><a href="#Vectors-and-assignment">2.1 Vectors and assignment</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Attributes">Attributes</a></td><td valign="top"><a href="#Objects">3. Objects, their modes and attributes</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-B">B</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Binary-operators">Binary operators</a></td><td valign="top"><a href="#Defining-new-binary-operators">10.2 Defining new binary operators</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Box-plots">Box plots</a></td><td valign="top"><a href="#One_002d-and-two_002dsample-tests">8.3 One- and two-sample tests</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Character-vectors">Character vectors</a></td><td valign="top"><a href="#Character-vectors">2.6 Character vectors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Classes">Classes</a></td><td valign="top"><a href="#The-class-of-an-object">3.4 The class of an object</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Classes-1">Classes</a></td><td valign="top"><a href="#Object-orientation">10.9 Classes, generic functions and object orientation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Concatenating-lists">Concatenating lists</a></td><td valign="top"><a href="#Concatenating-lists">6.2.1 Concatenating lists</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Contrasts">Contrasts</a></td><td valign="top"><a href="#Contrasts">11.1.1 Contrasts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Control-statements">Control statements</a></td><td valign="top"><a href="#Control-statements">9.2 Control statements</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-CRAN">CRAN</a></td><td valign="top"><a href="#Contributed-packages-and-CRAN">13.2 Contributed packages and <acronym>CRAN</acronym></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Customizing-the-environment">Customizing the environment</a></td><td valign="top"><a href="#Customizing-the-environment">10.8 Customizing the environment</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-D">D</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Data-frames">Data frames</a></td><td valign="top"><a href="#Data-frames">6.3 Data frames</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Default-values">Default values</a></td><td valign="top"><a href="#Named-arguments-and-defaults">10.3 Named arguments and defaults</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Density-estimation">Density estimation</a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Determinants">Determinants</a></td><td valign="top"><a href="#Singular-value-decomposition-and-determinants">5.7.4 Singular value decomposition and determinants</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Diverting-input-and-output">Diverting input and output</a></td><td valign="top"><a href="#Executing-commands-from-or-diverting-output-to-a-file">1.10 Executing commands from or diverting output to a file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dynamic-graphics">Dynamic graphics</a></td><td valign="top"><a href="#Dynamic-graphics">12.7 Dynamic graphics</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-E">E</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Eigenvalues-and-eigenvectors">Eigenvalues and eigenvectors</a></td><td valign="top"><a href="#Eigenvalues-and-eigenvectors">5.7.3 Eigenvalues and eigenvectors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Empirical-CDFs">Empirical CDFs</a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Factors">Factors</a></td><td valign="top"><a href="#Factors">4. Ordered and unordered factors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Factors-1">Factors</a></td><td valign="top"><a href="#Contrasts">11.1.1 Contrasts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Families">Families</a></td><td valign="top"><a href="#Families">11.6.1 Families</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Formulae">Formulae</a></td><td valign="top"><a href="#Formulae-for-statistical-models">11.1 Defining statistical models; formulae</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-G">G</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Generalized-linear-models">Generalized linear models</a></td><td valign="top"><a href="#Generalized-linear-models">11.6 Generalized linear models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Generalized-transpose-of-an-array">Generalized transpose of an array</a></td><td valign="top"><a href="#Generalized-transpose-of-an-array">5.6 Generalized transpose of an array</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Generic-functions">Generic functions</a></td><td valign="top"><a href="#Object-orientation">10.9 Classes, generic functions and object orientation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Graphics-device-drivers">Graphics device drivers</a></td><td valign="top"><a href="#Device-drivers">12.6 Device drivers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Graphics-parameters">Graphics parameters</a></td><td valign="top"><a href="#The-par_0028_0029-function">12.4.1 Permanent changes: The <code>par()</code> function</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Grouped-expressions">Grouped expressions</a></td><td valign="top"><a href="#Grouped-expressions">9.1 Grouped expressions</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-I">I</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Indexing-of-and-by-arrays">Indexing of and by arrays</a></td><td valign="top"><a href="#Array-indexing">5.2 Array indexing. Subsections of an array</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Indexing-vectors">Indexing vectors</a></td><td valign="top"><a href="#Index-vectors">2.7 Index vectors; selecting and modifying subsets of a data set</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-K">K</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Kolmogorov_002dSmirnov-test">Kolmogorov-Smirnov test</a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-L">L</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Least-squares-fitting">Least squares fitting</a></td><td valign="top"><a href="#Least-squares-fitting-and-the-QR-decomposition">5.7.5 Least squares fitting and the QR decomposition</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Linear-equations">Linear equations</a></td><td valign="top"><a href="#Linear-equations-and-inversion">5.7.2 Linear equations and inversion</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Linear-models">Linear models</a></td><td valign="top"><a href="#Linear-models">11.2 Linear models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Lists">Lists</a></td><td valign="top"><a href="#Lists">6.1 Lists</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Local-approximating-regressions">Local approximating regressions</a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Loops-and-conditional-execution">Loops and conditional execution</a></td><td valign="top"><a href="#Loops-and-conditional-execution">9. Grouping, loops and conditional execution</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Matrices">Matrices</a></td><td valign="top"><a href="#Arrays">5.1 Arrays</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Matrix-multiplication">Matrix multiplication</a></td><td valign="top"><a href="#Multiplication">5.7.1 Matrix multiplication</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Maximum-likelihood">Maximum likelihood</a></td><td valign="top"><a href="#Maximum-likelihood">11.7.2 Maximum likelihood</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Missing-values">Missing values</a></td><td valign="top"><a href="#Missing-values">2.5 Missing values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Mixed-models">Mixed models</a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-N">N</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Named-arguments">Named arguments</a></td><td valign="top"><a href="#Named-arguments-and-defaults">10.3 Named arguments and defaults</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Namespace">Namespace</a></td><td valign="top"><a href="#Namespaces">13.3 Namespaces</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Nonlinear-least-squares">Nonlinear least squares</a></td><td valign="top"><a href="#Nonlinear-least-squares-and-maximum-likelihood-models">11.7 Nonlinear least squares and maximum likelihood models</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-O">O</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Object-orientation">Object orientation</a></td><td valign="top"><a href="#Object-orientation">10.9 Classes, generic functions and object orientation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Objects">Objects</a></td><td valign="top"><a href="#Objects">3. Objects, their modes and attributes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-One_002d-and-two_002dsample-tests">One- and two-sample tests</a></td><td valign="top"><a href="#One_002d-and-two_002dsample-tests">8.3 One- and two-sample tests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Ordered-factors">Ordered factors</a></td><td valign="top"><a href="#Factors">4. Ordered and unordered factors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Ordered-factors-1">Ordered factors</a></td><td valign="top"><a href="#Contrasts">11.1.1 Contrasts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Outer-products-of-arrays">Outer products of arrays</a></td><td valign="top"><a href="#The-outer-product-of-two-arrays">5.5 The outer product of two arrays</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-P">P</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Packages">Packages</a></td><td valign="top"><a href="#R-and-statistics">1.3 R and statistics</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Packages-1">Packages</a></td><td valign="top"><a href="#Packages">13. Packages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Probability-distributions">Probability distributions</a></td><td valign="top"><a href="#Probability-distributions">8. Probability distributions</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-Q">Q</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-QR-decomposition">QR decomposition</a></td><td valign="top"><a href="#Least-squares-fitting-and-the-QR-decomposition">5.7.5 Least squares fitting and the QR decomposition</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Quantile_002dquantile-plots">Quantile-quantile plots</a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Reading-data-from-files">Reading data from files</a></td><td valign="top"><a href="#Reading-data-from-files">7. Reading data from files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Recycling-rule">Recycling rule</a></td><td valign="top"><a href="#Vector-arithmetic">2.2 Vector arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Recycling-rule-1">Recycling rule</a></td><td valign="top"><a href="#The-recycling-rule">5.4.1 Mixed vector and array arithmetic. The recycling rule</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Regular-sequences">Regular sequences</a></td><td valign="top"><a href="#Generating-regular-sequences">2.3 Generating regular sequences</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Removing-objects">Removing objects</a></td><td valign="top"><a href="#Data-permanency-and-removing-objects">1.11 Data permanency and removing objects</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Robust-regression">Robust regression</a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Scope">Scope</a></td><td valign="top"><a href="#Scope">10.7 Scope</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Search-path">Search path</a></td><td valign="top"><a href="#Managing-the-search-path">6.3.5 Managing the search path</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Shapiro_002dWilk-test">Shapiro-Wilk test</a></td><td valign="top"><a href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Singular-value-decomposition">Singular value decomposition</a></td><td valign="top"><a href="#Singular-value-decomposition-and-determinants">5.7.4 Singular value decomposition and determinants</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Statistical-models">Statistical models</a></td><td valign="top"><a href="#Statistical-models-in-R">11. Statistical models in R</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Student_0027s-t-test">Student&rsquo;s <em>t</em> test</a></td><td valign="top"><a href="#One_002d-and-two_002dsample-tests">8.3 One- and two-sample tests</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Tabulation">Tabulation</a></td><td valign="top"><a href="#Frequency-tables-from-factors">5.10 Frequency tables from factors</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Tree_002dbased-models">Tree-based models</a></td><td valign="top"><a href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-U">U</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Updating-fitted-models">Updating fitted models</a></td><td valign="top"><a href="#Updating-fitted-models">11.5 Updating fitted models</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-V">V</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Vectors">Vectors</a></td><td valign="top"><a href="#Simple-manipulations-numbers-and-vectors">2. Simple manipulations; numbers and vectors</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-index-1_cp_letter-W">W</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Wilcoxon-test">Wilcoxon test</a></td><td valign="top"><a href="#One_002d-and-two_002dsample-tests">8.3 One- and two-sample tests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Workspace">Workspace</a></td><td valign="top"><a href="#Data-permanency-and-removing-objects">1.11 Data permanency and removing objects</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Writing-functions">Writing functions</a></td><td valign="top"><a href="#Writing-your-own-functions">10. Writing your own functions</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a href="#Concept-index-1_cp_letter-A" class="summary-letter"><b>A</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-B" class="summary-letter"><b>B</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-C" class="summary-letter"><b>C</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-D" class="summary-letter"><b>D</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-E" class="summary-letter"><b>E</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-F" class="summary-letter"><b>F</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-G" class="summary-letter"><b>G</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-I" class="summary-letter"><b>I</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-K" class="summary-letter"><b>K</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-L" class="summary-letter"><b>L</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-M" class="summary-letter"><b>M</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-N" class="summary-letter"><b>N</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-O" class="summary-letter"><b>O</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-P" class="summary-letter"><b>P</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-Q" class="summary-letter"><b>Q</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-R" class="summary-letter"><b>R</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-S" class="summary-letter"><b>S</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-T" class="summary-letter"><b>T</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-U" class="summary-letter"><b>U</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-V" class="summary-letter"><b>V</b></a>
 &nbsp; 
<a href="#Concept-index-1_cp_letter-W" class="summary-letter"><b>W</b></a>
 &nbsp; 
</td></tr></table>

<hr size="6">
<a name="References"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Concept-index" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[ &gt; ]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Concept-index" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[ &gt;&gt; ]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="References-1"></a>
<h1 class="appendix">F. References</h1>

<p>D. M. Bates and  D. G. Watts (1988), <em>Nonlinear Regression
Analysis and Its Applications.</em> John Wiley &amp; Sons, New York.
</p>
<p>Richard A. Becker, John M. Chambers and Allan R. Wilks (1988),
<em>The New S Language.</em> Chapman &amp; Hall, New York.
This book is often called the &ldquo;<em>Blue Book</em>&rdquo;.
</p>
<p>John M. Chambers and Trevor J. Hastie eds. (1992),
<em>Statistical Models in S.</em> Chapman &amp; Hall, New York.
This is also called the &ldquo;<em>White Book</em>&rdquo;.
</p>
<p>John M. Chambers (1998)
<em>Programming with Data</em>. Springer, New York.
This is also called the &ldquo;<em>Green Book</em>&rdquo;.
</p>
<p>A. C. Davison and D. V. Hinkley (1997), <em>Bootstrap Methods
and Their Applications</em>, Cambridge University Press.
</p>
<p>Annette J. Dobson (1990), <em>An Introduction to Generalized Linear
Models</em>, Chapman and Hall, London.
</p>
<p>Peter McCullagh and John A. Nelder (1989), <em>Generalized Linear
Models.</em> Second edition, Chapman and Hall, London.
</p>
<p>John A.&nbsp;Rice (1995), <em>Mathematical Statistics and Data Analysis.</em>
Second edition.  Duxbury Press, Belmont, CA.
</p>
<p>S. D. Silvey (1970), <em>Statistical Inference.</em> Penguin, London.
</p>
<hr size="6">
<a name="SEC_Foot"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>Footnotes</h1>
<h3><a name="FOOT1" href="#DOCF1">(1)</a></h3>
<p>R패키지들에서 사용되는 R코드들을 포함하여, 오로지 A&ndash;Za&ndash;z0&ndash;9 (즉, 대문자 A부터 Z, 소문자 a부터 z, 그리고 숫자 0부터 9)을 지칭함
</p><h3><a name="FOOT2" href="#DOCF2">(2)</a></h3>
<p><strong>단, </strong> 문자열내에서 사용할 수 없으며, 또한 함수를 정의하는 인자목록에서는 사용될 수 없다는 점을 명심해 주시길 바랍니다
</p><h3><a name="FOOT3" href="#DOCF3">(3)</a></h3>
<p>some of the
consoles will not allow you to enter more, and amongst those which do
some will silently discard the excess and some will use it as the start
of the next line.
</p><h3><a name="FOOT4" href="#DOCF4">(4)</a></h3>
<p>of unlimited length.
</p><h3><a name="FOOT5" href="#DOCF5">(5)</a></h3>
<p>The leading &ldquo;dot&rdquo; in
this file name makes it <em>invisible</em> in normal file listings in
UNIX.
</p><h3><a name="FOOT6" href="#DOCF6">(6)</a></h3>
<p>With other than vector types of argument,
such as <code>list</code> mode arguments, the action of <code>c()</code> is rather
different.  See <a href="#Concatenating-lists">Concatenating lists</a>.
</p><h3><a name="FOOT7" href="#DOCF7">(7)</a></h3>
<p>Actually, it is still available as
<code>.Last.value</code> before any other statements are executed.
</p><h3><a name="FOOT8" href="#DOCF8">(8)</a></h3>
<p><code>paste(..., collapse=<var>ss</var>)</code> joins the
arguments into a single character string putting <var>ss</var> in between.
There are more tools for character manipulation, see the help
for <code>sub</code> and <code>substring</code>.
</p><h3><a name="FOOT9" href="#DOCF9">(9)</a></h3>
<p><em>numeric</em> mode is
actually an amalgam of two distinct modes, namely <em>integer</em> and
<em>double</em> precision, as explained in the manual.
</p><h3><a name="FOOT10" href="#DOCF10">(10)</a></h3>
<p>Note however that <code>length(<var>object</var>)</code> does not always
contain intrinsic useful information, e.g., when <code><var>object</var></code> is a
function.
</p><h3><a name="FOOT11" href="#DOCF11">(11)</a></h3>
<p>In general, coercion
from numeric to character and back again will not be exactly reversible,
because of roundoff errors in the character representation.
</p><h3><a name="FOOT12" href="#DOCF12">(12)</a></h3>
<p>A different style using
&lsquo;formal&rsquo; or &lsquo;S4&rsquo; classes is provided in package <code>methods</code>.
</p><h3><a name="FOOT13" href="#DOCF13">(13)</a></h3>
<p>Readers should note
that there are eight states and territories in Australia, namely the
Australian Capital Territory, New South Wales, the Northern Territory,
Queensland, South Australia, Tasmania, Victoria and Western Australia.
</p><h3><a name="FOOT14" href="#DOCF14">(14)</a></h3>
<p>Note that <code>tapply()</code> also works in this case
when its second argument is not a factor, e.g.,
&lsquo;<samp><code>tapply(incomes, state)</code></samp>&rsquo;, and this is true for quite a few
other functions, since arguments are <em>coerced</em> to factors when
necessary (using <code>as.factor()</code>).
</p><h3><a name="FOOT15" href="#DOCF15">(15)</a></h3>
<p>Note that <code>x %*% x</code> is ambiguous, as
it could mean either  x&rsquo;x or  x x&rsquo;, where x is the
column form.  In such cases the smaller matrix seems implicitly to be
the interpretation adopted, so the scalar  x&rsquo;x is in this case the
result.  The matrix  x x&rsquo; may be calculated either by <code>cbind(x)
%*% x</code> or <code>x %*% rbind(x)</code> since the result of <code>rbind()</code> or
<code>cbind()</code> is always a matrix.  However, the best way to compute
 x&rsquo;x or  x x&rsquo; is <code>crossprod(x)</code> or <code>x %o% x</code>
respectively.
</p><h3><a name="FOOT16" href="#DOCF16">(16)</a></h3>
<p>Even better would be to form a matrix square
root B with A = BB&rsquo; and find the squared length of the
solution of By = x, perhaps using the Cholesky or
eigendecomposition of A.
</p><h3><a name="FOOT17" href="#DOCF17">(17)</a></h3>
<p>Conversion of character columns to factors is
overridden using the <code>stringsAsFactors</code> argument to the
<code>data.frame()</code> function.
</p><h3><a name="FOOT18" href="#DOCF18">(18)</a></h3>
<p>See the on-line help
for <code>autoload</code> for the meaning of the second term.
</p><h3><a name="FOOT19" href="#DOCF19">(19)</a></h3>
<p>Under UNIX, the utilities Sed or
Awk can be used.
</p><h3><a name="FOOT20" href="#DOCF20">(20)</a></h3>
<p>to be
discussed later, or use <code>xyplot</code> from package <a href="http://CRAN.R-project.org/package=lattice"><strong>lattice</strong></a>.
</p><h3><a name="FOOT21" href="#DOCF21">(21)</a></h3>
<p>See also the methods described in <a href="#Statistical-models-in-R">Statistical models in R</a>
</p><h3><a name="FOOT22" href="#DOCF22">(22)</a></h3>
<p>In some sense this
mimics the behavior in <small>S-PLUS</small> since in <small>S-PLUS</small> this operator always
creates or assigns to a global variable.
</p><h3><a name="FOOT23" href="#DOCF23">(23)</a></h3>
<p>So it is hidden under
UNIX.
</p><h3><a name="FOOT24" href="#DOCF24">(24)</a></h3>
<p>Some graphics
parameters such as the size of the current device are for information
only.
</p><h3><a name="FOOT25" href="#DOCF25">(25)</a></h3>
<p>2.5Gb on versions of Windows that support 3Gb per
process and have the support enabled: see the &lsquo;<tt>rw-FAQ</tt>&rsquo; Q2.9; 3.5Gb
on some 64-bit versions of Windows.
</p><h3><a name="FOOT26" href="#DOCF26">(26)</a></h3>
<p>as from R 2.13.0.
</p><h3><a name="FOOT27" href="#DOCF27">(27)</a></h3>
<p>The
&lsquo;Emacs Speaks Statistics&rsquo; package; see the <acronym>URL</acronym>
<a href="http://ESS.R-project.org">http://ESS.R-project.org</a>
</p><h3><a name="FOOT28" href="#DOCF28">(28)</a></h3>
<p>On a PC keyboard this is usually the
Alt key, occasionally the &lsquo;Windows&rsquo; key.  On a Mac keyboard normally no
meta key is available.
</p><hr size="1">
<a name="SEC_Contents"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>Table of Contents</h1>
<div class="contents">

<ul class="toc">
  <li><a name="toc-Preface-1" href="#Preface">Preface</a></li>
  <li><a name="toc-1-Introduction-and-preliminaries" href="#Introduction-and-preliminaries">1. 1 Introduction and preliminaries</a>
  <ul class="toc">
    <li><a name="toc-The-R-environment-1" href="#The-R-environment">1.1 The R environment</a></li>
    <li><a name="toc-Related-software-and-documentation-1" href="#Related-software-and-documentation">1.2 Related software and documentation</a></li>
    <li><a name="toc-R-and-statistics-1" href="#R-and-statistics">1.3 R and statistics</a></li>
    <li><a name="toc-R-and-the-window-system-1" href="#R-and-the-window-system">1.4 R and the window system</a></li>
    <li><a name="toc-Using-R-interactively-1" href="#Using-R-interactively">1.5 Using R interactively</a></li>
    <li><a name="toc-An-introductory-session" href="#An-introductory-session">1.6 An introductory session</a></li>
    <li><a name="toc-Getting-help-with-functions-and-features" href="#Getting-help">1.7 Getting help with functions and features</a></li>
    <li><a name="toc-R-commands_002c-case-sensitivity_002c-etc_002e" href="#R-commands_003b-case-sensitivity-etc">1.8 R commands, case sensitivity, etc.</a></li>
    <li><a name="toc-Recall-and-correction-of-previous-commands-1" href="#Recall-and-correction-of-previous-commands">1.9 Recall and correction of previous commands</a></li>
    <li><a name="toc-Executing-commands-from-or-diverting-output-to-a-file-1" href="#Executing-commands-from-or-diverting-output-to-a-file">1.10 Executing commands from or diverting output to a file</a></li>
    <li><a name="toc-Data-permanency-and-removing-objects-1" href="#Data-permanency-and-removing-objects">1.11 Data permanency and removing objects</a></li>
  </ul></li>
  <li><a name="toc-Simple-manipulations_003b-numbers-and-vectors" href="#Simple-manipulations-numbers-and-vectors">2. Simple manipulations; numbers and vectors</a>
  <ul class="toc">
    <li><a name="toc-Vectors-and-assignment-1" href="#Vectors-and-assignment">2.1 Vectors and assignment</a></li>
    <li><a name="toc-Vector-arithmetic-1" href="#Vector-arithmetic">2.2 Vector arithmetic</a></li>
    <li><a name="toc-Generating-regular-sequences-1" href="#Generating-regular-sequences">2.3 Generating regular sequences</a></li>
    <li><a name="toc-Logical-vectors-1" href="#Logical-vectors">2.4 Logical vectors</a></li>
    <li><a name="toc-Missing-values-1" href="#Missing-values">2.5 Missing values</a></li>
    <li><a name="toc-Character-vectors-1" href="#Character-vectors">2.6 Character vectors</a></li>
    <li><a name="toc-Index-vectors_003b-selecting-and-modifying-subsets-of-a-data-set" href="#Index-vectors">2.7 Index vectors; selecting and modifying subsets of a data set</a></li>
    <li><a name="toc-Other-types-of-objects-1" href="#Other-types-of-objects">2.8 Other types of objects</a></li>
  </ul></li>
  <li><a name="toc-Objects_002c-their-modes-and-attributes" href="#Objects">3. Objects, their modes and attributes</a>
  <ul class="toc">
    <li><a name="toc-Intrinsic-attributes_003a-mode-and-length" href="#The-intrinsic-attributes-mode-and-length">3.1 Intrinsic attributes: mode and length</a></li>
    <li><a name="toc-Changing-the-length-of-an-object-1" href="#Changing-the-length-of-an-object">3.2 Changing the length of an object</a></li>
    <li><a name="toc-Getting-and-setting-attributes-1" href="#Getting-and-setting-attributes">3.3 Getting and setting attributes</a></li>
    <li><a name="toc-The-class-of-an-object-1" href="#The-class-of-an-object">3.4 The class of an object</a></li>
  </ul></li>
  <li><a name="toc-Ordered-and-unordered-factors" href="#Factors">4. Ordered and unordered factors</a>
  <ul class="toc">
    <li><a name="toc-A-specific-example" href="#A-specific-example">4.1 A specific example</a></li>
    <li><a name="toc-The-function-tapply_0028_0029-and-ragged-arrays-1" href="#The-function-tapply_0028_0029-and-ragged-arrays">4.2 The function <code>tapply()</code> and ragged arrays</a></li>
    <li><a name="toc-Ordered-factors-1" href="#Ordered-factors">4.3 Ordered factors</a></li>
  </ul></li>
  <li><a name="toc-Arrays-and-matrices-1" href="#Arrays-and-matrices">5. Arrays and matrices</a>
  <ul class="toc">
    <li><a name="toc-Arrays-1" href="#Arrays">5.1 Arrays</a></li>
    <li><a name="toc-Array-indexing_002e-Subsections-of-an-array" href="#Array-indexing">5.2 Array indexing. Subsections of an array</a></li>
    <li><a name="toc-Index-matrices-1" href="#Index-matrices">5.3 Index matrices</a></li>
    <li><a name="toc-The-array_0028_0029-function-1" href="#The-array_0028_0029-function">5.4 The <code>array()</code> function</a>
    <ul class="toc">
      <li><a name="toc-Mixed-vector-and-array-arithmetic_002e-The-recycling-rule" href="#The-recycling-rule">5.4.1 Mixed vector and array arithmetic. The recycling rule</a></li>
    </ul></li>
    <li><a name="toc-The-outer-product-of-two-arrays-1" href="#The-outer-product-of-two-arrays">5.5 The outer product of two arrays</a></li>
    <li><a name="toc-Generalized-transpose-of-an-array-1" href="#Generalized-transpose-of-an-array">5.6 Generalized transpose of an array</a></li>
    <li><a name="toc-Matrix-facilities-1" href="#Matrix-facilities">5.7 Matrix facilities</a>
    <ul class="toc">
      <li><a name="toc-Matrix-multiplication" href="#Multiplication">5.7.1 Matrix multiplication</a></li>
      <li><a name="toc-Linear-equations-and-inversion-1" href="#Linear-equations-and-inversion">5.7.2 Linear equations and inversion</a></li>
      <li><a name="toc-Eigenvalues-and-eigenvectors-1" href="#Eigenvalues-and-eigenvectors">5.7.3 Eigenvalues and eigenvectors</a></li>
      <li><a name="toc-Singular-value-decomposition-and-determinants-1" href="#Singular-value-decomposition-and-determinants">5.7.4 Singular value decomposition and determinants</a></li>
      <li><a name="toc-Least-squares-fitting-and-the-QR-decomposition-1" href="#Least-squares-fitting-and-the-QR-decomposition">5.7.5 Least squares fitting and the QR decomposition</a></li>
    </ul></li>
    <li><a name="toc-Forming-partitioned-matrices_002c-cbind_0028_0029-and-rbind_0028_0029" href="#Forming-partitioned-matrices">5.8 Forming partitioned matrices, <code>cbind()</code> and <code>rbind()</code></a></li>
    <li><a name="toc-The-concatenation-function_002c-c_0028_0029_002c-with-arrays" href="#The-concatenation-function-c_0028_0029-with-arrays">5.9 The concatenation function, <code>c()</code>, with arrays</a></li>
    <li><a name="toc-Frequency-tables-from-factors-1" href="#Frequency-tables-from-factors">5.10 Frequency tables from factors</a></li>
  </ul></li>
  <li><a name="toc-Lists-and-data-frames-1" href="#Lists-and-data-frames">6. Lists and data frames</a>
  <ul class="toc">
    <li><a name="toc-Lists-1" href="#Lists">6.1 Lists</a></li>
    <li><a name="toc-Constructing-and-modifying-lists-1" href="#Constructing-and-modifying-lists">6.2 Constructing and modifying lists</a>
    <ul class="toc">
      <li><a name="toc-Concatenating-lists-1" href="#Concatenating-lists">6.2.1 Concatenating lists</a></li>
    </ul></li>
    <li><a name="toc-Data-frames-1" href="#Data-frames">6.3 Data frames</a>
    <ul class="toc">
      <li><a name="toc-Making-data-frames-1" href="#Making-data-frames">6.3.1 Making data frames</a></li>
      <li><a name="toc-attach_0028_0029-and-detach_0028_0029-1" href="#attach_0028_0029-and-detach_0028_0029">6.3.2 <code>attach() and <code>detach()</code></code></a></li>
      <li><a name="toc-Working-with-data-frames-1" href="#Working-with-data-frames">6.3.3 Working with data frames</a></li>
      <li><a name="toc-Attaching-arbitrary-lists-1" href="#Attaching-arbitrary-lists">6.3.4 Attaching arbitrary lists</a></li>
      <li><a name="toc-Managing-the-search-path-1" href="#Managing-the-search-path">6.3.5 Managing the search path</a></li>
    </ul>
</li>
  </ul></li>
  <li><a name="toc-Reading-data-from-files-1" href="#Reading-data-from-files">7. Reading data from files</a>
  <ul class="toc">
    <li><a name="toc-The-read_002etable_0028_0029-function-1" href="#The-read_002etable_0028_0029-function">7.1 The <code>read.table()</code> function</a></li>
    <li><a name="toc-The-scan_0028_0029-function-1" href="#The-scan_0028_0029-function">7.2 The <code>scan()</code> function</a></li>
    <li><a name="toc-Accessing-builtin-datasets-1" href="#Accessing-builtin-datasets">7.3 Accessing builtin datasets</a>
    <ul class="toc">
      <li><a name="toc-Loading-data-from-other-R-packages" href="#Loading-data-from-other-R-packages">7.3.1 Loading data from other R packages</a></li>
    </ul></li>
    <li><a name="toc-Editing-data-1" href="#Editing-data">7.4 Editing data</a></li>
  </ul></li>
  <li><a name="toc-Probability-distributions-1" href="#Probability-distributions">8. Probability distributions</a>
  <ul class="toc">
    <li><a name="toc-R-as-a-set-of-statistical-tables-1" href="#R-as-a-set-of-statistical-tables">8.1 R as a set of statistical tables</a></li>
    <li><a name="toc-Examining-the-distribution-of-a-set-of-data-1" href="#Examining-the-distribution-of-a-set-of-data">8.2 Examining the distribution of a set of data</a></li>
    <li><a name="toc-One_002d-and-two_002dsample-tests-1" href="#One_002d-and-two_002dsample-tests">8.3 One- and two-sample tests</a></li>
  </ul></li>
  <li><a name="toc-Grouping_002c-loops-and-conditional-execution" href="#Loops-and-conditional-execution">9. Grouping, loops and conditional execution</a>
  <ul class="toc">
    <li><a name="toc-Grouped-expressions-1" href="#Grouped-expressions">9.1 Grouped expressions</a></li>
    <li><a name="toc-Control-statements-1" href="#Control-statements">9.2 Control statements</a>
    <ul class="toc">
      <li><a name="toc-Conditional-execution_003a-if-statements" href="#Conditional-execution">9.2.1 Conditional execution: <code>if</code> statements</a></li>
      <li><a name="toc-Repetitive-execution_003a-for-loops_002c-repeat-and-while" href="#Repetitive-execution">9.2.2 Repetitive execution: <code>for</code> loops, <code>repeat</code> and <code>while</code></a></li>
    </ul>
</li>
  </ul></li>
  <li><a name="toc-Writing-your-own-functions-1" href="#Writing-your-own-functions">10. Writing your own functions</a>
  <ul class="toc">
    <li><a name="toc-Simple-examples-1" href="#Simple-examples">10.1 Simple examples</a></li>
    <li><a name="toc-Defining-new-binary-operators-1" href="#Defining-new-binary-operators">10.2 Defining new binary operators</a></li>
    <li><a name="toc-Named-arguments-and-defaults-1" href="#Named-arguments-and-defaults">10.3 Named arguments and defaults</a></li>
    <li><a name="toc-The-_2026-argument" href="#The-three-dots-argument">10.4 The &lsquo;<samp>&hellip;</samp>&rsquo; argument</a></li>
    <li><a name="toc-Assignments-within-functions" href="#Assignment-within-functions">10.5 Assignments within functions</a></li>
    <li><a name="toc-More-advanced-examples-1" href="#More-advanced-examples">10.6 More advanced examples</a>
    <ul class="toc">
      <li><a name="toc-Efficiency-factors-in-block-designs-1" href="#Efficiency-factors-in-block-designs">10.6.1 Efficiency factors in block designs</a></li>
      <li><a name="toc-Dropping-all-names-in-a-printed-array-1" href="#Dropping-all-names-in-a-printed-array">10.6.2 Dropping all names in a printed array</a></li>
      <li><a name="toc-Recursive-numerical-integration-1" href="#Recursive-numerical-integration">10.6.3 Recursive numerical integration</a></li>
    </ul></li>
    <li><a name="toc-Scope-1" href="#Scope">10.7 Scope</a></li>
    <li><a name="toc-Customizing-the-environment-1" href="#Customizing-the-environment">10.8 Customizing the environment</a></li>
    <li><a name="toc-Classes_002c-generic-functions-and-object-orientation" href="#Object-orientation">10.9 Classes, generic functions and object orientation</a></li>
  </ul></li>
  <li><a name="toc-Statistical-models-in-R-1" href="#Statistical-models-in-R">11. Statistical models in R</a>
  <ul class="toc">
    <li><a name="toc-Defining-statistical-models_003b-formulae" href="#Formulae-for-statistical-models">11.1 Defining statistical models; formulae</a>
    <ul class="toc">
      <li><a name="toc-Contrasts-1" href="#Contrasts">11.1.1 Contrasts</a></li>
    </ul></li>
    <li><a name="toc-Linear-models-1" href="#Linear-models">11.2 Linear models</a></li>
    <li><a name="toc-Generic-functions-for-extracting-model-information-1" href="#Generic-functions-for-extracting-model-information">11.3 Generic functions for extracting model information</a></li>
    <li><a name="toc-Analysis-of-variance-and-model-comparison-1" href="#Analysis-of-variance-and-model-comparison">11.4 Analysis of variance and model comparison</a>
    <ul class="toc">
      <li><a name="toc-ANOVA-tables-1" href="#ANOVA-tables">11.4.1 ANOVA tables</a></li>
    </ul></li>
    <li><a name="toc-Updating-fitted-models-1" href="#Updating-fitted-models">11.5 Updating fitted models</a></li>
    <li><a name="toc-Generalized-linear-models-1" href="#Generalized-linear-models">11.6 Generalized linear models</a>
    <ul class="toc">
      <li><a name="toc-Families-1" href="#Families">11.6.1 Families</a></li>
      <li><a name="toc-The-glm_0028_0029-function-1" href="#The-glm_0028_0029-function">11.6.2 The <code>glm()</code> function</a></li>
    </ul></li>
    <li><a name="toc-Nonlinear-least-squares-and-maximum-likelihood-models-1" href="#Nonlinear-least-squares-and-maximum-likelihood-models">11.7 Nonlinear least squares and maximum likelihood models</a>
    <ul class="toc">
      <li><a name="toc-Least-squares-1" href="#Least-squares">11.7.1 Least squares</a></li>
      <li><a name="toc-Maximum-likelihood-1" href="#Maximum-likelihood">11.7.2 Maximum likelihood</a></li>
    </ul></li>
    <li><a name="toc-Some-non_002dstandard-models-1" href="#Some-non_002dstandard-models">11.8 Some non-standard models</a></li>
  </ul></li>
  <li><a name="toc-Graphical-procedures" href="#Graphics">12. Graphical procedures</a>
  <ul class="toc">
    <li><a name="toc-High_002dlevel-plotting-commands-1" href="#High_002dlevel-plotting-commands">12.1 High-level plotting commands</a>
    <ul class="toc">
      <li><a name="toc-The-plot_0028_0029-function-1" href="#The-plot_0028_0029-function">12.1.1 The <code>plot()</code> function</a></li>
      <li><a name="toc-Displaying-multivariate-data-1" href="#Displaying-multivariate-data">12.1.2 Displaying multivariate data</a></li>
      <li><a name="toc-Display-graphics-1" href="#Display-graphics">12.1.3 Display graphics</a></li>
      <li><a name="toc-Arguments-to-high_002dlevel-plotting-functions-1" href="#Arguments-to-high_002dlevel-plotting-functions">12.1.4 Arguments to high-level plotting functions</a></li>
    </ul></li>
    <li><a name="toc-Low_002dlevel-plotting-commands-1" href="#Low_002dlevel-plotting-commands">12.2 Low-level plotting commands</a>
    <ul class="toc">
      <li><a name="toc-Mathematical-annotation-1" href="#Mathematical-annotation">12.2.1 Mathematical annotation</a></li>
      <li><a name="toc-Hershey-vector-fonts-1" href="#Hershey-vector-fonts">12.2.2 Hershey vector fonts</a></li>
    </ul></li>
    <li><a name="toc-Interacting-with-graphics-1" href="#Interacting-with-graphics">12.3 Interacting with graphics</a></li>
    <li><a name="toc-Using-graphics-parameters-1" href="#Using-graphics-parameters">12.4 Using graphics parameters</a>
    <ul class="toc">
      <li><a name="toc-Permanent-changes_003a-The-par_0028_0029-function" href="#The-par_0028_0029-function">12.4.1 Permanent changes: The <code>par()</code> function</a></li>
      <li><a name="toc-Temporary-changes_003a-Arguments-to-graphics-functions" href="#Arguments-to-graphics-functions">12.4.2 Temporary changes: Arguments to graphics functions</a></li>
    </ul></li>
    <li><a name="toc-Graphics-parameters-list" href="#Graphics-parameters">12.5 Graphics parameters list</a>
    <ul class="toc">
      <li><a name="toc-Graphical-elements-1" href="#Graphical-elements">12.5.1 Graphical elements</a></li>
      <li><a name="toc-Axes-and-tick-marks-1" href="#Axes-and-tick-marks">12.5.2 Axes and tick marks</a></li>
      <li><a name="toc-Figure-margins-1" href="#Figure-margins">12.5.3 Figure margins</a></li>
      <li><a name="toc-Multiple-figure-environment-1" href="#Multiple-figure-environment">12.5.4 Multiple figure environment</a></li>
    </ul></li>
    <li><a name="toc-Device-drivers-1" href="#Device-drivers">12.6 Device drivers</a>
    <ul class="toc">
      <li><a name="toc-PostScript-diagrams-for-typeset-documents-1" href="#PostScript-diagrams-for-typeset-documents">12.6.1 PostScript diagrams for typeset documents</a></li>
      <li><a name="toc-Multiple-graphics-devices-1" href="#Multiple-graphics-devices">12.6.2 Multiple graphics devices</a></li>
    </ul></li>
    <li><a name="toc-Dynamic-graphics-1" href="#Dynamic-graphics">12.7 Dynamic graphics</a></li>
  </ul></li>
  <li><a name="toc-Packages-1" href="#Packages">13. Packages</a>
  <ul class="toc">
    <li><a name="toc-Standard-packages-1" href="#Standard-packages">13.1 Standard packages</a></li>
    <li><a name="toc-Contributed-packages-and-CRAN-1" href="#Contributed-packages-and-CRAN">13.2 Contributed packages and <acronym>CRAN</acronym></a></li>
    <li><a name="toc-Namespaces-1" href="#Namespaces">13.3 Namespaces</a></li>
  </ul></li>
  <li><a name="toc-A-sample-session-1" href="#A-sample-session">A. A sample session</a></li>
  <li><a name="toc-Invoking-R-1" href="#Invoking-R">B. Invoking R</a>
  <ul class="toc">
    <li><a name="toc-Invoking-R-from-the-command-line-1" href="#Invoking-R-from-the-command-line">B.1 Invoking R from the command line</a></li>
    <li><a name="toc-Invoking-R-under-Windows-1" href="#Invoking-R-under-Windows">B.2 Invoking R under Windows</a></li>
    <li><a name="toc-Invoking-R-under-Mac-OS-X-1" href="#Invoking-R-under-Mac-OS-X">B.3 Invoking R under Mac OS X</a></li>
    <li><a name="toc-Scripting-with-R-1" href="#Scripting-with-R">B.4 Scripting with R</a></li>
  </ul></li>
  <li><a name="toc-The-command_002dline-editor-1" href="#The-command_002dline-editor">C. The command-line editor</a>
  <ul class="toc">
    <li><a name="toc-Preliminaries" href="#Preliminaries">C.1 Preliminaries</a></li>
    <li><a name="toc-Editing-actions" href="#Editing-actions">C.2 Editing actions</a></li>
    <li><a name="toc-Command_002dline-editor-summary" href="#Command_002dline-editor-summary">C.3 Command-line editor summary</a></li>
  </ul></li>
  <li><a name="toc-Function-and-variable-index-1" href="#Function-and-variable-index">D. Function and variable index</a></li>
  <li><a name="toc-Concept-index-1" href="#Concept-index">E. Concept index</a></li>
  <li><a name="toc-References-1" href="#References">F. References</a></li>
</ul>
</div>
<hr size="1">
<a name="SEC_About"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-variable-index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>About This Document</h1>
<p>
  This document was generated by <em>Chel Hee Lee</em> on <em>March 3, 2013</em> using <a href="http://www.nongnu.org/texi2html/"><em>texi2html 1.82</em></a>.
</p>
<p>
  The buttons in the navigation panels have the following meaning:
</p>
<table border="1">
  <tr>
    <th> Button </th>
    <th> Name </th>
    <th> Go to </th>
    <th> From 1.2.3 go to</th>
  </tr>
  <tr>
    <td align="center"> [ &lt; ] </td>
    <td align="center">Back</td>
    <td>Previous section in reading order</td>
    <td>1.2.2</td>
  </tr>
  <tr>
    <td align="center"> [ &gt; ] </td>
    <td align="center">Forward</td>
    <td>Next section in reading order</td>
    <td>1.2.4</td>
  </tr>
  <tr>
    <td align="center"> [ &lt;&lt; ] </td>
    <td align="center">FastBack</td>
    <td>Beginning of this chapter or previous chapter</td>
    <td>1</td>
  </tr>
  <tr>
    <td align="center"> [ Up ] </td>
    <td align="center">Up</td>
    <td>Up section</td>
    <td>1.2</td>
  </tr>
  <tr>
    <td align="center"> [ &gt;&gt; ] </td>
    <td align="center">FastForward</td>
    <td>Next chapter</td>
    <td>2</td>
  </tr>
  <tr>
    <td align="center"> [Top] </td>
    <td align="center">Top</td>
    <td>Cover (top) of document</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [Contents] </td>
    <td align="center">Contents</td>
    <td>Table of contents</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [Index] </td>
    <td align="center">Index</td>
    <td>Index</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [ ? ] </td>
    <td align="center">About</td>
    <td>About (help)</td>
    <td> &nbsp; </td>
  </tr>
</table>

<p>
  where the <strong> Example </strong> assumes that the current position is at <strong> Subsubsection One-Two-Three </strong> of a document of the following structure:
</p>

<ul>
  <li> 1. Section One
    <ul>
      <li>1.1 Subsection One-One
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.2 Subsection One-Two
        <ul>
          <li>1.2.1 Subsubsection One-Two-One</li>
          <li>1.2.2 Subsubsection One-Two-Two</li>
          <li>1.2.3 Subsubsection One-Two-Three &nbsp; &nbsp;
            <strong>&lt;== Current Position </strong></li>
          <li>1.2.4 Subsubsection One-Two-Four</li>
        </ul>
      </li>
      <li>1.3 Subsection One-Three
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.4 Subsection One-Four</li>
    </ul>
  </li>
</ul>

<hr size="1">
<p>
 <font size="-1">
  This document was generated by <em>Chel Hee Lee</em> on <em>March 3, 2013</em> using <a href="http://www.nongnu.org/texi2html/"><em>texi2html 1.82</em></a>.
 </font>
 <br>

</p>
</body>
</html>
